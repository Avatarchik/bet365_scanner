function BetSlipDelegates(n){this._bsContext=n}function BetSlipController(n,t){var i=this;this._bsInst=n;this._dlg=null;this._bsContext=t;this._delegates=new BetSlipDelegates(t);this._noStakeCount=0;this._enhancedBetSlipTypeSelector=null;this._enhancedBetSlipOddsSelector=null;this._enhancedBetSlipPitcherSelector=null;this._enhancedBetSlipToteSelector=null;this._enhancedBetSlipIfBetSelector=null;this._enhancedBetSlipTeaserTypeSelector=null;this._enhancedBetSlipAusRaceBetTypeSelector=null;this._ausToteToolTipHtmlBuilder=null;this._enhancedBetSlipEachWayExtraSelector=null;this._currencyDisplayHelper=null;this._removeClickHandler=null;this._eachWayClickHandler=null;this._freeBetClickHandler=null;this._noReservesClickHandler=null;this._pushConfigInitialisedEvent="PUSH_CONFIG_PROPERTIES_INITIALISED";this._ausMultiplesAvailabilityChangedEvent="IS_AUS_MULTIPLES_AVAILABLE";this._isAusMultiplesAvailable=!1;this._enhancedBetSlipAnimations=null;this.clientEnhancedMode()&&(this._enhancedBetSlipAnimations=new b365.Ui.Betslip.EnhancedBetSlipAnimations(this));this._stakeEntryTypes={stakePad:1,deviceKeyBoard:2};this._stakeEntryType=null;this.complexMultiplesInfo=[];this.complexMultiplesNeedsRefresh=!0;this.complexMultiplesCombinationsInit=!0;this.totalsCalculator;this._multiplesCombinationLimit=9;this._ttStkEle=$("#bsDiv .totals .totalStake .total, #bsDiv .placeBet .totalStake");this._suspendSelections=function(){$(".bsSusp").parents(".bs-item-container").addClass("bsSusp").find(".bsSusp").removeClass("bsSusp")};this._instanceEventAttacher=new b365.Ui.Betslip.InstanceEventAttacher(this._bsInst,i);i._instanceEventAttacher.attach();new b365.Ui.Betslip.RestoreStateHandler(this._bsInst).handle();this._bsContext.SetupTruncated2dpPriceForReturnsCalc();this._isItalianDomain=window.location.host.split(".").pop()=="it";this._isItalyVirtuals=!!(window.sProps&&window.sProps.v6&&window.sProps.v6.virtualSports);this._isAusDomain=window.location.host.split(".").pop()=="au";this._pushMarketsEnabled=!1}var _volatileElements,$get,$getElementsByClassName,bs;Sys={};_volatileElements={};Function.createDelegate=function(n,t){return function(){return!t||typeof t!="function"?null:t.apply(n,arguments)}};Type={};Type.registerNamespace=function(n){for(var r=window,f=n.split("."),u,i,t=0;t<f.length;t++)u=f[t],i=r[u],i||(i=r[u]={}),r=i},function(){Type.registerNamespace("Debug");var n={log:function(){},warn:function(){},error:function(){},info:function(){}};window.Debug.console||(window.Debug.console=window.console?window.console||n:n)}();String.prototype.startsWith=function(n){return this.substr(0,n.length)===n};String.prototype.endsWith=function(n){var t=this.length-n.length;return t>=0&&this.lastIndexOf(n)===t};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.escapeSelector=function(){return this.replace(/([$%&()*+,./:;<=>?@\[\\\]^\{|}~])/g,"\\$1")};Array.add=function(n,t){n[n.length]=t};Array.clone=function(n){return n.length===1?[n[0]]:Array.apply(null,n)};Array.remove=function(n,t){var i=n.indexOf(t);return i>=0&&n.splice(i,1),i>=0};Array.contains=function(n,t){for(var i=n.length;i--;)if(n[i]===t)return!0;return!1};Sys.Browser={};Sys.Platform={};Sys.Browser.InternetExplorer={};Sys.Browser.Firefox={};Sys.Browser.Safari={};Sys.Browser.Opera={};Sys.Browser.Chrome={};Sys.Platform.Windows={};Sys.Platform.Mac={};Sys.Platform.iphone={};Sys.Browser.agent=null;Sys.Browser.name=navigator.appName;Sys.Platform.name=null;Sys.Browser.version=parseFloat(navigator.appVersion);Sys.Browser.documentMode=0;navigator.userAgent.indexOf(" MSIE ")>-1?(Sys.Browser.agent=Sys.Browser.InternetExplorer,Sys.Browser.version=parseFloat(navigator.userAgent.match(/MSIE (\d+\.\d+)/)[1]),Sys.Browser.version>=8&&document.documentMode>=7&&(Sys.Browser.documentMode=document.documentMode)):navigator.userAgent.indexOf(" Firefox/")>-1?(Sys.Browser.agent=Sys.Browser.Firefox,Sys.Browser.name="Firefox",Sys.Browser.version=parseFloat(navigator.userAgent.match(/ Firefox\/(\d+\.\d+)/)[1])):navigator.userAgent.indexOf(" AppleWebKit/")>-1?(Sys.Browser.agent=Sys.Browser.Safari,Sys.Browser.version=parseFloat(navigator.userAgent.match(/ AppleWebKit\/(\d+(\.\d+)?)/)[1]),Sys.Browser.name="Safari"):navigator.userAgent.indexOf(" Chrome/")>-1?(Sys.Browser.agent=Sys.Browser.Chrome,Sys.Browser.version=parseFloat(navigator.userAgent.match(/ Chrome\/(\d+\.\d+)/)[1]),Sys.Browser.name="Chrome"):navigator.userAgent.indexOf("Opera/")>-1&&(Sys.Browser.agent=Sys.Browser.Opera,Sys.Browser.name="Opera");navigator.platform.indexOf("Mac")>-1?Sys.Platform.name=Sys.Platform.Mac:navigator.platform.indexOf("Win")>-1&&(Sys.Platform.name=Sys.Platform.Windows);Sys.UI={};Sys.UI.DomEvent=function(n){var t=n;this.type=t.type.toLowerCase();this.rawEvent=t;this.altKey=t.altKey;this.clientX=t.clientX;this.clientY=t.clientY;this.ctrlKey=t.ctrlKey;this.target=t.target?t.target:t.srcElement;this.screenX=t.screenX;this.screenY=t.screenY;this.shiftKey=t.shiftKey};Sys.UI.DomEvent.prototype={preventDefault:function(){this.rawEvent.preventDefault?this.rawEvent.preventDefault():window.event&&(this.rawEvent.returnValue=!1)},stopPropagation:function(){this.rawEvent.stopPropagation?this.rawEvent.stopPropagation():window.event&&(this.rawEvent.cancelBubble=!0)},_disposeHandlers:function(){Sys.UI.DomEvent._clearHandlers(this,!0);var n=this._chainDispose,t=typeof n;t!=="undefined"&&(this.dispose=n,this._chainDispose=null,t==="function"&&this.dispose())}};var $manageVolatileHandlers=Sys.UI.DomEvent._manageVolatileHandlers=function(){var u,t,n,i,f=0,r;if(_volatileElements)for(u in _volatileElements)if(t=_volatileElements[u],t&&t.length>0)for(i=t.length-1;i>=0;i-=1)if(n=t[i],n){for(r=!0;r===!0&&n.nodeType&&n.nodeType!==2&&n.nodeType<9;)n=n.parentNode,r=!!n;r===!1&&(t.splice(i,1),f+=1)}return f},$clearHandlers=Sys.UI.DomEvent._clearHandlers=function(n,t){var r,u,f,i,e;if(n._events){r=n._events;for(u in r)for(f=r[u],i=f.length-1;i>=0;i--)e=f[i],(!t||e.autoRemove)&&$removeHandler(n,u,e.handler);n._events=null}},$addHandler=Sys.UI.DomEvent.addHandler=function(n,t,i,r,u,f){var o,e,s,h;n!=null&&(n._events||(n._events={}),o=n._events[t],o||(n._events[t]=o=[]),e=null,n.addEventListener?(e=function(t){return i.call(n,new Sys.UI.DomEvent(t))},n.addEventListener(t,e,!1)):n.attachEvent&&(e=function(){var t={};try{t=Sys.UI.DomElement._getWindow(n).event}catch(r){}return i.call(n,new Sys.UI.DomEvent(t))},n.attachEvent("on"+t,e)),o[o.length]={handler:i,browserHandler:e,autoRemove:r},u&&(s=_volatileElements[f],s||(_volatileElements[f]=s=[]),s.push(n)),r&&(h=n.dispose,h!==Sys.UI.DomEvent._disposeHandlers&&(n.dispose=Sys.UI.DomEvent._disposeHandlers,typeof h!="undefined"&&(n._chainDispose=h))))},$removeHandler=Sys.UI.DomEvent.removeHandler=function(n,t,i){var f=null,r,u,e;if(n&&n._events&&(r=n._events[t],r)){for(u=0,e=r.length;u<e;u++)if(r[u].handler===i){f=r[u].browserHandler;break}n.removeEventListener?n.removeEventListener(t,f,!1):n.detachEvent&&n.detachEvent("on"+t,f);r.splice(u,1)}},$removeVolatileHandlers=Sys.UI.DomEvent.removeVolatile=function(n){var t,i,r;if(_volatileElements){if(t=_volatileElements[n],t&&t.length>0)for(i=t.length;i>0;i--)r=t[i-1],$clearHandlers(r,!1);_volatileElements[n]=null}},$raiseEvent=Sys.UI.DomEvent.raiseEvent=function(n,t,i){var r,u,e,f;if(n&&n._events&&(r=n._events[t],r))for(u=0,e=r.length;u<e;u++)if(f=r[u].handler,f){f(this,i);break}};Sys.UI.DomElement={};Sys.UI.DomElement._getWindow=function(n){var t=n.ownerDocument||n.document||n;return t.defaultView||t.parentWindow};String.prototype.escapeSelector=function(){return this.replace(/([!"#$%&'()*+,./:;<=>?@\[\\\]^`{|}~])/g,"\\$1")};$get=Sys.UI.DomElement.getElementById=function(n,t){var i=t?t:document,r="#"+n.escapeSelector();return $(i).find(r)[0]};$getElementsByClassName=Sys.UI.DomElement.getElementsByClassName=function(n,t,i){var r,u=[],f=t?t:document;return i||(i="*"),r=$(f).find("."+n).filter(i),$.map(r,function(n){u.push(n)}),u};Sys.EventHandlerList=function(){this._list={}};Sys.EventHandlerList.prototype={addHandler:function(n,t){Array.add(this._getEvent(n,!0),t)},removeHandler:function(n,t){var i=this._getEvent(n);i&&Array.remove(i,t)},getHandler:function(n){var t=this._getEvent(n);return!t||t.length===0?null:(t=Array.clone(t),function(n,i){for(var r=0,u=t.length;r<u;r++)t[r]&&t[r](n,i)})},_getEvent:function(n,t){if(!this._list[n]){if(!t)return null;this._list[n]=[]}return this._list[n]}};Sys._Application=function(){this._domReady();this._unloadHandlerDelegate=Function.createDelegate(this,this._unloadHandler);Sys.UI.DomEvent.addHandler(window,"unload",this._unloadHandlerDelegate)};Sys._Application.prototype={_initialized:!1,_disposing:!1,_enableHistory:!1,_historyInitialized:!1,_ignoreIFrame:!1,_state:{},_historyPointIsNew:!1,_currentEntry:"",_historyFrame:null,_timerHandler:null,add_init:function(n){this._initialized?n(this,null):this.get_events().addHandler("init",n)},add_load:function(n){this.get_events().addHandler("load",n)},remove_load:function(n){this.get_events().removeHandler("load",n)},add_unload:function(n){this.get_events().addHandler("unload",n)},get_events:function(){return this._events||(this._events=new Sys.EventHandlerList),this._events},dispose:function(){if(!this._disposing){this._disposing=!0;window.pageUnload&&window.pageUnload(this,null);var n=this.get_events().getHandler("unload");n&&n(this,null);Sys.UI.DomEvent.removeHandler(window,"unload",this._unloadHandlerDelegate)}},_domReady:function(){function i(){u.initialize()}var t,u=this,n=document,f,r;if(n.addEventListener)try{n.addEventListener("DOMContentLoaded",t=function(){n.removeEventListener("DOMContentLoaded",t,!1);i()},!1)}catch(e){}else n.attachEvent&&(window==window.top&&n.documentElement.doScroll?(r=n.createElement("div"),t=function(){try{r.doScroll("left")}catch(n){f=window.setTimeout(t,0);return}r=null;i()},t()):n.attachEvent("onreadystatechange",t=function(){n.readyState==="complete"&&(n.detachEvent("onreadystatechange",t),i())}))},_unloadHandler:function(){this.dispose()},_raiseInit:function(){var n=this.get_events().getHandler("init");n&&n(this,null)},initialize:function(){if(!this._initialized&&!this._disposing){if(this._initialized=!0,this._raiseInit(),this.get_stateString){var n=this.get_stateString();n!==this._currentEntry?this._navigate(n):this._ensureHistory()}this.raiseLoad()}},raiseLoad:function(){var n=this.get_events().getHandler("load");this._loaded=!0;n&&n(this,null);window.pageLoad&&window.pageLoad(this,null)}};Sys.HistoryEventArgs=function(n){this._state=n;this.get_state=function(){return this._state}};Sys._Application.prototype.add_navigate=function(n){this.get_events().addHandler("navigate",n)};Sys._Application.prototype._onIFrameLoad=function(n){this._ensureHistory();this._ignoreIFrame||(this._historyPointIsNew=!1,this._navigate(n));this._ignoreIFrame=!1};Sys._Application.prototype.set_enableHistory=function(n){this._enableHistory=n};Sys._Application.prototype.addHistoryPoint=function(n,t){if(!this._enableHistory)throw"History disabled";this._ensureHistory();var i=n;this._historyPointIsNew=!0;this._setState(i,t);this._raiseNavigate()};Sys._Application.prototype._ensureHistory=function(){if(!this._historyInitialized&&this._enableHistory){try{this._initialState=this.get_stateString()}catch(n){}this._historyInitialized=!0}};Sys._Application.prototype._navigate=function(n){this._ensureHistory();var t=n;this._setState(n);this._state=t;this._raiseNavigate()};Sys._Application.prototype._setState=function(n,t){var i,u,r,f;this._enableHistory&&(n=n||"",n!==this._currentEntry&&(window.theForm&&(i=window.theForm.action,u=i.indexOf("#"),window.theForm.action=(u!==-1?i.substring(0,u):i)+"#"+n),this._historyFrame&&this._historyPointIsNew&&(n=unescape(n),this._ignoreIFrame=!0,r=this._historyFrame.contentWindow.document,r.open("javascript:'<html><\/html>'"),r.write("<html><head><title>"+(t||document.title)+'<\/title><script type="text/javascript">parent.Sys.Application._onIFrameLoad( \''+escape(n)+"' );<\/script><\/head><body><\/body><\/html>"),r.close()),this._ignoreTimer=!1,this._currentEntry=n,(this._historyFrame||this._historyPointIsNew)&&(f=this.get_stateString(),n!==f&&(window.location.hash=n,this._currentEntry=this.get_stateString(),typeof t!="undefined"&&t!==null&&document.title==""&&(document.title=t))),this._historyPointIsNew=!1))};Sys._Application.prototype.get_stateString=function(){var n,t,i;return Sys.Browser.agent===Sys.Browser.Firefox?(t=window.location.href,i=t.indexOf("#"),i!==-1?t.substring(i+1):""):(n=window.location.hash,n.length>0&&n.charAt(0)==="#"&&(n=n.substring(1)),n)};Sys._Application.prototype._raiseNavigate=function(){var t=this._historyPointIsNew,n=this.get_events().getHandler("navigate"),i=this._state,r=new Sys.HistoryEventArgs(i);if(n&&n(this,r),!t)try{Sys.Browser.agent===Sys.Browser.Firefox&&window.location.hash&&(!window.frameElement||window.top.location.hash)&&(Sys.Browser.version<3.5?window.history.go(0):location.hash=this.get_stateString())}catch(u){}};Sys.Application=new Sys._Application;Type.registerNamespace("b365");b365.Sys=function(){this._eleList=[];this._eleList.A=0;this._eleList.INPUT=1;this._eleList.SELECT=2;this._filter=function(n,t,i,r){var u=n?n:0;return u=r?t&&u<t?t:u:t&&u>t||!u?t:u,r?i&&u<i?i:u:i&&u>i||!u?i:u}};b365.Sys.prototype={getEleSib:function(n,t,i){for(var r=t=="n"?n.nextSibling:n.previousSibling;r!=null&&(r.nodeType!=1||i&&!$hasCls(r,i));)r=t=="n"?r.nextSibling:r.previousSibling;return r!=null&&r.nodeType!=1&&(r=null),r},getPTag:function(n,t,i,r){if(r=typeof r=="undefined"||r==null?0:r+1,!n)return null;if(t==null||n.tagName==t)if(i){if(n.className!=null&&n.className.indexOf(i)>=0)return n}else return n;return r>10?null:this.getPTag(n.parentNode,t,i,r)},getCTag:function(n,t,i){for(var r,u;n&&n.nodeType===3;)n=n.nextSibling;return!n||n.tagName==t&&(!i||n.className.indexOf(i)>=0)?n:(r=this.getCTag(n.firstChild,t,i),r&&r.tagName==t&&(!i||r.className.indexOf(i)>=0))?r:(u=this.getCTag(n.nextSibling,t,i),u&&u.tagName==t&&(!i||u.className.indexOf(i)>=0))?u:null},getParIDTag:function(n,t,i){var r,u,f;if(n&&t&&i&&(r=t.getElementsByTagName(i),r&&r.length>0))for(u=0;u<r.length;u++)if(f=r[u].getAttribute("id"),f&&f.startsWith(n))return r[u];return undefined},getParIDPTag:function(n,t,i){if(typeof n!="undefined"){while(n!=null){if(n.id&&(i&&n.tagName==i&&n.id.startsWith(t)||n.id.startsWith(t)))break;n=n.parentNode}return n}return undefined},getMediaType:function(n){var t=this.getPTag(n,null,"MTsrc",null),i="";return t&&t.getAttribute("data-mt")&&(i=t.getAttribute("data-mt")),i},getItemIdSuffix:function(n,t,i){return n=this.getParIDPTag(n,t,i),n?n.id.substring(t.length):-1},firstChild:function(n,t,i){var r=$(n).find("*").not("[type=text]");return typeof t!="undefined"&&t!==""&&(r=r.filter(t)),typeof i!="undefined"&&i!==""&&(r=r.filter("."+i)),r.first()[0]},parentNode:function(n){for(n=n.parentNode;n!=null&&n.nodeType===3;)n=n.parentNode;return n},toggleElement:function(n){typeof n!="undefined"&&n!=null&&(n.className.indexOf("hidden",0)==-1?(n.className=n.className.length>0?n.className+" hidden":"hidden",n.disabled=!0):this.showElement(n))},addClass:function(n,t){typeof n!="undefined"&&n!==null&&(RegExp("\\b"+t+"\\b","ig").test(n.className)||(n.className+=n.className.length>0?" "+t:t))},removeClass:function(n,t){typeof n!="undefined"&&n!==null&&(n.className=n.className.replace(RegExp("\\b"+t+"\\b","ig"),"").trim())},swapClass:function(n,t,i){this.removeClass(n,t);this.addClass(n,i)},getOffSets:function(n){var i,r,t;try{if(i=n.offsetLeft,r=n.offsetTop,n.offsetParent)for(t="static",window.getComputedStyle?t=window.getComputedStyle(n.offsetParent,null).getPropertyValue("position"):n.currentStyle&&(t=n.currentStyle.position);n.offsetParent&&t!="fixed"&&t!="absolute";)n=n.offsetParent,n&&(i+=n.offsetLeft,r+=n.offsetTop);return[i,r]}catch(u){return null}},hitTest:function(n,t,i){var r=this.getOffSets(n);return r?t>=r[0]&&t<=r[0]+n.clientWidth&&i>=r[1]&&i<=r[1]+n.clientHeight:!1},getEleW:function(n,t){return this._filter(n.innerWidth?n.innerWidth:0,n.clientWidth?n.clientWidth:0,n.scrollWidth?n.scrollWidth:0,t)},getEleH:function(n,t){return this._filter(n.innerHeight?n.innerHeight:0,n.clientHeight?n.clientHeight:0,n.scrollHeight?n.scrollHeight:0,t)},getWH:function(){return this._filter(window.innerHeight?window.innerHeight:0,document.documentElement?document.documentElement.clientHeight:0,document.body?document.body.clientHeight:0)},getWSL:function(){return this._filter(window.pageXOffset?window.pageXOffset:0,document.documentElement?document.documentElement.scrollLeft:0,document.body?document.body.scrollLeft:0)},getWST:function(){return this._filter(window.pageYOffset?window.pageYOffset:0,document.documentElement?document.documentElement.scrollTop:0,document.body?document.body.scrollTop:0)},mouseX:function(n){var t=null;return n.pageX?t=n.pageX:n.clientX&&(t=n.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)),t},mouseY:function(n){var t=null;return n.pageY?t=n.pageY:n.clientY&&(t=n.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)),t},showElement:function(n){return n!=null?(n.className.indexOf("hidden",0)!=-1&&(n.className=n.className.replace(/hidden/i,""),n.className=n.className.trim()),n.disabled=!1,n.removeAttribute("disabled"),!0):!1},hideElement:function(n){return n!=null?(n.className.indexOf("hidden",0)==-1&&(n.className+=" hidden"),n.setAttribute("disabled","true"),n.disabled=!0,!0):!1},setValueInCookie:function(n,t,i){var f=arguments.length==3||arguments.length==4&&arguments[3]==!0?!0:!1,o=this.getValueFromCookie(n,"",""),e,u,r;if(i=unescape(i),o!=""){if(t!=""){for(e=!1,u=o.split("&"),r=0;r<u.length;r++)if(u[r].startsWith(t+"=")){u[r]=t+"="+escape(i)+(!f||i.endsWith("||")?"":"||");e=!0;break}for(e||i==""||u.push(t+"="+escape(i)+(!f||i.endsWith("||")?"":"||")),i="",r=0;r<u.length;r++)i+=u[r]==""?"":u[r]+"&"}}else t!=""&&(i=t+"="+escape(i)+(!f||i.endsWith("||")?"":"||"));document.cookie=n+"="+i.replace(/\$amp\$/g,"&amp;").replace(/\$quot\$/g,"&quot;").replace(/\$lt\$/g,"&lt;").replace(/\$gt\$/g,"&gt;")+";path=/"},setValueInCookieOnlyIfNotEmpty:function(n,t,i){n!=""&&i!=""&&this.setValueInCookie(n,t,i,!1)},getValueFromCookie:function(n,t,i){for(var f=typeof i!="undefined"?i:"",u=unescape(document.cookie).split(";"),o=typeof i!="undefined"?i:"",h=!1,s,c,e,r=0;r<u.length;r++)if(s=u[r].indexOf("=")==-1?u[r].length-1:u[r].indexOf("="),c=u[r].substr(0,s).replace(/^\s+|\s+$/g,""),c==n){h=!0;f=u[r].substr(s+1).replace(/^\s+|\s+$/g,"");break}if(f=String(f).replace(/&amp;/g,"$amp$").replace(/&quot;/g,"$quot$").replace(/&lt;/g,"$lt$").replace(/&gt;/g,"$gt$"),h)if(t.length>0){for(e=f.split("&"),r=0;r<e.length;r++)if(e[r].startsWith(t+"=")){o=e[r].substring(t.length+1);break}}else o=f;return String(o).replace(/\$amp\$/g,"&amp;").replace(/\$quot\$/g,"&quot;").replace(/\$lt\$/g,"&lt;").replace(/\$gt\$/g,"&gt;")},readCookie:function(n){for(var r=n+"=",u=document.cookie.split(";"),t,i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1,t.length);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return null},setCookieValue:function(n,t){document.cookie=n+"="+t.replace(/\$amp\$/g,"&amp;").replace(/\$quot\$/g,"&quot;").replace(/\$lt\$/g,"&lt;").replace(/\$gt\$/g,"&gt;")+";path=/"},disableElement:function(n){n.getAttribute("_disabled")===null&&n.setAttribute("_disabled",n.disabled?String(n.disabled):"false");var t=n.getAttribute("href");t&&(n.setAttribute("_href",t),n.removeAttribute("href"));n.disabled||n.getAttribute("_tab")!==null||(n.setAttribute("_tab",n.tabIndex),n.setAttribute("tabIndex","-1"));n.tagName=="A"||n.id.indexOf("UName")!=-1||n.id.indexOf("PWord")!=-1||$(n).hasClass("lotto")||(n.disabled=!0,n.setAttribute("disabled","disabled"))},enableElement:function(n){var t=n.getAttribute("_disabled");t&&t==="false"&&(n.disabled=!1,n.removeAttribute("disabled"),n.removeAttribute("_disabled"),n.getAttribute("_href")&&(n.setAttribute("href",n.getAttribute("_href")),n.removeAttribute("_href")),n.getAttribute("_tab")!==null&&(n.tabIndex=n.getAttribute("_tab"),n.removeAttribute("_tab")))},disableGroup:function(n){var i,t;if(this._eleList&&this._eleList.length>0){for(i=n.getElementsByTagName("*"),t=0;t<i.length;t++)typeof this._eleList[i[t].tagName]!="undefined"&&this.disableElement(i[t]);typeof this._eleList[n.tagName]!="undefined"&&this.disableElement(n)}},enableGroup:function(n){var i,t;if(this._eleList&&this._eleList.length>0){for(i=n.getElementsByTagName("*"),t=0;t<i.length;t++)typeof this._eleList[i[t].tagName]!="undefined"&&this.enableElement(i[t]);typeof this._eleList[n.tagName]!="undefined"&&this.enableElement(n)}},hasCls:function(n,t){return n&&n.className.length>0&&n.className.indexOf(t)>-1},deepCopy:function(n){var i,r;if(Object.prototype.toString.call(n)==="[object Array]"||Object.prototype.toString.call(n)==="[object Arguments]"){for(var u=[],t=0,f=n.length;t<f;t++)u[t]=this.deepCopy(n[t]);return u}if(typeof n=="object"){i={};for(r in n)i[r]=this.deepCopy(n[r]);return i}return n},getZIdx:function(n){return parseInt($(n).css("z-index"))||0}};var $bSys=new b365.Sys,$getNES=function(n,t){return $bSys.getEleSib(n,"n",t)},$getPES=function(n,t){return $bSys.getEleSib(n,"p",t)},$getPTag=function(n,t,i){return $bSys.getPTag(n,t,i)},$getCTag=function(n,t,i){return $bSys.getCTag(n,t,i)},$getParIDTag=function(n,t,i){return $bSys.getParIDTag(n,t,i)},$getParIDPTag=function(n,t,i){return $bSys.getParIDPTag(n,t,i)},$getMT=function(n){return $bSys.getMediaType(n)},$getItemIdSuffix=function(n,t,i){return $bSys.getItemIdSuffix(n,t,i)},$firstChild=function(n,t,i){return $bSys.firstChild(n,t,i)},$parentNode=function(n){return $bSys.parentNode(n)},$tglEle=function(n){return $bSys.toggleElement(n)},$showEle=function(n){return $bSys.showElement(n)},$addCls=function(n,t){return $bSys.addClass(n,t)},$remCls=function(n,t){return $bSys.removeClass(n,t)},$swpCls=function(n,t,i){return $bSys.swapClass(n,t,i)},$hideEle=function(n){return $bSys.hideElement(n)},$hasCls=function(n,t){return $bSys.hasCls(n,t)},$deepCopy=function(n){return $bSys.deepCopy(n)},$getZIndex=function(n){return $bSys.getZIdx(n)},$removeEvilTwin=function(n){var i,t,r,o;n=n.toLowerCase();var u="/liquid_style.css",f="/style.css",s="matchlive/liquid_basic.css",e="matchlive/basic.css";if(n.indexOf(s)!=-1||n.indexOf(e)!=-1||n.indexOf(u)!=-1||n.indexOf(f)!=-1){if(i=e,n.indexOf(e)!=-1&&(i=s),n.indexOf(u)!=-1&&(i=u),n.indexOf(f)!=-1&&(i=f),t=document.getElementsByTagName("link"),t&&t.length>0)for(r=0;r<t.length;r++)t[r].href.toString().indexOf(i)!=-1&&(o=t[r],o.parentNode.removeChild(o));return}},$loadCSS=function(n,t){var e,r,u,i,f,o;if($removeEvilTwin(n),e=document.getElementsByTagName("head")[0],r=document.getElementsByTagName("link"),r&&r.length>0)for(u=0;u<r.length;u++)if(r[u].href.indexOf(n)>=0){t&&t();return}i=document.createElement("link");i.setAttribute("href",n);i.setAttribute("rel","stylesheet");i.setAttribute("type","text/css");"sheet"in i?(f="sheet",o="cssRules"):(f="styleSheet",o="rules");var c=navigator.userAgent.lastIndexOf("Safari/")>0,l=document.styleSheets.length,s=setInterval(function(){try{(i[f]&&i[f][o].length||c&&document.styleSheets.length>l)&&(clearInterval(s),clearTimeout(h),t&&t())}catch(n){}},200),h=setTimeout(function(){clearInterval(s);clearTimeout(h);e.removeChild(i);throw"Script load failed";},1e4);e.appendChild(i)},$loadScript=function(n,t,i){var f,r;t=t.trim();for(var o=t,e=function(n){var t=$getFN(o)+"_loaded";typeof window[t]=="function"&&window[t](n);i&&i()},s=document.getElementsByTagName("head")[0],u=0;u<2;u++)if(f=u==0?s.getElementsByTagName("script"):document.getElementsByTagName("script"),f&&f.length>0)for(u=0;u<f.length;u++)if(f[u].src.indexOf(t.startsWith(".")?t.substring(1):t)>=0){e(n);return}r=document.createElement("script");r.setAttribute("language","javascript");r.setAttribute("type","text/javascript");r.setAttribute("src",o);r.addEventListener?r.onload=function(){e(n)}:r.readyState&&(r.onreadystatechange=function(){(r.readyState=="loaded"||r.readyState=="complete")&&e(n)});s.appendChild(r)},$setGlobal=function(n,t,i){if(typeof window[n]!="function"&&typeof t=="string")try{window[n]=JSON.parse(t);i&&i()}catch(r){window[n]=null;i&&i()}},cacheTokens=[],$setCachePolicy=function(n,t){var u,i,e,f=n.split(","),r;if(f)for(r=0;r<f.length;r++)u=f[r].split("="),i=u[0].split("."),e=u[1],cacheTokens[i[0]]||(cacheTokens[i[0]]=[]),cacheTokens[i[0]][i[1]]=e;t&&t()},$getFN=function(n){var t=n.match(/(.*)[\/\\](\w+)/);return t&&t.length>=3?t[2]:""},$setTitleText=function(n,t){document.title=n;t&&t()},$formatDatePart=function(n){return n<10?"0"+n:n},$getTimeAsHHMMSS=function(n){var t=$formatDatePart(n.getHours()),i=$formatDatePart(n.getMinutes()),r=$formatDatePart(n.getSeconds());return t+":"+i+":"+r},$getComputedPadding=function(n){var t,i=$getAppliedStyle(n);return t=parseInt(i.paddingRight.replace("px",""))+parseInt(i.paddingLeft.replace("px","")),isNaN(t)?0:t},$getAppliedStyle=function(n){return typeof n.currentStyle!="undefined"?n.currentStyle:document.defaultView.getComputedStyle(n,null)},$getLen=function(n,t){var i=0;return t&&(i=n.style.width.replace("px",""),i=isNaN(parseInt(i))?0:i,i&&i!=0||(i=$getAppliedStyle(n),i=i.width.replace("px",""),i=isNaN(parseInt(i))?0:i)),i&&i!=0||(i=n.clientWidth),i&&i!=0||(i=n.innerWidth),i&&i!=0||(i=n.scrollWidth),i};Type.registerNamespace("b365.Ui"),function(n){n.fn.disableElement=function(){return this.each(function(){n(this).attr("_disabled")===undefined&&n(this).attr("_disabled",n(this).prop("disabled")?n(this).prop("disabled"):"false");n(this).prop("href")&&(n(this).attr("_href",n(this).prop("href")),n(this).removeProp("href"));n(this).prop("disabled")||n(this).attr("_tab")||(n(this).attr("_tab",n(this).prop("tabIndex")),n(this).prop("tabIndex","-1"));n(this).prop("disabled",!0).addClass("disabled")})};n.fn.enableElement=function(){return this.each(function(){if(n(this).removeProp("disabled").removeAttr("disabled").removeAttr("_disabled").removeClass("disabled"),n(this).attr("_href")){var t=n(this).html();n(this).prop("href",n(this).attr("_href"));n(this).removeAttr("_href");n(this).html(t)}n(this).attr("_tab")&&(n(this).prop("tabIndex",n(this).attr("_tab")),n(this).removeAttr("_tab"))})}}(jQuery),function(n,t){function i(n,t,i,r,u,f,e){this._dataUrl=n;this._dataEvent=t;this._errorEvent=i;this._arguments=arguments;this._timeOut=r;this._timeOutEvent=u;this._cacheRequest=!0;typeof f!="undefined"&&f!==null&&(this._cacheRequest=!f);this._reqInstanceId=e;this._ajaxObject=null}function r(n){return n.status==200&&(n.statusText=="OK"||n.statusText=="200 OK")}i.prototype.Load=function(n){var i=this;n||(n="GET");i._ajaxObject=t.ajax({type:n,url:i._dataUrl,cache:i._cacheRequest,timeout:this._timeOut,async:!device.isBlackBerry,beforeSend:function(n){n.overrideMimeType("text/plain")},error:function(n,t){t==="timeout"&&typeof i._timeOutEvent!="undefined"&&i._timeOutEvent!==null?i._timeOutEvent(i._reqInstanceId):(t==="error"||n.status!=0)&&typeof i._errorEvent!="undefined"&&i._errorEvent!==null&&i._errorEvent(n.status,n.statusText,i._reqInstanceId)},complete:function(n){r(n)&&i.OnData(i,n.responseText)}})};i.prototype.Post=function(n){var i=this;i._ajaxObject=t.ajax({type:"POST",url:this._dataUrl,cache:i._cacheRequest,timeout:this._timeOut,data:n,beforeSend:function(t){t.setRequestHeader("Content-type","application/x-www-form-urlencoded");t.setRequestHeader("Content-length",n.length);t.setRequestHeader("Connection","close");t.overrideMimeType("text/plain")},error:function(n,t){t==="timeout"&&typeof i._timeOutEvent!="undefined"&&i._timeOutEvent!==null?i._timeOutEvent(i._reqInstanceId):n.status!=0&&typeof i._errorEvent!="undefined"&&i._errorEvent!==null&&i._errorEvent(n.status,n.statusText,i._reqInstanceId)},complete:function(n){r(n)&&i.OnData(i,n.responseText)}})};i.prototype.LoadSynchronous=function(){var n=this;n._ajaxObject=t.ajax({type:"GET",url:this._dataUrl,async:!1,timeout:this._timeOut,cache:n._cacheRequest,beforeSend:function(n){n.overrideMimeType("text/plain")},error:function(t,i){i==="timeout"&&typeof n._timeOutEvent!="undefined"&&n._timeOutEvent!==null?n._timeOutEvent(n._reqInstanceId):t.status!=0&&typeof n._errorEvent!="undefined"&&n._errorEvent!==null&&n._errorEvent(t.status,t.statusText,n._reqInstanceId)},complete:function(t){r(t)&&n.OnData(n,t.responseText)}});return};i.prototype.OnData=function(n,t){t.search(/SERVER_ERROR/)>-1&&(n._arguments[7][n._arguments[7].length]=n._arguments[7][0],n._arguments[7].length++,n._arguments[7][0]=99,t=t.replace(/SERVER_ERROR/,""));typeof n._dataEvent!="undefined"&&n._dataEvent!==null&&n._dataEvent(t,n._arguments)};i.prototype.Abort=function(){var n=this;typeof n._ajaxObject!="undefined"&&n._ajaxObject!=null&&(n._ajaxObject.abort(),n._ajaxObject=null)};n.b365BsAJAX=i}(window,jQuery);b365.Ui.BetSlipLib=function(){this._alwaysInclude="*~"};b365.Ui.BetSlipLib.prototype={calcTotalStake:function(n,t){var e=0,r=0,u,f;for(t=t?t:"st",i=0;i<n.length;i++)r=Number(n[i].getStItem(t)?n[i].getStItem(t):""),u=n[i].getStItem("ew")=="1",isNaN(r)===!1&&(r=r*100,f=Number(n[i].getCnItem("bc")?n[i].getCnItem("bc"):n[i].getStItem("bc")?n[i].getStItem("bc"):"1"),e+=f>1||u?Number(String(r*(u?2:1)*f)):r);return this.pad2DP(String(e/100))},isDuplicate:function(n,t){var r=!1,f=t.getCnItem("pt"),u=function(n,t){return n.getCnItem("spt")===t.getCnItem("spt")&&n.getCnItem("cm")===t.getCnItem("cm")&&n.getCnItem("ct")===t.getCnItem("ct")&&n.getCnItem("f")===t.getCnItem("f")&&n.getCnItem("fp")===t.getCnItem("fp")};for(i=0;!r&&i<n.length;i++)switch(f){case"S":r=n[i].getCnItem("pid")===t.getCnItem("pid")&&n[i].getCnItem("mid")===t.getCnItem("mid");break;case"CB":r=u(t,n[i]);break;case"TB":switch(t.type){case bs.betTypeToteCast:case bs.betTypeUsToteCast:case bs.betTypeEToteCast:case bs.betTypeToteNonCast:case bs.betTypeUsToteNonCast:case bs.betTypeEToteNonCast:r=u(t,n[i])}break;default:n[i].getCnItem("fp")===t.getCnItem("fp")&&n[i].getCnItem("f")==t.getCnItem("f")&&(r=n[i].getCnItem("Inc")==t.getCnItem("Inc")?!0:!1)}return r},getItemOdds:function(n,t){var r,i;switch(n){case bs.betTypeCast:case bs.itemTypeCast:case bs.betTypeBetBuilder:case bs.itemTypeBetBuilder:r=t.getStItem;break;default:r=t.getCnItem}return i=r("BOdds"),i||(i=r("o")),i||(i=""),i},to2DP:function(n,t){var r,i;return t=t||".",r=t==="."?",":".",n=n.replace(new RegExp("\\"+r,"g"),t),i=n.indexOf(t),i!=-1&&n.length-i>3&&(n=n.substr(0,i+3)),n},pad2DP:function(n,t){var u,i,r;return t=t||".",u=t==="."?",":".",n=n.replace(new RegExp("\\"+u,"g"),t),n=n.trim(),n===t||n===""?n="0"+t+"00":(n=this.to2DP(n,t),i=n.indexOf(t),i==-1?n+=t+"00":(r=n.length-(i+1),r==0?n+="00":r==1&&(n+="0"))),n},roundDecimal:function(n,t){var u,i,r;return t=t||".",u=t==="."?",":".",n=n.replace(new RegExp("\\"+u,"g"),t),n=n.trim(),n===t||n===""?n="0"+t+"00":(n=this.roundValue(n,t),i=n.indexOf(t),i==-1?n+=t+"00":(r=n.length-(i+1),r==0?n+="00":r==1&&(n+="0"))),n},roundValue:function(n,t){var s,f,e,i,r,u,o;if(t=t||".",s=t==="."?",":".",n=n.trim(),f="0",n!="NaN"&&n.indexOf(t)>=0){if(e=n.split(t),i=e[0],r=e[1],r.trim().length==0)return n;r=r.length>4?r.substring(0,3):r;u=r.substring(2,3);Number(u)>=5?(u=r.substring(1,2),Number(u)==9?(o=r.substring(0,1),Number(o)==9?(i=Number(i)+1,f=String(i)):(u=Number(o)+1,i=i+t+u,f=String(i))):(u=Number(u)+1,u=String(r.substring(0,1))+String(u),i=i+t+u,f=i)):r.length==1?(i=i+t+r,f=i):(i=i+t+r.substring(0,2),f=i)}else f=n===""||n=="NaN"?"":isNaN(n)?n:n;return f},riskToWin:function(n,t,i,r,u,f){var e=Function.createDelegate(this,f||f==undefined?this.pad2DP:this.roundDecimal),o=isNaN(n)?0:n*1,s=eval(t),h;return(u=u||isNaN(s),!u)?r?e(String(o*2)):(h=o*s/1,e(String(h))):""},winToRisk:function(n,t,i,r){var u=0;if(r)u=Math.round(n*50)/100;else{u=isNaN(n)?0:n/eval(t);u=Number(this.roundValue(String(u)));for(var f=u*1,e=1+eval(t),o=Math.round(f*(e-1)*100)/100;o<n;)u=u+.01,f=u*1,e=1+eval(t),o=Math.round(f*(e-1)*100)/100}return this.roundValue(String(u))},isDecimal:function(n){return(n.indexOf(",")!==-1&&(n=n.replace(/,/g,".")),String(n).trim()==="0."||String(n).trim()==="."||n==="")?!0:isNaN(Number(n))==!0?!1:!0},getMaxStake:function(){return 999999999},getMaxToWin:function(){var n=$get("bs",$get("bsDiv")),t=99999999;return n&&n.getAttribute("data-mtwin")&&Number(n.getAttribute("data-mtwin"))>0&&(t=Number(n.getAttribute("data-mtwin"))),t},doBetMax:function(n,t,i,r,u){return lgh.isAuthenticated()?(u.req(bs.reqTypeMaxBet,"key="+n+"-"+String(t)+"-"+i+"-"+r),!0):!1},alwaysShowToolTipItem:function(n){return n.startsWith(this._alwaysInclude)},formatAlwaysShowToolTip:function(n){return n.replace(this._alwaysInclude,"")},numDecPlcs:function(n){var t=String(n),i=".";return t.indexOf(i)>-1?t.length-t.indexOf(i)-1:0},getBetItemIndex:function(n,t){var f=-1,r=new b365.Ui.BetDTO,u,i,e,o;for(r.parse(n),u=t.getBetItems(),i=0,e=u.length;i<e;i++)if(r.getCnItem("mid")&&r.getCnItem("pid")){if(u[i].getCnItem("f")==r.getCnItem("f")&&u[i].getCnItem("mid")==r.getCnItem("mid")&&u[i].getCnItem("pid")==r.getCnItem("pid")){f=i;break}}else if(u[i].getCnItem("fp")===r.getCnItem("fp")&&u[i].getCnItem("f")==r.getCnItem("f")&&(r.getCnItem("Inc")?r.getCnItem("Inc")===u[i].getCnItem("Inc"):!0)&&(u[i].getCnItem("pt")==="S"?r.getCnItem("pt")===u[i].getCnItem("pt"):!0)){f=i;break}else if(u[i].getCnItem("id")&&u[i].getCnItem("id")===r.getCnItem("id")){f=i;break}else if(o=u[i].getStItem("pp")||u[i].getCnItem("pp")||"",(u[i].getCnItem("fp")===r.getCnItem("fp")||o===r.getCnItem("fp"))&&u[i].getCnItem("f")==r.getCnItem("f")&&(r.getCnItem("Inc")?r.getCnItem("Inc")===u[i].getCnItem("Inc"):!0)){f=i;break}return f}};$blib=new b365.Ui.BetSlipLib;b365.Ui.BBItem=function(){var n={};this.parse=function(t){var i=t.split("#"),r;for(subItem in i)i[subItem].length>0&&(r=i[subItem].split("="),n[r[0]]=r[1])};this.getValue=function(t){return n[t]};this.setValue=function(t,i){n[t]=i};this.toString=function(){var i="",t;for(t in n)i+=t+"="+n[t]+"#";return i}};b365.Ui.BetDTO=function(n){this.type=n;var r=[],t=[],u,f,e,o=[],s=function(n,t){u=t.split("#");for(f in u)u[f].length>0&&(e=u[f].split("="),n[e[0]]=e[1])},h=function(n,t){var e,r="il",h,u,i,f;if(t&&t.indexOf(r+"=")>-1){e=t.split(r+"=");i=e[1];h=i.charAt(i.length-1)==="#";n[r]=h?i.substr(0,i.length-1):i;u=i.split("^");for(i in u)f=new b365.Ui.BBItem,f.parse(u[i]),o.push(f)}else s(n,t)};this.parse=function(n){var e=this.type===bs.betTypeBetBuilder?h:s,u=n.split("|"),f,i;for(t={},r={},f=r,i=0;i<u.length;i++)u[i].length>0&&e(f,u[i]),f=t};this.toString=function(){var i="",f="",n,u,r;if(this.type===bs.betTypeBetBuilder)for(i="il=",u=this.getBBItems(),r=0;r<u.length;r++)i+=u[r].toString(),i+=r<u.length-1?"^":"";else i=this.getCn();for(n in t)n=="st"&&(t[n]=t[n]!==""?t[n].toString().replace(",","."):""),f+=n+"="+t[n]+"#";return i+(f===""?"":"|")+f};this.getBBItems=function(){return o};this.getCn=function(){var n="",t;for(t in r)n=n+t+"="+r[t]+"#";return n};this.getCnItem=function(n){return r[n]};this.setCnItem=function(n,t){r[n]=t};this.removeCnItem=function(n){delete r[n]};this.getStItem=function(n){return t[n]};this.setStItem=function(n,i){t[n]=i};this.removeStItem=function(n){delete t[n]};this.parseCookieString=function(n,t){var r=n.split("||"),f=[],u,i;if(n.length>0)for(u in r)r[u].length>0&&(i=new b365.Ui.BetDTO(t),i.parse(r[u]),t!=bs.betTypeMultiple&&t!=bs.betTypeBetBuilder&&(i.setStItem("es",1),i.setStItem("FO","False")),Array.add(f,i));return f};this.serialize=function(n){var t="";for(i=0;i<n.length;i++)t+=n[i].toString()+"||";return t};this.getTopic=function(){return this.getTopicItem(0)};this.getOddsOverride=function(){return this.getTopicItem(1)};this.getDecimalPlaces=function(){return this.getTopicItem(2)};this.getTopicItem=function(n){var t=(this.getStItem("TP")||"").split("x");return t.length>n?t[n]:""}};$bto=new b365.Ui.BetDTO;b365.Ui.BetSlipAPI=function(n){this._events=new Sys.EventHandlerList;this._b365BsAJAX=null;this._lock=!1;this._betSlipCookieKey=n;this._betSlipCookieBackup=null;this._pushBetSlipCookieBackup=null;this._betItems=[];this._betMltItems=[];this._betCastItems=[];this._betBuilderItems=[];this._clearOnAdd=!1;this._controller=null;this._clickToCallHandler=null;this._pollTime=null;this._pollInterval=null;this._pollForceStop=!1;this._pollReference=null;this._pollRequestParams=null;this._pollCount=0;this._pollReqType=0;this._pollInProcess=!1;this._betSlipModeBetSlip=1;this._betSlipModeConfirm=2;this._betSlipModeReceipt=3;this._dialogModeConfirmation=1;this._dialogModeDialog=2;this.betTypeAll=-1;this.betTypeNormal=0;this.betTypeMultiple=1;this.betTypeLotto=2;this.betTypeCast=3;this.betTypeToteCast=4;this.betTypeToteNonCast=5;this.betTypeToteAll=6;this.betTypeUsToteCast=7;this.betTypeUsToteNonCast=8;this.betTypeUsToteAll=9;this.betTypeAllAccept=11;this.betTypeEToteCast=12;this.betTypeEToteNonCast=13;this.betTypeTotePot=14;this.betTypeUsTotePot=15;this.betTypeETotePot=16;this.betTypeFrgnToteCast=17;this.betTypeFrgnToteNonCast=18;this.betTypeFrgnTotePot=19;this.betTypeTotePotAus=20;this.betTypeLottoFrame=21;this.betTypeBetBuilder=22;this.reqTypeRefreshSlip=0;this.reqTypeAddItems=1;this.reqTypePlaceBet=2;this.reqTypeRefreshLottoSlip=3;this.reqTypePlaceLottoBet=4;this.reqTypeMaxBet=5;this.reqTypeBetBrk=7;this.reqTypePitcher=8;this.reqTypeRefreshAccept=9;this.reqTypeReferBet=10;this.reqTypePollReferredBet=11;this.reqTypeConfirmBet=13;this.reqTypeConstructAndAddItems=15;this.reqTypePhoneBet=17;this.reqTypeLoadMobileLottoBetslip=18;this.reqTypePlaceMobileLottoBet=19;this.reqTypePollTempBetReceipt=20;this.reqTypeGetCTCBetDetails=21;this.reqRefreshDuplicateBetGuid=22;this.reqTypeItalySplitStakeConfirm=23;this.postPayload="";this.slipStandard="1";this.slipBanker="2";this.slipIF="3";this.slipReverseIF="4";this.slipFixedTeaser="5";this.slipNumbers="7";this.slipUKTote="8";this.slipUSTote="9";this.slipETote="10";this.slipFinancials=100;this.slipFinancialsblank=9997;this.toteTypeNotTote="0";this.toteTypeUKTote="1";this.toteTypeETote="2";this.toteTypeUSTote="3";this.toteTypeForeignTote="4";this.toteTypeAustralianTote="5";this.itemTypeSingle="single";this.itemTypeToteSingle="tote-single";this.itemTypeCast="cast";this.itemTypeToteCast="tote-cast";this.itemTypeTotePot="tote-pot";this.itemTypeMultiple="multiple";this.itemTypeBetBuilder="betbuilder";this.itemTypeAll="all";this.deviceType="";this.betSource="";this.showStreaming=!1;this.showFullTextMode=!1;this.showFixtureDate=!1;this.footerLinks=null;this.keyboardType=null;this.refreshUserBalance=!0;this.isoCode="";this.useTruncated2dpPriceForReturnsCalc=!1;this.pushBetStatus=null;this.pendingPushBetElement=null;this.isSiteOverlaySpinnerShowing=!1;this.toggledBankerSelectionState=!1};b365.Ui.BetSlipAPI.prototype={pageLoad:function(){var n=this.getHandler("onpageload");n&&n(this)},addBet:function(){try{var n=this.getHandler("onaddbet");if(n&&this._lock===!1){try{trk&&trk.send(null,EnumRegionID.Right,-1,EnumEventsOrPageTypes.Click,EnumPodID.Coupon,-1,arguments[0])}catch(i){}n(this,arguments)}}catch(t){this.displayError(t.message)}},refresh:function(n,t,i){try{if(this._lock===!1)switch(n){case this.betTypeLottoFrame:this.req(this.reqTypeRefreshLottoSlip,t);break;case this.betTypeLotto:this.req(this.reqTypeRefreshSlip,t);break;case this.betTypeAllAccept:this.req(this.reqTypeRefreshAccept,t);break;case this.reqTypePhoneBet:this.req(this.reqTypePhoneBet,t,"",i);break;default:this.req(this.reqTypeRefreshSlip,t)}}catch(r){this.displayError(r.message)}},updateState:function(){var n=this.getHandler("onupdatestate");n&&n(this)},onPBetError:function(){var n=this.getHandler("onpbeterror");n&&n(this)},clearBets:function(n){if(!this._pollInProcess)try{this.setValueInBSCookie("","");this._betItems=[];this._betMltItems=[];this._betCastItems=[];this._betBuilderItems=[];n&&this.req(this.reqTypeRefreshSlip)}catch(t){this.displayError(t.message)}},confirmBets:function(){try{var n=this.getHandler("onconfirmbet");n&&this._lock===!1&&n(this)}catch(t){this.displayError(t.message)}},placeBets:function(){try{var n=this.getHandler("onplacebet");n&&this._lock===!1&&(this.updateState(),n(this))}catch(t){this.displayError(t.message)}},referBets:function(){try{this.resetPoll();var n=this.getHandler("onreferbet");n&&this._lock===!1&&n(this)}catch(t){this.displayError(t.message)}},pollBet:function(n,t,i,r,u){this.setPollTimeSettings(i,r);this._pollCount<this._pollTime/this._pollInterval&&!this._pollForceStop?(this._pollReqType=n,this._pollReference=t,this._pollRequestParams=u,this._pollCount++,this._pollForceStop=!1,setTimeout(Function.createDelegate(this,this.execPoll),this._pollInterval*1e3)):this.execPollExpired()},execPoll:function(){var t,n;try{t=this.getHandler("onpoll");t&&this._lock===!1&&(n=[],Array.add(n,this._pollReqType),Array.add(n,this._pollReference),Array.add(n,this._pollRequestParams),t(this,n))}catch(i){this.resetPoll();this.displayError(i.message)}},execPollExpired:function(){var t,n;try{t=this.getHandler("onpollexpired");t&&this._lock===!1&&(n=[],Array.add(n,this._pollReqType),Array.add(n,this._pollForceStop),t(this,n))}catch(i){this.displayError(i.message)}},pollInProgress:function(){return this._pollReference!==null||this._pollRequestParams!==null},resetPoll:function(){this._pollReqType=0;this._pollReference=null;this._pollRequestParams=null;this._pollCount=0;this._pollForceStop=!1},setPollTimeSettings:function(n,t){n&&t&&(this._pollTime=n,this._pollInterval=t)},deleteItem:function(){try{var n=this.getHandler("ondeleteitem");n&&this._lock===!1&&n(this,arguments)}catch(t){this.displayError(t.message)}},getBetItems:function(n){switch(n){case this.betTypeCast:case this.betTypeToteCast:case this.betTypeUsToteCast:case this.betTypeTotePot:case this.betTypeUsTotePot:case this.betTypeEToteCast:case this.betTypeETotePot:case this.betTypeFrgnToteCast:case this.betTypeFrgnTotePot:case this.betTypeTotePotAus:case this.itemTypeCast:case this.itemTypeTotePot:case this.itemTypeToteCast:return this._betCastItems;case this.betTypeMultiple:case this.itemTypeMultiple:return this._betMltItems;case this.betTypeBetBuilder:case this.itemTypeBetBuilder:return this._betBuilderItems;case this.betTypeAll:case this.itemTypeAll:return this._betItems.concat(this._betCastItems).concat(this._betMltItems).concat(this._betBuilderItems);default:return this._betItems}},containsPhoneOnlyBet:function(){for(var t=this.getBetItems(),i=!1,n=0;n<t.length;n++)if(t[n].getStItem("pom")=="Y"){i=!0;break}return i},getBetItemById:function(n,t){var r;switch(n){case this.betTypeToteNonCast:case this.betTypeEToteNonCast:case this.betTypeUsToteNonCast:case this.betTypeFrgnToteNonCast:case this.betTypeNormal:case this.itemTypeSingle:case this.itemTypeToteSingle:r=this._betItems[t];break;case this.betTypeBetBuilder:case this.itemTypeBetBuilder:return this._betBuilderItems[t];case this.betTypeCast:case this.betTypeToteCast:case this.betTypeUsToteCast:case this.betTypeTotePot:case this.betTypeUsTotePot:case this.betTypeEToteCast:case this.betTypeETotePot:case this.betTypeFrgnToteCast:case this.betTypeFrgnTotePot:case this.betTypeTotePotAus:case this.itemTypeCast:case this.itemTypeTotePot:case this.itemTypeToteCast:r=this._betCastItems[t];break;default:for(i=0;i<this._betMltItems.length;i++)if(this._betMltItems[i].getCnItem("id")==String(t)){r=this._betMltItems[i];break}}return r},getBetItemByCn:function(n,t,i){for(var f,u=this.getBetItems(n),r=0;r<u.length;r++)if(u[r].getCnItem(t)==i){f=u[r];break}return f},getBetItemBySt:function(n,t,i){for(var f,u=this.getBetItems(n),r=0;r<u.length;r++)if(u[r].getStItem(t)==i){f=u[r];break}return f},setBetItems:function(n,t){switch(t){case this.betTypeCast:case this.betTypeToteCast:case this.betTypeUsToteCast:case this.betTypeTotePot:case this.betTypeUsTotePot:case this.betTypeEToteCast:case this.betTypeETotePot:case this.betTypeFrgnToteCast:case this.betTypeFrgnTotePot:case this.betTypeTotePotAus:this._betCastItems=n;break;case this.betTypeBetBuilder:case this.itemTypeBetBuilder:return this._betBuilderItems=n;case this.betTypeMultiple:this._betMltItems=n;break;default:this._betItems=n}},getSlipType:function(){return this.getValueFromBSCookie("bt").replace(/\|/g,"")},isFull:function(){return this._betItems.length+this._betCastItems.length>=14?!0:!1},okToAdd:function(n){return this.numMLExotics()<10&&this._betItems.length+this._betCastItems.length+n<=14?!0:!1},numMLExotics:function(){for(var t=0,i=["2","3","4","6","U","P","J"],n=this._betCastItems.length-1;n>=0;n--)this._betCastItems[n].getCnItem("pt")=="TB"&&i.indexOf(this._betCastItems[n].getCnItem("cm"))>-1&&t++;return t},numItems:function(n){return n===undefined&&(n=!0),this._betItems.length+this._betCastItems.length+(n===!1?0:this._betMltItems.length)+this._betBuilderItems.length},isEmpty:function(){return this._betItems.length+this._betCastItems.length+this._betMltItems.length+this._betBuilderItems.length===0},setClearOnAdd:function(n){this._clearOnAdd=n},getClearOnAdd:function(){return this._clearOnAdd},addOnAddBet:function(n){this._events.addHandler("onaddbet",n)},addOnReqComplete:function(n){this._events.addHandler("onreqcomplete",n)},addOnDeleteItem:function(n){this._events.addHandler("ondeleteitem",n)},addOnHandleInProg:function(n){this._events.addHandler("oninprogress",n)},addOnContentChangedOnClient:function(n){this._events.addHandler("oncontentchangedclient",n)},addOnContentLoaded:function(n){this._events.addHandler("oncontentloaded",n)},addOnLock:function(n){this._events.addHandler("onlockunlock",n)},addOnPageLoad:function(n){this._events.addHandler("onpageload",n)},addOnConfirmBet:function(n){this._events.addHandler("onconfirmbet",n)},addOnPlaceBet:function(n){this._events.addHandler("onplacebet",n)},addOnReferBet:function(n){this._events.addHandler("onreferbet",n)},addOnPoll:function(n){this._events.addHandler("onpoll",n)},addOnPollExpired:function(n){this._events.addHandler("onpollexpired",n)},addOnRestoreState:function(n){this._events.addHandler("onreststate",n)},addOnUpdateState:function(n){this._events.addHandler("onupdatestate",n)},addOnPBetError:function(n){this._events.addHandler("onpbeterror",n)},addScrollToTop:function(n){this._events.addHandler("onscrolltotop",n)},addOnBetAdded:function(n){this._events.addHandler("onbetadded",n)},addOnEditBet:function(n){this._events.addHandler("oneditbet",n)},addOnBetAddedReqComplete:function(n){this._events.addHandler("onbetaddedreqcomplete",n)},addOnRefreshReqComplete:function(n){this._events.addHandler("onrefreshreqcomplete",n)},addOnBetSlipItemsChanged:function(n){this._events.addHandler("onbetslipitemschanged",n)},addOnAcceptChanges:function(n){this._events.addHandler("onacceptchanges",n)},addOnBetSlipLoaded:function(n){this._events.addHandler("onbetsliploaded",n)},addOnMaxSelections:function(n){this._events.addHandler("onmaxselections",n)},addOnBetslipDisplayed:function(n){this._events.addHandler("onbetslipdisplayed",n)},addOnPlaceBetSuccess:function(n){this._events.addHandler("onplacebetsuccess",n)},addOnAddBetslipFooterLinks:function(n){this._events.addHandler("onaddbetslipfooterlinks",n)},addOnAddReceiptFooterLinks:function(n){this._events.addHandler("onaddreceiptfooterlinks",n)},addOnAddReceiptLiveAlertSignUp:function(n){this._events.addHandler("onaddreceiptlivealertsignup",n)},addOnBetslipError:function(n){this._events.addHandler("onbetsliperror",n)},addOnShowBetSlip:function(n){this._events.addHandler("onshowbetslip",n)},addOnHideBetSlip:function(n){this._events.addHandler("onhidebetslip",n)},addOnChangeBetslipHeight:function(n){this._events.addHandler("onchangebetslipheight",n)},addOnSessionExpired:function(n){this._events.addHandler("onsessionexpired",n)},addOnHandleBetGuidChange:function(n){this._events.addHandler("betguidchange",n)},raiseBetGuidChangeEvent:function(n){try{var t=this.getHandler("betguidchange");t&&t(n)}catch(i){}},removeOnBetSlipLoaded:function(n){this._events.removeHandler("onbetsliploaded",n)},ScrollToTop:function(){var n=this.getHandler("onscrolltotop");n&&n(this)},betAdded:function(n){var t=this.getHandler("onbetadded");t&&t(this,n[0].getCnItem("fp"))},betAddedReqComplete:function(){var n=this.getHandler("onbetaddedreqcomplete");n&&n(this)},editBet:function(){var n=this.getHandler("oneditbet");n&&n(this)},refreshReqComplete:function(){var n=this.getHandler("onrefreshreqcomplete");n&&n(this)},betSlipItemsChanged:function(){var n=this.getHandler("onbetslipitemschanged");n&&n(this)},acceptChanges:function(){var n=this.getHandler("onacceptchanges");n&&n(this)},betSlipLoaded:function(){var n=this.getHandler("onbetsliploaded");n&&n(this)},maxSelections:function(){var n=this.getHandler("onmaxselections");n&&n(this)},betSlipDisplayed:function(){var n=this.getHandler("onbetslipdisplayed");n&&n(this)},placeBetSuccess:function(){var n=this.getHandler("onplacebetsuccess");n&&n(this)},addBetslipFooterLinks:function(){var n=this.getHandler("onaddbetslipfooterlinks");n&&n(this)},addReceiptFooterLinks:function(){var n=this.getHandler("onaddreceiptfooterlinks");n&&n(this)},addReceiptLiveAlertSignUp:function(){var n=this.getHandler("onaddreceiptlivealertsignup");n&&n(this)},betslipError:function(){var n=this.getHandler("onbetsliperror");n&&n(this)},showBetSlip:function(){var n=this.getHandler("onshowbetslip");n&&n(this)},hideBetSlip:function(){var n=this.getHandler("onhidebetslip");n&&n(this)},changeBetslipHeight:function(){var n=this.getHandler("onchangebetslipheight");n&&n(this)},sessionExpired:function(){var n=this.getHandler("onsessionexpired");n&&n(this)},restoreState:function(){var n=this.getHandler("onreststate");n&&n(this)},lock:function(){this._lock=!0;this.lockEvent()},unlock:function(){this._lock=!1;this.lockEvent()},locked:function(){return this._lock},lockEvent:function(){var n=this.getHandler("onlockunlock");n&&n(this,this._lock)},req:function(n,t,i,r){var s=!0,h,u,e,o,l;if(r&&(this._controller=r),i=i&&i!=""?i:"#bsDiv>ul",this._lock===!1){this.lock();this._b365BsAJAX!==null&&(this._b365BsAJAX=null);var a=this.deviceType.length>0?"&devicetype="+this.deviceType:"",v=this.betSource.length>0?"&betsource="+this.betSource:"",y="&streaming="+Number(this.showStreaming),p="&fulltext="+Number(this.showFullTextMode),w="&refreshbal="+Number(this.refreshUserBalance),b="&isocode="+this.isoCode,c="",f=this.containsPhoneOnlyBet(),k=f&&window.location.host.indexOf("com.au")>-1?"&bc=y":"",d=n!==this.reqTypePollTempBetReceipt;typeof Locator!="undefined"&&Locator.pushedConfig&&Locator.pushedConfig.getIsPushBalanceEnabled()&&(c="&pb=y");f&&n==this.reqTypePlaceBet&&(e=this.getClickToCallHandler(),e&&e.clearPhoneOnlyItems());o="";(n==this.reqTypePlaceBet||n==this.reqTypePlaceMobileLottoBet)&&(o+="&betguid="+$(i).attr("data-betguid"));r&&r.clientEnhancedMode()&&(u=$("#bsDiv"),$("li",u).hasClass("disabledBetSlip")||(h=$('li[data-item-type$="multiple"], li[data-item-type$="single"], li[data-item-type$="cast"], li[data-item-type$="tote-single"], li[data-item-type$="tote-cast"], li[data-item-type$="tote-pot"], li[data-item-type$="tote-pot-leg"]',"#bsDiv"),r._enhancedBetSlipAnimations.disableBetSlip(h,u)));l="../betslip/?op="+n+"&ck="+this._betSlipCookieKey+(t&&t.length>0?"&"+t:"")+v+y+p+o+w+b+k+a+c+"&qb=0";this._ajaxInstId=(new Date).getTime();r&&r.clientActionInProgress(!0);this._b365BsAJAX=new b365BsAJAX(l,Function.createDelegate(this,this.reqComplete),Function.createDelegate(this,this.reqError),3e4,Function.createDelegate(this,this.reqTimeout),!0,this._ajaxInstId,arguments);f||this.handleInProg("show",null,null,d);this.postPayload?this._b365BsAJAX.Post(this.postPayload):this._b365BsAJAX.Load("POST")}else s=!1;return s},reqComplete:function(){this.unlock();delete this._b365BsAJAX;this._b365BsAJAX=null;this.restoreState();var n=this.getHandler("onreqcomplete");n?n(this,arguments):this.handleInProg("hide","")},reqTimeout:function(n){this.isSiteOverlaySpinnerShowing&&(this.isSiteOverlaySpinnerShowing=!this._controller.hideSiteOverlaySpinner());this.displayError(betSlipML.timeout,n);this._controller&&this._controller.clientEnhancedMode()&&$("#bsDiv").find(".disableBetSlip, .disabledBetSlip").removeClass("disableBetSlip").removeClass("disabledBetSlip")},reqError:function(n,t,i){this.isSiteOverlaySpinnerShowing&&(this.isSiteOverlaySpinnerShowing=!this._controller.hideSiteOverlaySpinner());this.displayError(betSlipML.error,i,"error");this._controller._stakeEntryHander&&this._controller._stakeEntryHander.init();this._controller&&this._controller.clientEnhancedMode()&&$("#bsDiv").find(".disableBetSlip, .disabledBetSlip").removeClass("disableBetSlip").removeClass("disabledBetSlip")},displayError:function(n,t,i){this._ajaxInstId==t&&(this.setClearOnAdd(!1),this.resetPoll(),this.unlock(),this.handleInProg("hide",n,typeof i!="undefined"?i:"alert"),this._b365BsAJAX=null)},handleInProg:function(n,t,i,r){var f=this.getHandler("oninprogress"),u=-1;this._b365BsAJAX&&this._b365BsAJAX._arguments.length>7&&(u=this._b365BsAJAX._arguments[7][0]);((u==this.reqTypePlaceBet||u==this.reqTypeConfirmBet)&&t||t==betSlipML.pleasecheckmembers)&&(t=betSlipML.pleasecheckmembers,this.onPBetError());f&&f(this,[n,t,u,typeof i!="undefined"?i:"alert",r])},contentChangedOnClient:function(){var n=this.getHandler("oncontentchangedclient");n&&n(this)},contentLoaded:function(){var n=this.getHandler("oncontentloaded");n&&n(this)},getHandler:function(n){return this._events.getHandler(n)},setValueInBSCookie:function(n,t){$bSys.setValueInCookie(this._betSlipCookieKey,n,t,!0)},getValueFromBSCookie:function(n,t){return $bSys.getValueFromCookie(this._betSlipCookieKey,n,t)},readBSCookieValue:function(n){return $bSys.readCookie(n)},backupBSCookieValue:function(n){this._betSlipCookieBackup=this.readBSCookieValue(n)},restoreBSCookieValue:function(n,t){$bSys.setCookieValue(n,t)},backupPushBetPreSplitBSCookieValue:function(n){this._pushBetSlipCookieBackup=this.readBSCookieValue(n)},setPendingPushBet:function(n,t){this.pushBetStatus=n;this.pendingPushBetElement=t},getPendingPushBetStatus:function(){return this.pushBetStatus},getPendingPushBetElement:function(){return this.pendingPushBetElement},getController:function(){return this._controller},getClickToCallHandler:function(){return this._clickToCallHandler},setClickToCallHandler:function(n){this._clickToCallHandler=n}};bs=new b365.Ui.BetSlipAPI("bs");Sys.Application.add_load(Function.createDelegate(bs,bs.pageLoad));Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.InputFocusClassHelper=function(){this._focusClassName="focus"};b365.Ui.Betslip.InputFocusClassHelper.prototype.addFocusClassToElement=function(n){n.hasClass(this._focusClassName)||n.addClass(this._focusClassName)};b365.Ui.Betslip.InputFocusClassHelper.prototype.removeFocusClassFromElement=function(n){n.hasClass(this._focusClassName)&&n.removeClass(this._focusClassName)};b365.Ui.Betslip.InputFocusClassHelper.prototype.addFocusClassToAllStakeFields=function(){};b365.Ui.Betslip.InputFocusClassHelper.prototype.removeFocusClassFromAllStakeFields=function(){var n=$('input[class*=" focus"]',"#bsDiv");n.length>0&&n.removeClass("focus")};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.StakePadController=function(){function s(n,t,i,r){var u='<div id="stakePadToolTips" class="stakePadToolTips">';return u+='<div id="stakePadToolTip" class="stakePadToolTip"><\/div>',u+="<\/div>",u+=r?'<div id="stakePad" data-item="'+n+'" data-type="'+t+'" style="display:block" class="stakePadOpen">':'<div id="stakePad" data-item="'+n+'" data-type="'+t+'">',u+='<div id="betSlipStakePadArrow" class="betSlipStakePadArrow"><\/div>',u+='<div class="betSlipStakePadKeys">',u+='<div class="betSlipStakePadFirstCol">',u+='<div class="colContainer">',u+='<button id="spKey1" class="itemKey"><span>1<\/span><\/button>',u+='<button id="spKey2" class="itemKey"><span>2<\/span><\/button>',u+='<button id="spKey3" class="itemKey"><span>3<\/span><\/button>',u+='<button id="betSlipStakePadDecimalPoint" class="itemKeyDeci"><span>'+i._decimalSeperator+"<\/span><\/button>",u+="<\/div><\/div>",u+='<div class="betSlipStakePadSecondCol">',u+='<div class="colContainer">',u+='<button id="spKey4" class="itemKey"><span>4<\/span><\/button>',u+='<button id="spKey5" class="itemKey"><span>5<\/span><\/button>',u+='<button id="spKey6" class="itemKey"><span>6<\/span><\/button>',u+='<button id="betSlipStakePadBackspace" class="itemKeyDel"><span>x<\/span><\/button>',u+="<\/div><\/div>",u+='<div class="betSlipStakePadThirdCol">',u+='<div class="colContainer">',u+='<button id="spKey7" class="itemKey"><span>7<\/span><\/button>',u+='<button id="spKey8" class="itemKey"><span>8<\/span><\/button>',u+='<button id="spKey9" class="itemKey"><span>9<\/span><\/button>',u+='<button id="spKey0" class="itemKey nrb"><span>0<\/span><\/button>',u+='<button id="betSlipStakePadOkWrapper" class="itemKeyOk nrb"><span>'+window.betSlipML.done+"<\/span><\/button>",u+="<\/div><\/div>",u+"<\/div><\/div>"}function h(n,t,i,u){var f=t,y=u?$(u):$(n.target),l=y.closest("li"),p,w,h,a,e;y.hasClass("disabled")||(l.length>0&&(n&&n.stopPropagation(),v(f),p=l[0].getAttribute("data-item-id"),w=l[0].getAttribute("data-item-type"),l.append(s(p,w,f,!1)),l.hasClass("keypad")||l.addClass("keypad"),h=$(':input[type="text"]',l),h.length==0&&(h=$(':input[type="number"]',l)),e=document.getElementById("stakePad"),a=e.getElementsByClassName("betSlipStakePadArrow"),e&&a&&$(a).removeClass("hidden"),y.hasClass("flexistk")&&(h=y,e=document.getElementById("stakePad"),e&&a&&$(a).addClass("hidden"),h.hasClass("active")||h.addClass("active")),h.length>0&&(h.removeClass("hidden"),f._inputFocusClassHelper.addFocusClassToElement(h),r(h[0].value,f,o(h[0]))),f.detach(f),e=$("#stakePad"),f._betSlipController.clientEnhancedMode()?f._betSlipController._enhancedBetSlipAnimations.showStakePad(e,i,c,[],f):f._hasKeyboardIssues&&(e=document.getElementById("stakePad"),e.style.height="118px",c.apply(f,null))),l=null)}function c(){var n=this;n._isShowing=!0;l(n);n.init(n);n._betSlipController._bsInst.changeBetslipHeight()}function u(n){var i=$("#stakePad"),r;e(n);r=$("#stakePadToolTips")[0]?$($("#stakePadToolTips")[0].parentNode):null;r&&r.hasClass("keypad")&&r.removeClass("keypad");$("#stakePadToolTips").remove();$(".flexistk.active").removeClass("active");$("#stakePad").find("button").removeClass("stakePadKeyDown");n._inputFocusClassHelper.removeFocusClassFromAllStakeFields();n._betSlipController.clientEnhancedMode()&&!n._disableAnimation?n._betSlipController._enhancedBetSlipAnimations.hideStakePad(i,!1,t,["stakePad",!1],n):(n._hasKeyboardIssues||n._disableAnimation)&&(i=document.getElementById("stakePad"),i&&(i.style.height="",t.apply(n,["stakePad",!1])))}function t(){var n=document.getElementById(arguments[0]);n&&this._isShowing&&(n.parentNode.removeChild(n),this._isShowing=arguments[1]);n=null;this._stakeHandlers.length==0&&this.init()}function y(n,t){var i=n;$(".flexistk.active").removeClass("active");i._inputFocusClassHelper.removeFocusClassFromAllStakeFields();i._inputFocusClassHelper.addFocusClassToElement(t);t.addClass("active");r(t[0].value,i,o(t[0]))}function f(n,i,r){var f=i,c=n,s,o,u;e(f);f._inputFocusClassHelper.removeFocusClassFromAllStakeFields();$(".flexistk.active").removeClass("active");s=document.getElementById("stakePad");s&&(o=$("#stakePadToolTips")[0]?$($("#stakePadToolTips")[0].parentNode):null,o&&o.hasClass("keypad")&&o.removeClass("keypad"),$("#stakePadToolTips").remove(),$("#stakePad").find("button").removeClass("stakePadKeyDown"),u=document.getElementById("stakePadOld"),u&&u.parentNode&&u.parentNode.removeChild(u),s.setAttribute("id","stakePadOld"),u=$("#stakePadOld"),f._betSlipController.clientEnhancedMode()?f._betSlipController._enhancedBetSlipAnimations.hideStakePad(u,!0,t,["stakePadOld",!0],f):f._hasKeyboardIssues&&(u[0].style.height="",t.apply(f,["stakePadOld",!1])),h(c,f,!0,r))}function l(n){var t=n,r=$(document.getElementById("stakePad")).find("button"),i,u;if(r.length>0)for(t._keyHandlers.length>0&&e(t),i=0,u=r.length;i<u;i++)t._keyHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(r[i],$.proxy(t.handleStakePadClick,t),!1,$.proxy(t.showKeyToolTip,t),$.proxy(t.hideKeyToolTip,t),$.proxy(t.hideKeyToolTip,t),$.proxy(t.touchHoldHandler,t)))}function e(n){var t,i;if(n._keyHandlers&&n._keyHandlers.length>0){for(t=0,i=n._keyHandlers.length;t<i;t++)n._keyHandlers[t]._element&&n._keyHandlers[t].destroy();n._keyHandlers=[]}n._siteClickHandler&&n._siteClickHandler._element&&n._siteClickHandler.destroy();n._siteClickHandler=null}function a(n,t){var s=$("#stakePad").closest("li"),i,h=n.target.nodeName==="SPAN"?$(n.target.parentNode):$(n.target),e,f;if(v(t),h.hasClass("betSlipStakePadDisabledKey"))return!0;if(s.length>0&&(i=$(':input[type="text"]',s),i.length==0&&(i=$(':input[type="number"]',s)),i.hasClass("flexistk")&&(i=i.closest(".active")),$("#stakePad").find("button").removeClass("stakePadKeyDown"),i.length>0&&!i.hasClass("disabled"))){if(h[0].id=="betSlipStakePadOkWrapper")return u(t),s=null,i=null,!0;h.text()=="x"?(f=i[0].value,e=i[0].selectionStart!=i[0].selectionEnd?f.slice(0,i[0].selectionStart)+f.slice(i[0].selectionEnd,f.length):f.substring(0,f.length-1),i[0].value=" ",i[0].value=e):(f=i[0].value,e=i[0].selectionStart!=i[0].selectionEnd?f.slice(0,i[0].selectionStart)+f.slice(i[0].selectionEnd,f.length):f+h.text(),e==t._decimalSeperator&&(e="0"+t._decimalSeperator),i[0].value=" ",i[0].value=e);t._bsKeyProcessor&&(t._bsKeyProcessor(i[0]),r(i[0].value,t,o(i[0])));typeof t._stakeEntryRule=="function"&&t._stakeEntryRule(i[0])}s=null;i=null}function o(n){return n.className.indexOf("bs-FlexiPercentage_TextBox")>-1}function r(n,t,i){var u=n.indexOf(t._decimalSeperator),r=u>-1,f=$("#stakePadToolTip"),e=r&&n.length-u>=3;f.length>0&&f.removeClass("stakePadToolTipShow");$("#betSlipStakePadBackspace","#stakePad").removeClass("stakePadBackSpaceKeyDown");e?($("#spKey1, #spKey2, #spKey3, #spKey4, #spKey5, #spKey6, #spKey7, #spKey8, #spKey9, #spKey0","#stakePad").addClass("betSlipStakePadDisabledKey").removeClass("stakePadKeyDown"),r&&$("#betSlipStakePadDecimalPoint","#stakePad").addClass("betSlipStakePadDisabledKey").removeClass("stakePadKeyDown")):r||i?($("#stakePad").find("button").removeClass("betSlipStakePadDisabledKey"),$("#betSlipStakePadDecimalPoint","#stakePad").addClass("betSlipStakePadDisabledKey").removeClass("stakePadKeyDown").removeClass("stakePadBackSpaceKeyDown")):$("#stakePad").find("button").removeClass("betSlipStakePadDisabledKey").removeClass("stakePadKeyDown").removeClass("stakePadBackSpaceKeyDown")}function v(n){n._betSlipController._enhancedBetSlipTypeSelector&&n._betSlipController._enhancedBetSlipTypeSelector._isShowing&&n._betSlipController._enhancedBetSlipTypeSelector.hidePopUpMenu(n._betSlipController._enhancedBetSlipTypeSelector);n._betSlipController._enhancedBetSlipOddsSelector&&n._betSlipController._enhancedBetSlipOddsSelector._isShowing&&n._betSlipController._enhancedBetSlipOddsSelector.hidePopUpMenu(n._betSlipController._enhancedBetSlipOddsSelector);n._betSlipController._enhancedBetSlipPitcherSelector&&n._betSlipController._enhancedBetSlipPitcherSelector._isShowing&&n._betSlipController._enhancedBetSlipPitcherSelector.hidePopUpMenu(n._betSlipController._enhancedBetSlipPitcherSelector);n._betSlipController._enhancedBetSlipToteSelector&&n._betSlipController._enhancedBetSlipToteSelector._isShowing&&n._betSlipController._enhancedBetSlipToteSelector.hidePopUpMenu(n._betSlipController._enhancedBetSlipToteSelector);n._betSlipController._enhancedBetSlipIfBetSelector&&n._betSlipController._enhancedBetSlipIfBetSelector._isShowing&&n._betSlipController._enhancedBetSlipIfBetSelector.hidePopUpMenu(n._betSlipController._enhancedBetSlipIfBetSelector);n._betSlipController._enhancedBetSlipTeaserTypeSelector&&n._betSlipController._enhancedBetSlipTeaserTypeSelector._isShowing&&n._betSlipController._enhancedBetSlipTeaserTypeSelector.hidePopUpMenu(n._betSlipController._enhancedBetSlipTeaserTypeSelector);n._betSlipController._enhancedBetSlipAusRaceBetTypeSelector&&n._betSlipController._enhancedBetSlipAusRaceBetTypeSelector._isShowing&&n._betSlipController._enhancedBetSlipAusRaceBetTypeSelector.hidePopUpMenu(n._betSlipController._enhancedBetSlipAusRaceBetTypeSelector);n._betSlipController._enhancedBetSlipEachWayExtraSelector&&n._betSlipController._enhancedBetSlipEachWayExtraSelector._isShowing&&n._betSlipController._enhancedBetSlipEachWayExtraSelector.hidePopUpMenu(n._betSlipController._enhancedBetSlipEachWayExtraSelector);n._betSlipController._ausToteToolTipHtmlBuilder&&n._betSlipController._ausToteToolTipHtmlBuilder._activePopup&&n._betSlipController._ausToteToolTipHtmlBuilder.hidePopUpMenu(n._betSlipController._ausToteToolTipHtmlBuilder)}function n(n,t,i,r,u,f,e,o,s){var h=this;n.indexOf("#")!=0&&(n="#"+n);h._hasKeyboardIssues=s;h._betSlipController=i;h._bsContainerElement=$(n);h._bsItemIdFunction=$.proxy(r,t);h._bsKeyProcessor=$.proxy(u,t);h._bsShowValidator=$.proxy(f,t);h._bsDisableDecimalPoint=$.proxy(e,t);h._isShowing=!1;h._stakeEntryRule=h._betSlipController.stakeEntryRule();h._disableAnimation=!1;h._showToolTips=typeof o!="undefined"?o:!0}return n.prototype._isShowing=!1,n.prototype._betSlipController=null,n.prototype._decimalSeperator=".",n.prototype._bsContainerElement=null,n.prototype._bsItemIdFunction=null,n.prototype._bsKeyProcessor=null,n.prototype._bsShowValidator=null,n.prototype._bsDisableDecimalPoint=null,n.prototype._inputFocusClassHelper=new b365.Ui.Betslip.InputFocusClassHelper,n.prototype._keyHandlers=[],n.prototype._stakeHandlers=[],n.prototype._siteClickHandler=null,n.prototype._showToolTips=!0,n.prototype._hasKeyboardIssues=!1,n.prototype._disableAnimation=!1,n.prototype.show=function(n,t){var r=this,e=$("#stakePad").closest("li"),s=t?$(t):$(n.target),c=s.closest("li"),o,a;if(r._betSlipController&&r._betSlipController._currencyDisplayHelper&&(r._decimalSeperator=r._betSlipController._currencyDisplayHelper.getDecimalSeperator()),r._isShowing)if(e.length>0&&c.length>0)if(o=$(':input[type="text"]',e),newTargetStakeElement=$(':input[type="text"]',c),o.length==0&&(o=$(':input[type="number"]',e)),o.length==0)f(n,r,t);else{var l=s.hasClass("flexistk"),p=document.getElementById("flexiBet"),v=!1;if(p)for(i=0,len=o.length;i<len;i++)if(l&&$(o[i]).hasClass("focus")){v=!0;break}a=e.attr("data-item-id")===c.attr("data-item-id")&&e.attr("data-item-type")===c.attr("data-item-type");!l&&a||l&&s.hasClass("focus")?u(r):v&&a?y(r,s):f(n,r,t)}else f(n,r);else h(n,r,!1,t);e=null},n.prototype.handleStakePadClick=function(n){a(n,this)},n.prototype.handleStakePadClickWithScope=function(n,t){a(n,t)},n.prototype.hide=function(){u(this)},n.prototype.init=function(n){var t=n||this,r=$(':input[type="text"], :input[type="number"]',t._bsContainerElement),i,u;if(this.detach(),r.length>0)for(t._stakeHandlers=[],i=0,u=r.length;i<u;i++)$(r[i]).hasClass("stk")&&(r[i].setAttribute("readonly","readonly"),t._stakeHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(r[i],$.proxy(t.show,t),!1)));t._isShowing&&!n&&(document.getElementById("stakePad")||(t._isShowing=!1))},n.prototype.detach=function(n){var t=n||this,i,r;if(t._stakeHandlers&&t._stakeHandlers.length>0){for(i=0,r=t._stakeHandlers.length;i<r;i++)t._stakeHandlers[i].destroy();t._stakeHandlers=[]}},n.prototype.reenable=function(n){l(n);n.init()},n.prototype.getStakePadMarkUp=function(n,t){return s(n,t,this,!0)},n.prototype.enableOrDisableKeys=function(n){var i,t;n&&n.length>0&&(r(n[0].value,this),i=$("#stakePad").closest("li"),t=$(':input[type="text"]',i),t.length==0&&(t=$(':input[type="number"]',i)),t.length>0&&t.addClass("focus"))},n.prototype.showKeyToolTip=function(n){var u=this,t,f,e,i,r;if(u._showToolTips!==!1){if(t=n.target.nodeName==="SPAN"?$(n.target.parentNode):$(n.target),i=$("#stakePadToolTip"),r=t.text(),t.hasClass("betSlipStakePadDisabledKey")||t[0].id=="betSlipStakePadOkWrapper"||r=="x"||r==u._decimalSeperator){i.length>0&&(t.removeClass("stakePadKeyDown"),i.removeClass("stakePadToolTipShow"));r=="x"&&t.addClass("stakePadBackSpaceKeyDown");r==u._decimalSeperator&&t.addClass("stakePadKeyDown");return}i.length>0&&(f=t[0].getBoundingClientRect().width,e=t.position().left-1,i.css("width",f+"px").css("left",e+"px"),i[0].innerHTML=r,t.addClass("stakePadKeyDown"),i.addClass("stakePadToolTipShow"))}},n.prototype.hideKeyToolTip=function(n){var u=this,t=n.target.nodeName==="SPAN"?$(n.target.parentNode):$(n.target),i=$("#stakePadToolTip"),r=t.text();if(t[0].nodeName.toLowerCase()!="button"||!t.hasClass("stakePadKeyDown")||t[0].id=="betSlipStakePadOkWrapper"||t.hasClass("betSlipStakePadDisabledKey")||r=="x"||r==u._decimalSeperator){i.length>0&&(t.removeClass("stakePadKeyDown"),t.removeClass("stakePadBackSpaceKeyDown"),i.removeClass("stakePadToolTipShow"));return}i.length>0&&(t.removeClass("stakePadKeyDown"),i.removeClass("stakePadToolTipShow"))},n.prototype.touchHoldHandler=function(n){var i=$("#stakePad").closest("li"),t,u=n.target.nodeName==="SPAN"?$(n.target.parentNode):$(n.target),r;i.length>0&&(t=$(':input[type="text"]',i),t.length==0&&(t=$(':input[type="number"]',i)),t.hasClass("flexistk")&&(t=t.closest(".active")),$("#stakePad").find("button").removeClass("stakePadKeyDown"),t.length>0&&!t.hasClass("disabled")&&u.text()=="x"&&(r=window.setInterval(this.handleStakePadClickWithScope,50,n,this),window.setTimeout(window.clearInterval,t[0].value.length*50,r)))},n}();Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.StakeEntryKeyboard=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"};this._validTarget=function(n){return n.target.tagName=="INPUT"&&(n.target.type=="text"||n.target.type=="number"||n.target.type=="tel")};this._stakeEntryRule=this._bsController.stakeEntryRule()};b365.Ui.Betslip.StakeEntryKeyboard.prototype={init:function(){var n=this;if(n._isValid()){if(navigator.userAgent.toLowerCase().indexOf("blackberry")>=0&&navigator.userAgent.toLowerCase().indexOf("webkit")>=0||navigator.userAgent.toLowerCase().search("(bb)([1-9][0-9]).*(mobile)")>-1)$("#bsDiv").off("keydown").on("keydown",function(t){var u=t.keyCode?t.keyCode:t.charCode,i,r;n._validTarget(t)&&(u==13&&t.preventDefault(),i=t.target.value,i=i.replace(",","."),i=i.replace("..","."),i&&(r=new b365.Ui.Formatter,$blib.isDecimal(i)&&(t.target.value=r.roundValue(i))),window.setTimeout(function(){new b365.Ui.Betslip.StakeChangedHandler(n._bsInst,n._bsController).handle(t.target)},0));t.stopPropagation()});$("#bsDiv").off("keyup").on("keyup",function(t){var i=t.keyCode?t.keyCode:t.charCode;n._validTarget(t)&&(i==13&&((navigator.userAgent.toLowerCase().indexOf("blackberry")>=0&&navigator.userAgent.toLowerCase().indexOf("webkit")>=0||navigator.userAgent.toLowerCase().search("(bb)([1-9][0-9]).*(mobile)")>-1)&&$("#bsDiv").off("keydown"),document.activeElement.blur(),t.preventDefault()),typeof n._stakeEntryRule=="function"&&(i==110||i==188||i==190)&&n._stakeEntryRule(t.target));t.stopPropagation()});$("#bsDiv input").on("input",function(t){var i,r;n._validTarget(t)&&(i=t.target.value,i=i.replace(",","."),i=i.replace("..","."),i&&(r=new b365.Ui.Formatter,$blib.isDecimal(i)&&(t.target.value=r.roundValue(i),typeof n._stakeEntryRule=="function"&&n._stakeEntryRule(t.target))),new b365.Ui.Betslip.StakeChangedHandler(n._bsInst,n._bsController).handle(t.target));t.stopPropagation();t.preventDefault()})}},detach:function(){this._isValid()}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.CurrencyDisplayHelper=function(n,t){this._betSlipController=n;this._decimalSeperator=t.decimalSeparator;this._thousandsSeperator=t.thousandsSeparator};b365.Ui.Betslip.CurrencyDisplayHelper.prototype.getDecimalSeperator=function(){return this._decimalSeperator};b365.Ui.Betslip.CurrencyDisplayHelper.prototype.formatCurrency=function(n){var t=n.toString().split(".");return isNaN(n)||t.length!=2?n:t[0].replace(/\B(?=(\d{3})+(?=$))/g,"")+(t[1]?this._decimalSeperator+t[1]:"")};b365.Ui.Betslip.CurrencyDisplayHelper.prototype.unformatCurrency=function(n){var t,i;return isNaN(n)?(i=new RegExp("["+this._thousandsSeperator+"]","g"),t=n.replace(i,""),t=t.replace(this._decimalSeperator,"."),t=parseFloat(t).toFixed(2),isNaN(t)&&(t="0"),t):n};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.EnhancedBetSlipAnimations=function(n){this._betSlipController=n;this._animationEndEvents="animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd";this._removeSingleBets={animationClass:"removeBetElementFade",secondAnimationClass:"removeBetElementShrink",animationEndName:"FadeOut",secondAnimationEndName:"Shrink"};this._hideStakePad={animationClass:"hideStakePad",animationClassFast:"hideStakePadQuickly",animationEndName:"HideStakePad"};this._hideStakePadFlexi={animationClass:"hideStakePadFlexi",animationClassFast:"hideStakePadQuickly",animationEndName:"HideStakePadFlexi"};this._showStakePad={animationClass:"showStakePad",animationClassFast:"showStakePadQuickly",animationEndName:"ShowStakePad"};this._showStakePadFlexi={animationClass:"showStakePadFlexi",animationClassFast:"showStakePadQuickly",animationEndName:"ShowStakePadFlexi"};this._disableBetSlip={animationClass:"disableBetSlip",animationEndName:"Disabled",disabledClass:"disabledBetSlip"};this._enableBetSlip={animationClass:"enableBetSlip",animationEndName:"Enabled"};this._shakeStakeFields={animationClass:"shakeStakeField",animationEndName:"Shake",focusClass:"focus"}};b365.Ui.Betslip.EnhancedBetSlipAnimations.prototype.removeSingleBet=function(n,t,i,r,u,f){var e=this,s=r,h=u,c=f,o=n;if(this._betSlipController._stakeEntryHander.detach(),t){n.on(this._animationEndEvents,function(n){if(n.originalEvent.animationName)switch(n.originalEvent.animationName){case e._hideStakePad.animationEndName:case e._hideStakePadFlexi.animationEndName:o.addClass(e._removeSingleBets.animationClass);break;case e._removeSingleBets.animationEndName:o.addClass(e._removeSingleBets.secondAnimationClass);break;case e._removeSingleBets.secondAnimationEndName:o.off(e._animationEndEvents);s&&e.doCallBack(s,h,c)}});i.attr("class",this._hideStakePad.animationClass)}else{n.on(this._animationEndEvents,function(n){if(n.originalEvent.animationName)switch(n.originalEvent.animationName){case e._removeSingleBets.animationEndName:o.addClass(e._removeSingleBets.secondAnimationClass);break;case e._removeSingleBets.secondAnimationEndName:o.off(e._animationEndEvents);s&&e.doCallBack(s,h,c)}});n.addClass(e._removeSingleBets.animationClass)}};b365.Ui.Betslip.EnhancedBetSlipAnimations.prototype.removeAllBets=function(n,t,i,r,u,f){var e=this,o=$("#bsDiv"),c=n.length,s=0,h=r,l=u,a=f,v=n;if(this._betSlipController._stakeEntryHander.detach(),t){o.on(this._animationEndEvents,function(n){if(n.originalEvent.animationName)switch(n.originalEvent.animationName){case e._hideStakePad.animationEndName:case e._hideStakePadFlexi.animationEndName:v.addClass(e._removeSingleBets.animationClass);break;case e._removeSingleBets.animationEndName:$(n.target).addClass(e._removeSingleBets.secondAnimationClass);break;case e._removeSingleBets.secondAnimationEndName:s+=1;s>=c&&(o.off(e._animationEndEvents),h&&e.doCallBack(h,l,a))}});i.attr("class",this._hideStakePad.animationClass)}else{o.on(this._animationEndEvents,function(n){if(n.originalEvent.animationName)switch(n.originalEvent.animationName){case e._removeSingleBets.animationEndName:$(n.target).addClass(e._removeSingleBets.secondAnimationClass);break;case e._removeSingleBets.secondAnimationEndName:s+=1;s>=c&&(o.off(e._animationEndEvents),h&&e.doCallBack(h,l,a))}});n.addClass(e._removeSingleBets.animationClass)}};b365.Ui.Betslip.EnhancedBetSlipAnimations.prototype.hideBetMultiples=function(n,t,i,r,u,f,e){var o=this,v=n.length,c=0,s=u,l=f,a=e,h=t,y=n;if(this._betSlipController._stakeEntryHander.detach(),i){t.on(this._animationEndEvents,function(t){if(t.originalEvent.animationName)switch(t.originalEvent.animationName){case o._hideStakePad.animationEndName:case o._hideStakePadFlexi.animationEndName:y.addClass(o._removeSingleBets.animationClass);break;case o._removeSingleBets.animationEndName:$(t.target).addClass(o._removeSingleBets.secondAnimationClass);break;case o._removeSingleBets.secondAnimationEndName:c+=1;c>=v&&(h.off(o._animationEndEvents),s&&o.doCallBack(s,l,a));break;case o._enableBetSlip.animationEndName:h.off(o._animationEndEvents);n.removeClass(o._disableBetSlip.animationClass).addClass(o._disableBetSlip.disabledClass);h.off(o._animationEndEvents);s&&o.doCallBack(s,l,a)}});r.attr("class",this._hideStakePad.animationClass)}else{t.on(this._animationEndEvents,function(t){if(t.originalEvent.animationName)switch(t.originalEvent.animationName){case o._removeSingleBets.animationEndName:$(t.target).addClass(o._removeSingleBets.secondAnimationClass);break;case o._removeSingleBets.secondAnimationEndName:c+=1;c>=v&&(h.off(o._animationEndEvents),s&&o.doCallBack(s,l,a));break;case o._enableBetSlip.animationEndName:h.off(o._animationEndEvents);n.removeClass(o._disableBetSlip.animationClass).addClass(o._disableBetSlip.disabledClass);h.off(o._animationEndEvents);s&&o.doCallBack(s,l,a)}});n.addClass(o._removeSingleBets.animationClass)}};b365.Ui.Betslip.EnhancedBetSlipAnimations.prototype.shakeStakeFields=function(n,t,i,r,u){var f=this,s=n.length,e=0,o=i,h=r,c=u,l=t,a=n;t.on(this._animationEndEvents,function(n){n.originalEvent.animationName&&n.originalEvent.animationName==f._shakeStakeFields.animationEndName&&(e+=1,e>=s&&(a.removeClass(f._shakeStakeFields.animationClass),l.off(f._animationEndEvents),o&&f.doCallBack(o,h,c)))});n.removeClass(f._shakeStakeFields.focusClass).removeClass(f._shakeStakeFields.animationClass).addClass(f._shakeStakeFields.focusClass).addClass(f._shakeStakeFields.animationClass)};b365.Ui.Betslip.EnhancedBetSlipAnimations.prototype.hideStakePad=function(n,t,i,r,u){var f=this,o=n,e=i,s=r,h=u;n.on(this._animationEndEvents,function(n){n.originalEvent.animationName&&(n.originalEvent.animationName==f._hideStakePad.animationEndName||n.originalEvent.animationName==f._hideStakePadFlexi.animationEndName)&&(o.off(this._animationEndEvents),e&&f.doCallBack(e,s,h))});n.attr("class",t?this._hideStakePad.animationClassFast:this._hideStakePad.animationClass)};b365.Ui.Betslip.EnhancedBetSlipAnimations.prototype.showStakePad=function(n,t,i,r,u){var f=this,o=n,e=i,s=r,h=u;n.on(this._animationEndEvents,function(n){n.originalEvent.animationName&&(n.originalEvent.animationName==f._showStakePad.animationEndName||n.originalEvent.animationName==f._showStakePadFlexi.animationEndName)&&(o.off(this._animationEndEvents),e&&f.doCallBack(e,s,h))});n.attr("class",t?this._showStakePad.animationClassFast:this._showStakePad.animationClass)};b365.Ui.Betslip.EnhancedBetSlipAnimations.prototype.disableBetSlip=function(n){var t=this;n.addClass(t._disableBetSlip.disabledClass)};b365.Ui.Betslip.EnhancedBetSlipAnimations.prototype.enableBetSlip=function(n){var t=this;n.removeClass(t._disableBetSlip.disabledClass)};b365.Ui.Betslip.EnhancedBetSlipAnimations.prototype.doCallBack=function(n,t,i){t?i?n.apply(i,t):n.apply(null,t):n()};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.EnhancedBetSlipTypeSelector=function(n){this._betSlipController=n;this._clickHandlers=[];this._siteClickHandlers=[];this._selectClickHandler=null;this._isShowing=!1;this._enabled=!1};b365.Ui.Betslip.EnhancedBetSlipTypeSelector.prototype.showPopUpMenu=function(){var n=this,t,i;n._enabled&&!$("#bsDiv .betslip-select select").hasClass("disabled")&&(n._betSlipController.hidePopups(n),t=document.getElementById("BetSlipTypesWrapper"),t.hasAttribute("style")?(i=t.getAttribute("style"),i=i.replace(" ",""),i=="display:none;"?(t.setAttribute("style","display:block;"),n.addHandlers(this),n._isShowing=!0,n._betSlipController._bsInst.changeBetslipHeight()):(n._isShowing=!0,n.hidePopUpMenu())):(t.setAttribute("style","display:block;"),n.addHandlers(n),n._isShowing=!0),t=null)};b365.Ui.Betslip.EnhancedBetSlipTypeSelector.prototype.hidePopUpMenu=function(){var n,t=this,i;t._isShowing&&(n=document.getElementById("BetSlipTypesWrapper"),n.hasAttribute("style")&&(i=n.getAttribute("style"),i=i.replace(" ",""),i=="display:block;"&&n.setAttribute("style","display:none;")),t.removeHandlers(this),t._isShowing=!1,t._betSlipController._bsInst.changeBetslipHeight(),n=null)};b365.Ui.Betslip.EnhancedBetSlipTypeSelector.prototype.addHandlers=function(n){var i=document.getElementById("BetSlipDialogueHeader"),u=document.getElementById("bsDiv"),e=document.getElementById("BetSlipTypesWrapper"),r=$("li",e),t,f;if(n.removeHandlers(n),r.length>0)for(t=0,f=r.length;t<f;t++)n._clickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(r[t],$.proxy(n.handleSelection,n),!1));i&&n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(i,$.proxy(n.hidePopUpMenu,n),!1));n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(u,$.proxy(n.hidePopUpMenu,n),!1));i=null;u=null};b365.Ui.Betslip.EnhancedBetSlipTypeSelector.prototype.removeHandlers=function(n){var t,i;if(n._clickHandlers.length>0){for(t=0,i=n._clickHandlers.length;t<i;t++)n._clickHandlers[t]._element&&n._clickHandlers[t].destroy();n._clickHandlers=[]}if(n._siteClickHandlers.length>0){for(t=0,i=n._siteClickHandlers.length;t<i;t++)n._siteClickHandlers[t]._element&&n._siteClickHandlers[t].destroy();n._siteClickHandlers=[]}};b365.Ui.Betslip.EnhancedBetSlipTypeSelector.prototype.handleSelection=function(n){var i=document.getElementById("BetSlipTypesWrapper"),r=document.getElementById("BetSlipTypeSelector"),u=n.target.getAttribute("data-item"),t=n.target.innerHTML;n.stopPropagation();t!==""&&t.indexOf("<span")==-1&&(r.innerHTML=t,$("#bsDiv .betslip-select select").val(u).change(),i.setAttribute("style","display:none;"));i=null;r=null};b365.Ui.Betslip.EnhancedBetSlipTypeSelector.prototype.disablePopUp=function(){var n=this;n.hidePopUpMenu();n._selectClickHandler!==null&&n._selectClickHandler._element&&n._selectClickHandler.destroy();n._selectClickHandler=null;n._enabled=!1};b365.Ui.Betslip.EnhancedBetSlipTypeSelector.prototype.enablePopUp=function(){var n=this,t=document.getElementById("BetSlipTypeSelectorWrapper");if(n._selectClickHandler!==null&&n._selectClickHandler._element){n._enabled=!0;return}if(n.removeHandlers(n),!t){n._enabled=!1;n._isShowing=!1;return}n._selectClickHandler=new b365.Ui.Betslip.ResponsiveClickHandler(t,$.proxy(n.showPopUpMenu,n),!1);n._enabled=!0;t=null};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.EnhancedBetSlipOddsSelector=function(n){this._betSlipController=n;this._clickHandlers=[];this._siteClickHandlers=[];this._selectClickHandlers=[];this._betSlipWrapper=$("#bsDiv");this._currentMenu=null;this._currentSelector=null;this._currentSelect=null;this._isShowing=!1;this._enabled=!1};b365.Ui.Betslip.EnhancedBetSlipOddsSelector.prototype.showPopUpMenu=function(n){var t=this,i=$(n.target),r=i.parent().find(".EnhancedOddsWrapper"),u=i.parent().find("select.odds"),o=i.parent(),f,e;(n.stopPropagation(),t._enabled&&!u.hasClass("disabled"))&&(t._betSlipController.hidePopups(t),r.length>0&&!r.hasClass("showing")?(t._isShowing&&t._currentMenu!=null&&t._currentMenu.removeClass("showing"),t._currentMenu=r,t._currentMenu.addClass("showing"),f=$("#BetSlipForm")[0].getBoundingClientRect().left,e=o[0].getBoundingClientRect().left-f,r[0].style.left=e-2+"px",t.addHandlers(t),t._currentSelector=i,t._currentSelect=u,t._isShowing=!0):t.hidePopUpMenu())};b365.Ui.Betslip.EnhancedBetSlipOddsSelector.prototype.hidePopUpMenu=function(){var n=this;n._isShowing&&n._currentMenu!=null&&(n._currentMenu.removeClass("showing"),n.removeHandlers(n),n._currentMenu=null,n._currentSelector=null,n._currentSelect=null,n._isShowing=!1)};b365.Ui.Betslip.EnhancedBetSlipOddsSelector.prototype.addSelectHandlers=function(n,t){var i,r;if(t.length==0&&(t=$(".EnhancedOddsSelection",n._betSlipWrapper)),t!=0)for(n._selectClickHandlers=[],i=0,r=t.length;i<r;i++)n._selectClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(t[i],$.proxy(n.showPopUpMenu,n),!1))};b365.Ui.Betslip.EnhancedBetSlipOddsSelector.prototype.removeSelectHandlers=function(n){var t,i;if(n._selectClickHandlers.length>0){for(t=0,i=n._selectClickHandlers.length;t<i;t++)n._selectClickHandlers[t]._element&&n._selectClickHandlers[t].destroy();n._selectClickHandlers=[]}};b365.Ui.Betslip.EnhancedBetSlipOddsSelector.prototype.addHandlers=function(n){var i=document.getElementById("BetSlipDialogueHeader"),r=n._currentMenu.find("li"),t,u;if(n.removeHandlers(n),r.length>0)for(t=0,u=r.length;t<u;t++)n._clickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(r[t],$.proxy(n.handleSelection,n),!1));i&&n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(i,$.proxy(n.hidePopUpMenu,n),!1));n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(n._betSlipWrapper[0],$.proxy(n.hidePopUpMenu,n),!1));i=null};b365.Ui.Betslip.EnhancedBetSlipOddsSelector.prototype.removeHandlers=function(n){var t,i;if(n._clickHandlers.length>0){for(t=0,i=n._clickHandlers.length;t<i;t++)n._clickHandlers[t]._element&&n._clickHandlers[t].destroy();n._clickHandlers=[]}if(n._siteClickHandlers.length>0){for(t=0,i=n._siteClickHandlers.length;t<i;t++)n._siteClickHandlers[t]._element&&n._siteClickHandlers[t].destroy();n._siteClickHandlers=[]}};b365.Ui.Betslip.EnhancedBetSlipOddsSelector.prototype.handleSelection=function(n){var i=this,o=n.target.getAttribute("data-item"),u=n.target.innerHTML,r=i._currentMenu.find("li"),f="EnhancedOddsItem-selected",t,e;if(n.stopPropagation(),u!==""&&u.indexOf("<span")==-1){for(i._currentSelector[0].innerHTML=u,t=0,e=r.length;t<e;t++)r[t].className=r[t].className.replace(new RegExp("(^| )"+f+"( |$)"),""),r[t].innerHTML=r[t].innerHTML.replace('<span class="selected"><\/span>',"");i._currentSelect.val(o).change();n.target.className.indexOf(f)===-1&&(n.target.className+=n.target.className.length>0?" "+f:f);n.target.innerHTML=u+'<span class="selected"><\/span>'}i.hidePopUpMenu(i)};b365.Ui.Betslip.EnhancedBetSlipOddsSelector.prototype.disablePopUps=function(){var n=this;n.hidePopUpMenu();n.removeSelectHandlers(n);n._enabled=!1};b365.Ui.Betslip.EnhancedBetSlipOddsSelector.prototype.enablePopUps=function(){var n=this,t=$(".EnhancedOddsSelection",n._betSlipWrapper);if(n.removeHandlers(n),n.removeSelectHandlers(n),t.length==0){n._enabled=!1;n._isShowing=!1;return}n.addSelectHandlers(n,t);n._enabled=!0};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.EnhancedBetSlipPitcherSelector=function(n){this._betSlipController=n;this._clickHandlers=[];this._siteClickHandlers=[];this._selectClickHandlers=[];this._betSlipWrapper=$("#bsDiv");this._currentMenu=null;this._currentSelector=null;this._currentSelect=null;this._isShowing=!1;this._enabled=!1};b365.Ui.Betslip.EnhancedBetSlipPitcherSelector.prototype.showPopUpMenu=function(n){var t=this,i,r,u;if(i=$(n.target),i.hasClass("EnhancedPitcherSelection")&&(i=i.parent()),r=i.parent().find(".EnhancedPitcherWrapper"),u=i.parent().find("select.pitcher-sel"),n.stopPropagation(),t._enabled&&!u.hasClass("disabled"))if(t._betSlipController.hidePopups(t),r.length>0&&!r.hasClass("showing")){t._isShowing&&t._currentMenu!=null&&t._currentMenu.removeClass("showing");t._currentMenu=r;t._currentMenu.addClass("showing");var e=$("#BetSlipForm")[0].getBoundingClientRect().left,o=this._betSlipWrapper.width(),f=i[0].getBoundingClientRect().left-e,s=o-f;r.width()>s?r[0].style.right="10px":r[0].style.left=f-11+"px";t.addHandlers(t);t._currentSelector=i;t._currentSelect=u;t._isShowing=!0;t._betSlipController._bsInst.changeBetslipHeight()}else t.hidePopUpMenu()};b365.Ui.Betslip.EnhancedBetSlipPitcherSelector.prototype.hidePopUpMenu=function(){var n=this;n._isShowing&&n._currentMenu!=null&&(n._currentMenu.removeClass("showing"),n.removeHandlers(n),n._currentMenu=null,n._currentSelector=null,n._currentSelect=null,n._isShowing=!1,n._betSlipController._bsInst.changeBetslipHeight())};b365.Ui.Betslip.EnhancedBetSlipPitcherSelector.prototype.addSelectHandlers=function(n,t){var i,r;if(t.length==0&&(t=$(".EnhancedPitcherSelectionWrapper",n._betSlipWrapper)),t!=0)for(n._selectClickHandlers=[],i=0,r=t.length;i<r;i++)n._selectClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(t[i],$.proxy(n.showPopUpMenu,n),!1))};b365.Ui.Betslip.EnhancedBetSlipPitcherSelector.prototype.removeSelectHandlers=function(n){var t,i;if(n._selectClickHandlers.length>0){for(t=0,i=n._selectClickHandlers.length;t<i;t++)n._selectClickHandlers[t]._element&&n._selectClickHandlers[t].destroy();n._selectClickHandlers=[]}};b365.Ui.Betslip.EnhancedBetSlipPitcherSelector.prototype.addHandlers=function(n){var i=document.getElementById("BetSlipDialogueHeader"),r=n._currentMenu.find("li"),t,u;if(n.removeHandlers(n),r.length>0)for(t=0,u=r.length;t<u;t++)n._clickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(r[t],$.proxy(n.handleSelection,n),!1));i&&n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(i,$.proxy(n.hidePopUpMenu,n),!1));n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(n._betSlipWrapper[0],$.proxy(n.hidePopUpMenu,n),!1));i=null};b365.Ui.Betslip.EnhancedBetSlipPitcherSelector.prototype.removeHandlers=function(n){var t,i;if(n._clickHandlers.length>0){for(t=0,i=n._clickHandlers.length;t<i;t++)n._clickHandlers[t]._element&&n._clickHandlers[t].destroy();n._clickHandlers=[]}if(n._siteClickHandlers.length>0){for(t=0,i=n._siteClickHandlers.length;t<i;t++)n._siteClickHandlers[t]._element&&n._siteClickHandlers[t].destroy();n._siteClickHandlers=[]}};b365.Ui.Betslip.EnhancedBetSlipPitcherSelector.prototype.handleSelection=function(n){var t=this,e=n.target.getAttribute("data-item"),r=n.target.innerHTML,u=t._currentMenu.find("li"),i,f;if(n.stopPropagation(),r!==""&&r.indexOf("<span")==-1){for(t._currentSelector.hasClass("EnhancedPitcherSelection")||(t._currentSelector=t._currentSelector.find(".EnhancedPitcherSelection")),t._currentSelector[0].innerHTML=r,i=0,f=u.length;i<f;i++)u[i].innerHTML=u[i].innerHTML.replace('<span class="selected"><\/span>',"");t._currentSelect.val(e).change();n.target.innerHTML=r+'<span class="selected"><\/span>'}t._betSlipController.refreshBetslip();t.hidePopUpMenu()};b365.Ui.Betslip.EnhancedBetSlipPitcherSelector.prototype.disablePopUps=function(){var n=this;n.hidePopUpMenu();n.removeSelectHandlers(n);n._enabled=!1};b365.Ui.Betslip.EnhancedBetSlipPitcherSelector.prototype.enablePopUps=function(){var n=this,t=$(".EnhancedPitcherSelectionWrapper",n._betSlipWrapper);if(n.removeHandlers(n),n.removeSelectHandlers(n),t.length==0){n._enabled=!1;n._isShowing=!1;return}n.addSelectHandlers(n,t);n._enabled=!0};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.EnhancedBetSlipToteSelector=function(n){this._betSlipController=n;this._clickHandlers=[];this._siteClickHandlers=[];this._selectClickHandlers=[];this._betSlipWrapper=$("#bsDiv");this._currentMenu=null;this._currentSelector=null;this._currentSelect=null;this._isShowing=!1;this._enabled=!1};b365.Ui.Betslip.EnhancedBetSlipToteSelector.prototype.showPopUpMenu=function(n){var t=this,i=$(n.target),r=i.parent().find(".EnhancedToteWrapper"),u=i.parent().find("select.aus-tote");(n.stopPropagation(),t._enabled&&!u.hasClass("disabled"))&&(t._betSlipController.hidePopups(t),r.length>0&&!r.hasClass("showing")?(t._isShowing&&t._currentMenu!=null&&t._currentMenu.removeClass("showing"),t._currentMenu=r,t._currentMenu.addClass("showing"),t.addHandlers(t),t._currentSelector=i,t._currentSelect=u,t._isShowing=!0,t._betSlipController._bsInst.changeBetslipHeight()):t.hidePopUpMenu())};b365.Ui.Betslip.EnhancedBetSlipToteSelector.prototype.hidePopUpMenu=function(){var n=this;n._isShowing&&n._currentMenu!=null&&(n._currentMenu.removeClass("showing"),n.removeHandlers(n),n._currentMenu=null,n._currentSelector=null,n._currentSelect=null,n._isShowing=!1,n._betSlipController._bsInst.changeBetslipHeight())};b365.Ui.Betslip.EnhancedBetSlipToteSelector.prototype.addSelectHandlers=function(n,t){var i,r;if(t.length==0&&(t=$(".EnhancedToteSelection",n._betSlipWrapper)),t!=0)for(n._selectClickHandlers=[],i=0,r=t.length;i<r;i++)n._selectClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(t[i],$.proxy(n.showPopUpMenu,n),!1))};b365.Ui.Betslip.EnhancedBetSlipToteSelector.prototype.removeSelectHandlers=function(n){var t,i;if(n._selectClickHandlers.length>0){for(t=0,i=n._selectClickHandlers.length;t<i;t++)n._selectClickHandlers[t]._element&&n._selectClickHandlers[t].destroy();n._selectClickHandlers=[]}};b365.Ui.Betslip.EnhancedBetSlipToteSelector.prototype.addHandlers=function(n){var i=document.getElementById("BetSlipDialogueHeader"),r=n._currentMenu.find("li"),t,u;if(n.removeHandlers(n),r.length>0)for(t=0,u=r.length;t<u;t++)n._clickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(r[t],$.proxy(n.handleSelection,n),!1));i&&n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(i,$.proxy(n.hidePopUpMenu,n),!1));n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(n._betSlipWrapper[0],$.proxy(n.hidePopUpMenu,n),!1));i=null};b365.Ui.Betslip.EnhancedBetSlipToteSelector.prototype.removeHandlers=function(n){var t,i;if(n._clickHandlers.length>0){for(t=0,i=n._clickHandlers.length;t<i;t++)n._clickHandlers[t]._element&&n._clickHandlers[t].destroy();n._clickHandlers=[]}if(n._siteClickHandlers.length>0){for(t=0,i=n._siteClickHandlers.length;t<i;t++)n._siteClickHandlers[t]._element&&n._siteClickHandlers[t].destroy();n._siteClickHandlers=[]}};b365.Ui.Betslip.EnhancedBetSlipToteSelector.prototype.handleSelection=function(n){var i=this,e=n.target.getAttribute("data-item"),r=n.target.innerHTML,u=i._currentMenu.find("li"),t,f;if(n.stopPropagation(),r!==""&&r.indexOf("<span")==-1){for(i._currentSelector[0].innerHTML=r,t=0,f=u.length;t<f;t++)u[t].innerHTML=u[t].innerHTML.replace('<span class="selected"><\/span>',"");i._currentSelect.val(e).change();n.target.innerHTML=r+'<span class="selected"><\/span>'}i.hidePopUpMenu()};b365.Ui.Betslip.EnhancedBetSlipToteSelector.prototype.disablePopUps=function(){var n=this;n.hidePopUpMenu();n.removeSelectHandlers(n);n._enabled=!1};b365.Ui.Betslip.EnhancedBetSlipToteSelector.prototype.enablePopUps=function(){var n=this,t=$(".EnhancedToteSelection",n._betSlipWrapper);if(n.removeHandlers(n),n.removeSelectHandlers(n),t.length==0){n._enabled=!1;n._isShowing=!1;return}n.addSelectHandlers(n,t);n._enabled=!0};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.EnhancedBetSlipIfBetSelector=function(n){this._betSlipController=n;this._clickHandlers=[];this._siteClickHandlers=[];this._selectClickHandlers=[];this._betSlipWrapper=$("#bsDiv");this._currentMenu=null;this._currentSelector=null;this._currentSelect=null;this._isShowing=!1;this._enabled=!1};b365.Ui.Betslip.EnhancedBetSlipIfBetSelector.prototype.showPopUpMenu=function(n){var t=this,r=$(n.target),i=r.parent().find(".EnhancedIfBetWrapper"),u=r.parent().find("select.ifbetaction");if(n.stopPropagation(),t._enabled&&!u.hasClass("disabled"))if(t._betSlipController.hidePopups(t),i.length>0&&!i.hasClass("showing")){t._isShowing&&t._currentMenu!=null&&t._currentMenu.removeClass("showing");t._currentMenu=i;t._currentMenu.addClass("showing");var e=$("#BetSlipForm")[0].getBoundingClientRect().left,o=this._betSlipWrapper.width(),f=r[0].getBoundingClientRect().left-e,s=o-f;i.width()>s?i[0].style.right="10px":i[0].style.left=f-11+"px";t.addHandlers(t);t._currentSelector=r;t._currentSelect=u;t._isShowing=!0}else t.hidePopUpMenu()};b365.Ui.Betslip.EnhancedBetSlipIfBetSelector.prototype.hidePopUpMenu=function(){var n=this;n._isShowing&&n._currentMenu!=null&&(n._currentMenu.removeClass("showing"),n.removeHandlers(n),n._currentMenu=null,n._currentSelector=null,n._currentSelect=null,n._isShowing=!1)};b365.Ui.Betslip.EnhancedBetSlipIfBetSelector.prototype.addSelectHandlers=function(n,t){var i,r;if(t.length==0&&(t=$(".EnhancedIfBetSelection",n._betSlipWrapper)),t!=0)for(n._selectClickHandlers=[],i=0,r=t.length;i<r;i++)n._selectClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(t[i],$.proxy(n.showPopUpMenu,n),!1))};b365.Ui.Betslip.EnhancedBetSlipIfBetSelector.prototype.removeSelectHandlers=function(n){var t,i;if(n._selectClickHandlers.length>0){for(t=0,i=n._selectClickHandlers.length;t<i;t++)n._selectClickHandlers[t]._element&&n._selectClickHandlers[t].destroy();n._selectClickHandlers=[]}};b365.Ui.Betslip.EnhancedBetSlipIfBetSelector.prototype.addHandlers=function(n){var i=document.getElementById("BetSlipDialogueHeader"),r=n._currentMenu.find("li"),t,u;if(n.removeHandlers(n),r.length>0)for(t=0,u=r.length;t<u;t++)n._clickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(r[t],$.proxy(n.handleSelection,n),!1));i&&n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(i,$.proxy(n.hidePopUpMenu,n),!1));n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(n._betSlipWrapper[0],$.proxy(n.hidePopUpMenu,n),!1));i=null};b365.Ui.Betslip.EnhancedBetSlipIfBetSelector.prototype.removeHandlers=function(n){var t,i;if(n._clickHandlers.length>0){for(t=0,i=n._clickHandlers.length;t<i;t++)n._clickHandlers[t]._element&&n._clickHandlers[t].destroy();n._clickHandlers=[]}if(n._siteClickHandlers.length>0){for(t=0,i=n._siteClickHandlers.length;t<i;t++)n._siteClickHandlers[t]._element&&n._siteClickHandlers[t].destroy();n._siteClickHandlers=[]}};b365.Ui.Betslip.EnhancedBetSlipIfBetSelector.prototype.handleSelection=function(n){var o=this,l=n.target.getAttribute("data-item"),f=n.target.innerHTML,s=o._currentMenu.find("li"),e,r,c,t,h,i,a,u;if(n.stopPropagation(),f!==""&&f.indexOf("<span")==-1&&(e=document.getElementsByClassName("ifBetSelectorRow"),u="EnhancedIfBet-selected",e.length>0))if(o._currentSelector[0]==e[0].getElementsByClassName("EnhancedIfBetSelection")[0])for(t=0,h=e.length;t<h;t++){for(e[t].getElementsByClassName("EnhancedIfBetSelection")[0].innerHTML=f,r=e[t].getElementsByTagName("li"),i=0,a=r.length;i<a;i++)r[i].innerText==f?(r[i].className.indexOf(u)===-1&&(r[i].className+=r[i].className.length>0?" "+u:u),r[i].innerHTML=f+'<span class="selected"><\/span>'):(r[i].className=r[i].className.replace(new RegExp("(^| )"+u+"( |$)"),""),r[i].innerHTML=r[i].innerHTML.replace('<span class="selected"><\/span>',""));c=e[t].getElementsByTagName("select")[0];c.value=l;$(c).change()}else{for(o._currentSelector[0].innerHTML=f,t=0,h=s.length;t<h;t++)s[t].className=s[t].className.replace(new RegExp("(^| )"+u+"( |$)"),""),s[t].innerHTML=s[t].innerHTML.replace('<span class="selected"><\/span>',"");o._currentSelect.val(l).change();n.target.className.indexOf(u)===-1&&(n.target.className+=n.target.className.length>0?" "+u:u);n.target.innerHTML=f+'<span class="selected"><\/span>'}o.hidePopUpMenu(o)};b365.Ui.Betslip.EnhancedBetSlipIfBetSelector.prototype.disablePopUps=function(){var n=this;n.hidePopUpMenu();n.removeSelectHandlers(n);n._enabled=!1};b365.Ui.Betslip.EnhancedBetSlipIfBetSelector.prototype.enablePopUps=function(){var n=this,t=$(".EnhancedIfBetSelection",n._betSlipWrapper);if(n.removeHandlers(n),n.removeSelectHandlers(n),t.length==0){n._enabled=!1;n._isShowing=!1;return}n.addSelectHandlers(n,t);n._enabled=!0};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.EnhancedBetSlipTeaserTypeSelector=function(n){this._betSlipController=n;this._clickHandlers=[];this._siteClickHandlers=[];this._selectClickHandlers=[];this._betSlipWrapper=$("#bsDiv");this._currentMenu=null;this._currentSelector=null;this._currentSelect=null;this._isShowing=!1;this._enabled=!1};b365.Ui.Betslip.EnhancedBetSlipTeaserTypeSelector.prototype.showPopUpMenu=function(n){var t=this,i,r,u;if(i=$(n.target),i.hasClass("EnhancedTeaserSelection")&&(i=i.parent()),r=i.parent().find(".EnhancedTeaserWrapper"),u=i.parent().find("select.teaserSel"),n.stopPropagation(),t._enabled&&!u.hasClass("disabled"))if(t._betSlipController.hidePopups(t),r.length>0&&!r.hasClass("showing")){t._isShowing&&t._currentMenu!=null&&t._currentMenu.removeClass("showing");t._currentMenu=r;t._currentMenu.addClass("showing");var e=$("#BetSlipForm")[0].getBoundingClientRect().left,o=this._betSlipWrapper.width(),f=i[0].getBoundingClientRect().left-e,s=o-f;r.width()>s?r[0].style.right="10px":r[0].style.left=f-11+"px";t.addHandlers(t);t._currentSelector=i;t._currentSelect=u;t._isShowing=!0;t._betSlipController._bsInst.changeBetslipHeight()}else t.hidePopUpMenu()};b365.Ui.Betslip.EnhancedBetSlipTeaserTypeSelector.prototype.hidePopUpMenu=function(){var n=this;n._isShowing&&n._currentMenu!=null&&(n._currentMenu.removeClass("showing"),n.removeHandlers(n),n._currentMenu=null,n._currentSelector=null,n._currentSelect=null,n._isShowing=!1,n._betSlipController._bsInst.changeBetslipHeight())};b365.Ui.Betslip.EnhancedBetSlipTeaserTypeSelector.prototype.addSelectHandlers=function(n,t){var i,r;if(t.length==0&&(t=$(".EnhancedTeaserSelectionWrapper",n._betSlipWrapper)),t!=0)for(n._selectClickHandlers=[],i=0,r=t.length;i<r;i++)n._selectClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(t[i],$.proxy(n.showPopUpMenu,n),!1))};b365.Ui.Betslip.EnhancedBetSlipTeaserTypeSelector.prototype.removeSelectHandlers=function(n){var t,i;if(n._selectClickHandlers.length>0){for(t=0,i=n._selectClickHandlers.length;t<i;t++)n._selectClickHandlers[t]._element&&n._selectClickHandlers[t].destroy();n._selectClickHandlers=[]}};b365.Ui.Betslip.EnhancedBetSlipTeaserTypeSelector.prototype.addHandlers=function(n){var i=document.getElementById("BetSlipDialogueHeader"),r=n._currentMenu.find("li"),t,u;if(n.removeHandlers(n),r.length>0)for(t=0,u=r.length;t<u;t++)n._clickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(r[t],$.proxy(n.handleSelection,n),!1));i&&n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(i,$.proxy(n.hidePopUpMenu,n),!1));n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(n._betSlipWrapper[0],$.proxy(n.hidePopUpMenu,n),!1));i=null};b365.Ui.Betslip.EnhancedBetSlipTeaserTypeSelector.prototype.removeHandlers=function(n){var t,i;if(n._clickHandlers.length>0){for(t=0,i=n._clickHandlers.length;t<i;t++)n._clickHandlers[t]._element&&n._clickHandlers[t].destroy();n._clickHandlers=[]}if(n._siteClickHandlers.length>0){for(t=0,i=n._siteClickHandlers.length;t<i;t++)n._siteClickHandlers[t]._element&&n._siteClickHandlers[t].destroy();n._siteClickHandlers=[]}};b365.Ui.Betslip.EnhancedBetSlipTeaserTypeSelector.prototype.handleSelection=function(n){var t=this,e=n.target.getAttribute("data-item"),r=n.target.innerHTML,u=t._currentMenu.find("li"),i,f;if(n.stopPropagation(),r!==""&&r.indexOf("<span")==-1){for(t._currentSelector[0].innerHTML=r,i=0,f=u.length;i<f;i++)u[i].innerHTML=u[i].innerHTML.replace('<span class="selected"><\/span>',"");t._currentSelect.val(e).change();n.target.innerHTML=r+'<span class="selected"><\/span>'}t.hidePopUpMenu(t)};b365.Ui.Betslip.EnhancedBetSlipTeaserTypeSelector.prototype.disablePopUps=function(){var n=this;n.hidePopUpMenu();n.removeSelectHandlers(n);n._enabled=!1};b365.Ui.Betslip.EnhancedBetSlipTeaserTypeSelector.prototype.enablePopUps=function(){var n=this,t=$(".EnhancedTeaserSelectionWrapper",n._betSlipWrapper);if(n.removeHandlers(n),n.removeSelectHandlers(n),t.length==0){n._enabled=!1;n._isShowing=!1;return}n.addSelectHandlers(n,t);n._enabled=!0};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.EnhancedBetSlipEachWayExtraSelector=function(n){this._betSlipController=n;this._clickHandlers=[];this._siteClickHandlers=[];this._selectClickHandlers=[];this._betSlipWrapper=$("#bsDiv");this._currentMenu=null;this._currentSelector=null;this._isShowing=!1;this._enabled=!1;this._formatOdds=function(n){var i=Locator.user.oddsTypeId,t=n;return n=="0/0"?t="SP":i==ns_gen5_util.OddsType.DECIMAL?t=ns_gen5_util.OddsConverter.ConvertOddsDecimal(n,this.decimalPlaces):i==ns_gen5_util.OddsType.AMERICAN&&(t=ns_gen5_util.OddsConverter.ConvertOddsUS(n)),t}};b365.Ui.Betslip.EnhancedBetSlipEachWayExtraSelector.prototype.showPopUpMenu=function(n){var t=this,i,r,f,u,o,s,e;if(i=$(n.target),r=i.parent().parent().find(".bs-EachWayExtraBetType_Wrapper"),t._enabled&&!r.parent().hasClass("disabled"))if(n.stopPropagation(),t._betSlipController.hidePopups(this),r.length>0&&!r.hasClass("showing")){if(t._isShowing&&t._currentMenu!=null&&t._currentMenu.removeClass("showing"),t._currentMenu=r,t._currentMenu.addClass("showing"),t.addHandlers(t),i[0].className.indexOf("bs-EachWayExtraBetType_SelectionWrapper")>-1&&(i=i[0].getElementsByClassName("bs-EachWayExtraBetType_Selection")),t._currentSelector=i,f=r[0].getElementsByClassName("bs-EachWayExtraBetType_Menu")[0],f)for(s=f.children.length,e=0;e<s;e++)(u=f.children[e],u.className.indexOf("selected")>-1)||(o=t._betSlipController._bsInst.getBetItemByCn(t._betSlipController._bsInst.betTybetTypeNormal,"fp",u.getAttribute("data-participantid")),o?$(u).addClass("disabled"):$(u).removeClass("disabled"));t._isShowing=!0}else t.hidePopUpMenu()};b365.Ui.Betslip.EnhancedBetSlipEachWayExtraSelector.prototype.hidePopUpMenu=function(){var n=this;n._isShowing&&n._currentMenu!=null&&(n._currentMenu.removeClass("showing"),n.removeHandlers(n),n._currentMenu=null,n._currentSelector=null,n._isShowing=!1,n._betSlipController._bsInst.changeBetslipHeight())};b365.Ui.Betslip.EnhancedBetSlipEachWayExtraSelector.prototype.addSelectHandlers=function(n,t){var i,r;for(n._selectClickHandlers=[],i=0,r=t.length;i<r;i++)n._selectClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(t[i],$.proxy(n.showPopUpMenu,n),!1))};b365.Ui.Betslip.EnhancedBetSlipEachWayExtraSelector.prototype.removeSelectHandlers=function(n){var t,i;if(n._selectClickHandlers.length>0){for(t=0,i=n._selectClickHandlers.length;t<i;t++)n._selectClickHandlers[t]._element&&n._selectClickHandlers[t].destroy();n._selectClickHandlers=[]}};b365.Ui.Betslip.EnhancedBetSlipEachWayExtraSelector.prototype.addHandlers=function(n){var i=document.getElementById("BetSlipDialogueHeader"),r=n._currentMenu.find(".bs-EachWayExtraBetType_MenuItemWrapper"),t,u;if(n.removeHandlers(n),r.length>0)for(t=0,u=r.length;t<u;t++)n._clickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(r[t],$.proxy(n.handleSelection,n),!1));i&&n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(i,$.proxy(n.hidePopUpMenu,n),!1));n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(n._betSlipWrapper[0],$.proxy(n.hidePopUpMenu,n),!1));i=null};b365.Ui.Betslip.EnhancedBetSlipEachWayExtraSelector.prototype.removeHandlers=function(n){var t,i;if(n._clickHandlers.length>0){for(t=0,i=n._clickHandlers.length;t<i;t++)n._clickHandlers[t]._element&&n._clickHandlers[t].destroy();n._clickHandlers=[]}if(n._siteClickHandlers.length>0){for(t=0,i=n._siteClickHandlers.length;t<i;t++)n._siteClickHandlers[t]._element&&n._siteClickHandlers[t].destroy();n._siteClickHandlers=[]}};b365.Ui.Betslip.EnhancedBetSlipEachWayExtraSelector.prototype.handleSelection=function(n){var i=n.target,u,a,c,v,o,y,s,l,n;if(i.className.indexOf("bs-EachWayExtraBetType_MenuItemWrapper")==-1&&(i=n.target.parentElement),!$(i).hasClass("selected")&&!$(i).hasClass("disabled")&&!$(i).hasClass("suspended")){var r=this,p=new b365.Ui.Betslip.ItemInformation(i),h=p.itemIndexAndType(),f=i.getAttribute("data-participantid"),t=r._betSlipController.eachWayExtraInfo[h[0]],w=i.getElementsByClassName("bs-EachWayExtraBetType_MenuItemName")[0].innerHTML;n.stopPropagation();t.menuButtonEle.innerHTML=w;$(t.selectedMenuItemEle).removeClass("selected");t.selectedMenuItemEle=i;$(i).addClass("selected");u=i.getAttribute("data-odds");u=r._formatOdds(u);t.oddsEle.innerHTML=u;t.marketDescEle&&(t.marketDescEle.innerHTML=i.getAttribute("data-plbtdescription"));t.animationTimer&&(clearTimeout(t.animationTimer),t.oddsHighlightEle.className=t.oddsHighlightEle.className.replace(" oddsChangeHighlightAnim",""));t.oddsHighlightEle.innerHTML=u;t.oddsHighlightEle.style.visibility="visible";t.oddsHighlightEle.className=t.oddsHighlightEle.className+" oddsChangeHighlightAnim";t.animationTimer=setTimeout(function(){t.oddsHighlightEle.className=t.oddsHighlightEle.className.replace(" oddsChangeHighlightAnim","");t.oddsHighlightEle.style.visibility="hidden";t.animationTimer=null},1500);betItem=r._betSlipController._bsInst.getBetItemById(h[1],h[0]);t.betItemEle.setAttribute("data-item-fpid",f);r._betSlipController.itemsRemoved(betItem.getCnItem("fp"));betItem.setCnItem("fp",f);a="BS"+f;c=Locator.treeLookup.getReference(a);c&&c.data.SA&&betItem.setCnItem("sa",data.SA);betItem.setCnItem("o",i.getAttribute("data-odds"));var b=i.getAttribute("data-disabled"),k=i.getAttribute("data-showdropdown"),e=t.eachWayExtraCheckbox,d=t.dropdownEle;b=="True"?(e.className.indexOf("disabled")<0&&(e.className=e.className+" disabled"),t.oddsHighlightEle.className=t.oddsHighlightEle.className.replace(" enhancedDropDown","")):(e.className=e.className.replace("disabled",""),t.enhancedDropdownMarkup&&k=="True"?(t.oddsEle.innerHTML=t.enhancedDropdownMarkup,this._betSlipController._enhancedBetSlipOddsSelector.enablePopUps(),v=t.betItemEle.querySelector(".odds-selection"),v.setAttribute("data-text",i.getAttribute("data-odds")),o=t.betItemEle.querySelector(".EnhancedOddsItem-selected"),o.setAttribute("data-item",i.getAttribute("data-odds")),o.replaceChild(document.createTextNode(u),o.childNodes[0]),y=t.betItemEle.querySelector(".EnhancedOddsSelection"),y.innerHTML=u,t.oddsHighlightEle.className=t.oddsHighlightEle.className+" enhancedDropDown"):t.oddsHighlightEle.className=t.oddsHighlightEle.className.replace(" enhancedDropDown",""));s=!1;for(l in r._betSlipController.eachWayExtraInfo)if(!s&&r._betSlipController.eachWayExtraInfo[l].selectedMenuItemEle&&r._betSlipController.eachWayExtraInfo[l].selectedMenuItemEle.getAttribute("data-isewex")=="1"){s=!0;break}this.showHideMultiples(s);r._betSlipController.highlightSelectedBets();r._betSlipController._bsInst.updateState();t.eachWayExtraEle&&t.eachWayExtraEle.getAttribute("data-isinplay")=="True"&&(n=new ns_betslip.BetSlipEvent(ns_betslip.BetSlipEvent.PARTICIPANT_ADDED_TO_BETSLIP),n.data={Id:f},Locator.inplayEvents.dispatchEvent(n));r._betSlipController.addToBetsBank(f);r._betSlipController._freeBetClickHandler.update($(t.betItemEle).context);r.hidePopUpMenu()}};b365.Ui.Betslip.EnhancedBetSlipEachWayExtraSelector.prototype.disablePopUps=function(){var n=this;n.hidePopUpMenu();n.removeSelectHandlers(n);n._enabled=!1};b365.Ui.Betslip.EnhancedBetSlipEachWayExtraSelector.prototype.enablePopUps=function(){var n=this,t=$(".bs-EachWayExtraBetType_SelectionWrapper",n._betSlipWrapper);if(n.removeHandlers(n),n.removeSelectHandlers(n),t.length==0){n._enabled=!1;n._isShowing=!1;return}n.addSelectHandlers(n,t);n._enabled=!0;n.createEachWayExtraInfo()};b365.Ui.Betslip.EnhancedBetSlipEachWayExtraSelector.prototype.createEachWayExtraInfo=function(){for(var u=this,l=this._betSlipWrapper[0].getElementsByClassName("bs-EachWayExtraBetType_Menu"),y=l.length,n,i,e,t,o,s,a,h=!1,v={},r,c,f=0;f<y;f++)t=l[f],o=new b365.Ui.Betslip.ItemInformation(t),n=o.itemElement()[0],i=n.getElementsByClassName("odds")[0],e=t.getElementsByClassName("bs-EachWayExtraMainMarket")[0],r={betItemEle:n,oddsEle:i,oddsHighlightEle:n.getElementsByClassName("oddsChangeHighlightWrapper")[0],menuButtonEle:n.getElementsByClassName("bs-EachWayExtraBetType_SelectionWrapper")[0],marketDescEle:n.getElementsByClassName("fullSlipMode")[0],eachWayExtraEle:n.getElementsByClassName("bs-EachWayExtraBetType")[0],dropdownEle:n.getElementsByClassName("bs-EachWayExtraBetType_Dropdown")[0],eachWaySelectionWrapper:n.getElementsByClassName("bs-EachWayExtraBetType_SelectionWrapper")[0],eachWayExtraWrapperEle:n.getElementsByClassName("bs-EachWayExtraBetType_Wrapper")[0],selectedMenuItemEle:t.getElementsByClassName("selected")[0],eachWayExtraDefaultMarketEle:t.getElementsByClassName("bs-EachWayExtraDefaultMarket")[0],eachWayExtraMainMarketEle:e,mainMarketPlaceCount:e.getAttribute("data-placecount"),eachWayExtraCheckbox:n.getElementsByClassName("js-EachWayExtra")[0],menuItems:t.getElementsByClassName("bs-EachWayExtraBetType_MenuItemWrapper"),enhancedDropdownMarkup:n.getElementsByClassName("EnhancedOddsSelection").length>0&&i?i.innerHTML:""},v[n.getAttribute("data-item-id")]=r,!h&&r.selectedMenuItemEle&&r.selectedMenuItemEle.getAttribute("data-isewex")=="1"&&(h=!0),$(r.selectedMenuItemEle).hasClass("bs-EachWayExtraMainMarket")||(s=o.itemIndexAndType(),a=u._betSlipController._bsInst.getBetItemById(s[1],s[0]),a.setStItem("ew","1"),u._betSlipController._bsInst.updateState()),c=t.querySelector('.selected[data-showdropdown="False"]'),c&&(i.innerHTML=u._formatOdds(c.getAttribute("data-odds")));this.showHideMultiples(h);u._betSlipController.eachWayExtraInfo=v};b365.Ui.Betslip.EnhancedBetSlipEachWayExtraSelector.prototype.showHideMultiples=function(n){var i,t,u,r;if(n){for($(".multipleBets").hide(),i=this._betSlipController._bsInst.getBetItems(this._betSlipController._bsInst.betTypeMultiple),t=0;t<i.length;t++)i[t].setStItem("st",""),i[t].setStItem("ust","");for(u=$("input[data-inp-type='mltstk']"),r=0;r<u.length;r++)u[r].value=""}else $(".multipleBets").show()};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.EnhancedBetSlipAusRaceBetTypeSelector=function(n){this._betSlipController=n;this._clickHandlers=[];this._siteClickHandlers=[];this._selectClickHandlers=[];this._allMenus=[];this._menuStateObjects=[];this._betSlipWrapper=$("#bsDiv");this._currentMenu=null;this._currentSelector=null;this._currentSelect=null;this._isShowing=!1;this._enabled=!1;this._TOTE_TOOLTIP_PREFIX_RESOURCE_KEY="ausRacingToteTooltip";this._AUS365_BEST="1";this._AUS365_TOTE_BEST_OF_1="4";this._AUS365_TOTE_BEST_OF_2="2";this._AUS365_MID_PLUS="8";this._AUS365_INTERNATIONAL="16";this._HORSE_RACING_AUS_365_WIN="20205";this._GREYHOUNDS_AUS_365_WIN="40234";this._TROTTING_AUS_365_WIN="880205";this._HORSE_RACING_AUS_365_WIN_INPLAY="20212";this._GREYHOUNDS_RACING_AUS_365_WIN_INPLAY="40212";this._TROTTING_AUS_365_WIN_INPLAY="880209";this._HORSE_RACING_AUS_365_PLACE="20206";this._GREYHOUNDS_AUS_365_PLACE="40235";this._TROTTING_AUS_365_PLACE="880206";this._HORSE_RACING_AUS_365_PLACE_INPLAY="20213";this._GREYHOUNDS_RACING_AUS_365_PLACE_INPLAY="40213";this._TROTTING_AUS_365_PLACE_INPLAY="880210";this._FIXED_WIN="FixedWin";this._FIXED_PLACE="FixedPlace";this._FIXED_EACH_WAY="FixedEachWay";this._TOTE_WIN="ToteWin";this._TOTE_PLACE="TotePlace";this._TOTE_EACH_WAY="ToteEachWay"};b365.Ui.Betslip.EnhancedBetSlipAusRaceBetTypeSelector.prototype.showPopUpMenu=function(n){var t=this,u,o,c,s,l,r,h,a,v,f,e,i;if(u=$(n.target),u.hasClass("bs-AusRaceBetType_Selection")&&(u=u.parent()),o=u.parent().find(".bs-AusRaceBetType_Wrapper"),c=u.parent().find("select.ausracebettype-sel"),n.stopPropagation(),t._enabled&&!c.hasClass("disabled"))if(t._betSlipController.hidePopups(t),o.length>0&&!o.hasClass("showing")){for(t._isShowing&&t._currentMenu!=null&&t._currentMenu.removeClass("showing"),t._currentMenu=o,t._currentMenu.addClass("showing"),t.addHandlers(t),t._currentSelector=u,t._currentSelect=c,t._isShowing=!0,t._betSlipController._bsInst.changeBetslipHeight(),a=n.target.getAttribute("data-participantid"),l=t._currentMenu.find(".bs-AusRaceBetType_MenuItem"),r=0,h=l.length;r<h;r++)$(l[r]).removeClass("disabled");for(r=0,h=t._menuStateObjects.length;r<h;r++)if((s=t._menuStateObjects[r],a!=s.menuId)&&(v=s.pIds.indexOf(a),v>-1)){switch(s.selectedBetType){case t._FIXED_WIN:f=t._currentMenu.find("."+t._FIXED_WIN);i=t._currentMenu.find("."+t._FIXED_EACH_WAY);break;case t._FIXED_PLACE:e=t._currentMenu.find("."+t._FIXED_PLACE);i=t._currentMenu.find("."+t._FIXED_EACH_WAY);break;case t._FIXED_EACH_WAY:f=t._currentMenu.find("."+t._FIXED_WIN);e=t._currentMenu.find("."+t._FIXED_PLACE);i=t._currentMenu.find("."+t._FIXED_EACH_WAY);break;case t._TOTE_WIN:f=t._currentMenu.find("."+t._TOTE_WIN);i=t._currentMenu.find("."+t._TOTE_EACH_WAY);break;case t._TOTE_PLACE:e=t._currentMenu.find("."+t._TOTE_PLACE);i=t._currentMenu.find("."+t._TOTE_EACH_WAY);break;case t._TOTE_EACH_WAY:f=t._currentMenu.find("."+t._TOTE_WIN);e=t._currentMenu.find("."+t._TOTE_PLACE);i=t._currentMenu.find("."+t._TOTE_EACH_WAY)}f&&!f.hasClass("selected")&&f.addClass("disabled");e&&!e.hasClass("selected")&&e.addClass("disabled");i&&!i.hasClass("selected")&&i.addClass("disabled")}}else t.hidePopUpMenu()};b365.Ui.Betslip.EnhancedBetSlipAusRaceBetTypeSelector.prototype.hidePopUpMenu=function(){var n=this;n._isShowing&&n._currentMenu!=null&&(n._currentMenu.removeClass("showing"),n.removeHandlers(n),n._currentMenu=null,n._currentSelector=null,n._currentSelect=null,n._isShowing=!1,n._betSlipController._bsInst.changeBetslipHeight())};b365.Ui.Betslip.EnhancedBetSlipAusRaceBetTypeSelector.prototype.addSelectHandlers=function(n,t){var i,r;if(t.length==0&&(t=$(".bs-AusRaceBetType_SelectionWrapper",n._betSlipWrapper)),t!=0)for(n._selectClickHandlers=[],i=0,r=t.length;i<r;i++)n._selectClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(t[i],$.proxy(n.showPopUpMenu,n),!1))};b365.Ui.Betslip.EnhancedBetSlipAusRaceBetTypeSelector.prototype.removeSelectHandlers=function(n){var t,i;if(n._selectClickHandlers.length>0){for(t=0,i=n._selectClickHandlers.length;t<i;t++)n._selectClickHandlers[t]._element&&n._selectClickHandlers[t].destroy();n._selectClickHandlers=[]}};b365.Ui.Betslip.EnhancedBetSlipAusRaceBetTypeSelector.prototype.addHandlers=function(n){var i=document.getElementById("BetSlipDialogueHeader"),r=n._currentMenu.find(".bs-AusRaceBetType_MenuItem"),t,u;if(n.removeHandlers(n),r.length>0)for(t=0,u=r.length;t<u;t++)n._clickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(r[t],$.proxy(n.handleSelection,n),!1));i&&n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(i,$.proxy(n.hidePopUpMenu,n),!1));n._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(n._betSlipWrapper[0],$.proxy(n.hidePopUpMenu,n),!1));i=null};b365.Ui.Betslip.EnhancedBetSlipAusRaceBetTypeSelector.prototype.removeHandlers=function(n){var t,i;if(n._clickHandlers.length>0){for(t=0,i=n._clickHandlers.length;t<i;t++)n._clickHandlers[t]._element&&n._clickHandlers[t].destroy();n._clickHandlers=[]}if(n._siteClickHandlers.length>0){for(t=0,i=n._siteClickHandlers.length;t<i;t++)n._siteClickHandlers[t]._element&&n._siteClickHandlers[t].destroy();n._siteClickHandlers=[]}};b365.Ui.Betslip.EnhancedBetSlipAusRaceBetTypeSelector.prototype.handleSelection=function(n){var l,a,t,y;if(!$(n.target).hasClass("disabled")&&!$(n.target).hasClass("suspend")){var i=this,p=n.target.getAttribute("data-item"),o=n.target.innerHTML,u=i._currentMenu.find(".bs-AusRaceBetType_MenuItem"),s="",r,f,h,c;if(n.stopPropagation(),o!==""){for(i._currentSelector[0].innerHTML=o,r=0,h=u.length;r<h;r++)$(u[r]).hasClass("selected")&&(s=u[r].getAttribute("data-item")),$(u[r]).removeClass("selected");for($(n.target).addClass("selected"),l=n.target.parentElement.getAttribute("data-participantid"),f=0,c=i._menuStateObjects.length;f<c;f++)if(t=i._menuStateObjects[f],t.menuId==l){var w=n.target.getAttribute("data-bettype"),b=n.target.getAttribute("data-topicid"),e=Locator.treeLookup.getReference(b);if(e&&e.data.SA){var k=new b365.Ui.Betslip.ItemInformation(n.target),v=k.itemIndexAndType(),d=this._betSlipController._bsInst.getBetItemById(v[1],v[0]);d.setCnItem("sa",e.data.SA)}t.selectedBetType=w;t.oddsElement.length>0&&(t.oddsElement[0].innerHTML=n.target.getAttribute("data-odds"));t.stakeInputElement.length>0&&(y=t.selectedBetType==i._FIXED_EACH_WAY||t.selectedBetType==i._TOTE_EACH_WAY,t.stakeInputElement.prop("placeholder",y?betSlipML.unitstake:betSlipML.stake));i.updateHelpIcon(n.target,t.helpIconElement,t.helpIconSpan);a=t.menuElement.context;break}i._currentSelect[0].parentElement.setAttribute("data-previousid",s);i._currentSelect.val(p).change();i._betSlipController._freeBetClickHandler.update(a)}i.hidePopUpMenu()}};b365.Ui.Betslip.EnhancedBetSlipAusRaceBetTypeSelector.prototype.disablePopUps=function(){var n=this;n.hidePopUpMenu();n.removeSelectHandlers(n);n._enabled=!1};b365.Ui.Betslip.EnhancedBetSlipAusRaceBetTypeSelector.prototype.enablePopUps=function(){var n=this,t=$(".bs-AusRaceBetType_SelectionWrapper",n._betSlipWrapper);if(n.removeHandlers(n),n.removeSelectHandlers(n),t.length==0){n._enabled=!1;n._isShowing=!1;return}n.addSelectHandlers(n,t);n._enabled=!0;n.updateMenuItems()};b365.Ui.Betslip.EnhancedBetSlipAusRaceBetTypeSelector.prototype.updateMenuItems=function(){var n=this,y,u,f,e,d=document.getElementById("bsDiv"),p,o,s,h,i,a,b,v,k;for(n._allMenus=d.getElementsByClassName("bs-AusRaceBetType_Menu"),n._menuStateObjects=[],f=0,len=n._allMenus.length;f<len;f++){h=[];u=n._allMenus[f];y=u.getAttribute("data-participantid");s=u.children;var t=u.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement,c=$(t).find('input[class~="stk"]'),r=$(t).find(".EnhancedOddsSelection"),l=$(t).find(".bs-AusRaceBetType_HelpIcon"),w=l[0].children[0],g=$(t).find(".bs-AusRaceBetType"),nt=$(t).find(".stakeToReturn");for(nt.addClass("bs-AusRaceBetType_ToReturn"),r.length==0&&(r=$(t).find(".odds")),e=0,itemLen=s.length;e<itemLen;e++)i=s[e],a=i.getAttribute("data-item"),a.indexOf("~")==-1&&(b=a.split("#"),v=b[0],h.push(v.substr(2,v.length))),i.className.indexOf("selected")>-1&&(o=i.getAttribute("data-bettype"),r.length>0&&(r[0].innerHTML=i.getAttribute("data-odds")),k=o==n._FIXED_EACH_WAY||o==n._TOTE_EACH_WAY,c.length>0&&c.prop("placeholder",k?betSlipML.unitstake:betSlipML.stake),n.updateHelpIcon(i,l,w));p={pIds:h,menuId:y,selectedBetType:o,oddsElement:r,stakeInputElement:c,helpIconElement:l,helpIconSpan:w,menuElement:g};n._menuStateObjects.push(p)}};b365.Ui.Betslip.EnhancedBetSlipAusRaceBetTypeSelector.prototype.isInBreachOfNSWRegulations=function(){var t=Locator.user.isLoggedIn,i=Locator.user.countryId==="13",n=Locator.user.countryStateId;return t?!1:i?n!=="0"&&n!=="93"?!1:!0:!1};b365.Ui.Betslip.EnhancedBetSlipAusRaceBetTypeSelector.prototype.updateHelpIcon=function(n,t){var i=this,f,e,r,u,o;if(n)if(f=n.getAttribute("data-toteid"),e=n.getAttribute("data-plbtid"),e.length>1){r="";switch(f){case i._AUS365_BEST:r=betSlipML.ausRacingBest;break;case i._AUS365_TOTE_BEST_OF_1:case i._AUS365_TOTE_BEST_OF_2:r=betSlipML.ausRacingTote;break;case i._AUS365_MID_PLUS:r=betSlipML.ausRacingMidPlus;break;case i._AUS365_INTERNATIONAL:r=betSlipML.ausRacingInternational}if(r==""?t.addClass("hidden"):t.removeClass("hidden"),u=i._TOTE_TOOLTIP_PREFIX_RESOURCE_KEY,o=n.getAttribute("data-bettype"),o==i._TOTE_EACH_WAY)u+=i._TOTE_EACH_WAY;else switch(e){case i._HORSE_RACING_AUS_365_WIN:case i._GREYHOUNDS_AUS_365_WIN:case i._TROTTING_AUS_365_WIN:case i._HORSE_RACING_AUS_365_WIN_INPLAY:case i._GREYHOUNDS_RACING_AUS_365_WIN_INPLAY:case i._TROTTING_AUS_365_WIN_INPLAY:u+="ToteWin";break;case i._HORSE_RACING_AUS_365_PLACE:case i._GREYHOUNDS_AUS_365_PLACE:case i._TROTTING_AUS_365_PLACE:case i._HORSE_RACING_AUS_365_PLACE_INPLAY:case i._GREYHOUNDS_RACING_AUS_365_PLACE_INPLAY:case i._TROTTING_AUS_365_PLACE_INPLAY:u+="TotePlace"}u+=f;i.isInBreachOfNSWRegulations()||(r+="<div class='ausHelp'><div class='bs-Tote_Nib'><\/div><\/div><div class='bs-Tote_Popup'>"+betSlipML[u]+"<div>");t[0].innerHTML=r}else t.addClass("hidden")};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ItemToReturnDisplayHelper=function(n){this._bsWrapper=$("#bsDiv");this._betSlipController=n};b365.Ui.Betslip.ItemToReturnDisplayHelper.prototype.setReturnValue=function(n,t,i){var u=$('li[data-item-id="'+n+'"][data-item-type="'+t+'"]',this._bsWrapper).find(".stakeToReturn > .stakeToReturn_Value"),r;u.length>0&&(this._betSlipController&&this._betSlipController._currencyDisplayHelper?(r=this._betSlipController._currencyDisplayHelper.formatCurrency(i),r=r.length>=6?"<br />"+r:"&nbsp;"+r,u[0].innerHTML=r):(i.length>=6&&(i="<br />"+i),u[0].innerHTML=i))};b365.Ui.Betslip.ItemToReturnDisplayHelper.prototype.setMultipleReturnValue=function(n,t,i){var r=$('li[data-item-id="'+n+'"][data-item-type="'+t+'"]',this._bsWrapper).find(".bs-StandardMultipleStake_ToReturn > .bs-StandardMultipleStake_ToReturnValue"),u;r.length>0&&(this._betSlipController&&this._betSlipController._currencyDisplayHelper?(u=this._betSlipController._currencyDisplayHelper.formatCurrency(i),u="&nbsp;"+u,r[0].innerHTML=u):(i.length>=6&&(i="<br />"+i),r[0].innerHTML=i),$(r[0].parentElement).removeClass("hidden"))};b365.Ui.Betslip.ItemToReturnDisplayHelper.prototype.setVisibility=function(n,t,i){var r=$('li[data-item-id="'+n+'"][data-item-type="'+t+'"]',this._bsWrapper).find(".stakeToReturn");r.length>0&&(i?r[0].hasAttribute("style")&&r[0].removeAttribute("style"):r[0].setAttribute("style","display:none;"))};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ModeResolver=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.ModeResolver.prototype={resolve:function(){if(this._isValid()){var n=this,t=n._bsInst._betSlipModeBetSlip;return $("#bsDiv>ul:first").hasClass("betReceipt")&&(t=n._bsInst._betSlipModeReceipt),t}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ItemDeleteExecutor=function(n,t,i,r){this._bsInst=n;this._bsController=t;this._itemIndex=i;this._itemType=r;this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._itemIndex!="undefined"&&typeof this._itemType!="undefined"};this._deleteItem=function(){var f,i,t,r,u,n;if(this._itemType=="betbuilder")for(f=this._bsInst.getBetItems(this._bsInst.betTypeBetBuilder)[this._itemIndex],i=f.getBBItems(),t=0;t<i.length;t++)n=i[t].getValue("TP"),n&&Locator.subscriptionManager.unsubscribe(n,ns_gen5_data.SubscriptionManagerFlags.BATCH,!0,!0);return r=this._bsInst.getBetItems(this._itemType),u=r[parseInt(this._itemIndex)],r.splice(parseInt(this._itemIndex),1),this._bsInst.updateState(),n=u.getTopic(),n&&$("#bsDiv").trigger(n),this._bsInst.betSlipItemsChanged(),u}};b365.Ui.Betslip.ItemDeleteExecutor.prototype={execute:function(){var n,t,i;this._isValid()&&(this._bsController.isReqOnBetDeletedEnabled()&&this._bsInst.locked()||(n=this._deleteItem(),(!this._bsController.isReqOnBetDeletedEnabled()||this._bsInst.getBetItems(this._bsInst.betTypeAll).length==0||this._bsInst.req(this._bsInst.reqTypeRefreshSlip,"",null,null,"getMultipleCombinations"))&&(sProps.instantBet&&(new b365.Ui.Betslip.TotalsCalculator(this._bsInst,this._bsController).calculate(),$(".single-section,.multiple-section,.totals,.bsError,#pro").addClass("hidden"),$(".emptyBetslip").removeClass("hidden"),$(".placeBet").addClass("disabled")),n.getCnItem("id")?this._bsController.itemsRemoved(n.getCnItem("id").replace(/[N|Y]$/im,"")):n.getCnItem("mid")&&n.getCnItem("pid")?this._bsController.itemsRemoved(n.getCnItem("pid")+":"+n.getCnItem("mid")):n.getCnItem("Inc")?this._bsController.itemsRemoved(n.getCnItem("fp")+"~inc"+n.getCnItem("Inc")):(this._bsController.itemsRemoved(n.getCnItem("fp")),t=n.getCnItem("pp")||n.getStItem("pp"),t&&t.length>0&&this._bsController.itemsRemoved(t)))),this._bsInst.getBetItems(this._bsInst.betTypeAll).length===this._bsInst.getBetItems(this._bsInst.betTypeMultiple).length&&this._bsInst.clearBets(),this._bsInst.getBetItems(this._bsInst.betTypeAll).length==0&&(i=this._bsController._bsInst.getClickToCallHandler(),i&&(ctcTokenData=i.dispose())))}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ItemInformation=function(n,t){this._ele=n;this._useElement=t;this._isValid=function(){return typeof this._ele!="undefined"};this._isValid()&&(this._useElement&&this._useElement===!0?(this._ele=$(this._ele),this._itemType=[this._ele.attr("data-item-id"),this._ele.attr("data-item-type")]):(this._parent=$(this._ele).parents("li[data-item-id]:first"),this._itemType=[this._parent.attr("data-item-id"),this._parent.attr("data-item-type")]))};b365.Ui.Betslip.ItemInformation.prototype={itemIndexAndType:function(){return this._isValid()?this._itemType:null},itemIndex:function(){return this._isValid()?this._itemType[0]:null},itemType:function(){return this._isValid()?this._itemType[1]:null},itemElement:function(){return $(this._ele).parents("li[data-item-id]:first")}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ToggleMultiples=function(n,t){var i,f,r,u;if(this._bsInst=n,this._bsController=t,this._showingVal="1",this._showingCSS="open",this._hidingVal="0",this._hidingCSS="closed",this._multiplesStateCookieKey="mo",this._cookieValSeparator="||",this._multiplesHdr=$("#bsDiv ul:not(.betReceipt) li.multiple-section ul:first-child"),this._isValid=function(){return typeof this._bsInst!="undefined"},this._isValid()&&(this._isCurrentlyShowing=this._bsInst.getValueFromBSCookie(this._multiplesStateCookieKey).replace(this._cookieValSeparator,"")==this._showingVal),this._setTriggerClass=function(n){var i="show-mrc",t=$("#bsDiv>ul:first-child"),r="bs-NoMultiples";$("#bsDiv .betReceipt").length==0&&n?t.addClass(i):t.removeClass(i);$("#bsDiv .betReceipt").length==0&&this._multiplesHdr[0]&&!this._bsInst.containsPhoneOnlyBet()?t.removeClass(r):t.addClass(r)},i=$('.multiple-section div[data-inp-type="ewcb"]',"#bsDiv"),i&&i.length>0)for(f=i.length,r=0;r<f;r++)u=i[r],t.ausMultiplesEnabled()?u.setAttribute("style","display:none;"):u.setAttribute("style","display:block;")};b365.Ui.Betslip.ToggleMultiples.prototype={toggle:function(){this._isValid()&&$("#bsDiv .betReceipt").length==0&&(this._isCurrentlyShowing?this._multiplesHdr.removeClass(this._showingCSS).addClass(this._hidingCSS):this._multiplesHdr.removeClass(this._hidingCSS).addClass(this._showingCSS),this._bsInst.setValueInBSCookie(this._multiplesStateCookieKey,this._isCurrentlyShowing?this._hidingVal:this._showingVal),this._setTriggerClass(!this._isCurrentlyShowing),this._bsInst.changeBetslipHeight(),this._bsController.ausMultiplesEnabled()&&!this._isCurrentlyShowing&&this._bsController.complexMultiplesNeedsRefresh&&(this._bsController.complexMultiplesNeedsRefresh=!1,this._bsController.getMultipleInfo(!0)),$(document).trigger("mbsmultopenclose"))},reset:function(){this._isCurrentlyShowing?this._multiplesHdr.removeClass(this._hidingCSS).addClass(this._showingCSS):this._multiplesHdr.removeClass(this._showingCSS).addClass(this._hidingCSS);this._setTriggerClass(this._isCurrentlyShowing)}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.EachWayClickProcessor=function(n,t,i,r,u){this._bsInst=n;this._bsController=t;this._itemIndex=i;this._itemType=r;this._itemElement=u;this._eachWayCookieKey="ew";this._showLinesLabel=$("#bsDiv>ul").attr("data-tcm")=="2";this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._itemIndex!="undefined"&&typeof this._itemType!="undefined"&&typeof this._itemElement!="undefined"};this._updateStakeLabel=function(n){var t,i;this._showLinesLabel||(i=$(this._itemElement)[0].className.indexOf("bs-MultipleBets_HighestAccumulator")>1,t=i?betSlipML.unitstake:n?betSlipML.unitstake:betSlipML.stake,$(this._itemElement).find('input[class~="stk"]').prop("placeholder",t))}};b365.Ui.Betslip.EachWayClickProcessor.prototype={handle:function(n){var i=this._bsInst.getBetItemById(this._itemType,this._itemIndex),t;i&&(i.setStItem(this._eachWayCookieKey,n?"1":"0"),this._bsController.updateMultiplesEachWayFlag(),this._bsInst.updateState(),this._updateStakeLabel(n),new b365.Ui.Betslip.TotalsCalculator(this._bsInst,this._bsController).calculate(),this._bsController.ausMultiplesEnabled()&&this._bsController.getMultipleInfo());this._itemElement&&this._itemElement.length>0&&(t=$('input[data-inp-type="sngstk"]',this._itemElement[0]),t&&t.length>0&&this._bsController.OnItemStakeChanged(t[0]))}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.EachWayExtraClickProcessor=function(n,t,i,r,u){this._bsInst=n;this._bsController=t;this._itemIndex=i;this._itemType=r;this._itemElement=u;this._eachWayCookieKey="ew";this._showLinesLabel=$("#bsDiv>ul").attr("data-tcm")=="2";this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._itemIndex!="undefined"&&typeof this._itemType!="undefined"&&typeof this._itemElement!="undefined"};this._updateStakeLabel=function(n){var t,i;this._showLinesLabel||(i=$(this._itemElement)[0].className.indexOf("bs-MultipleBets_HighestAccumulator")>1,t=i?betSlipML.unitstake:n?betSlipML.unitstake:betSlipML.stake,$(this._itemElement).find('input[class~="stk"]').prop("placeholder",t))}};b365.Ui.Betslip.EachWayExtraClickProcessor.prototype={handle:function(n){var i=this._bsInst.getBetItemById(this._itemType,this._itemIndex),t,r,f,e,u;i&&(t=this._bsController.eachWayExtraInfo[this._itemIndex],t&&(r&&(t.oddsEle&&(t.oddsEle.innerHTML=r.getAttribute("data-odds")),t.menuButtonEle&&(f=r.getElementsByClassName("bs-EachWayExtraBetType_MenuItemName")[0],f&&(t.menuButtonEle.innerHTML=f.innerHTML)),e=r.getAttribute("data-participantid"),t.betItemEle&&t.betItemEle.setAttribute("data-item-fpid",e),this._bsController.itemsRemoved(i.getCnItem("fp")),i.setStItem(this._eachWayCookieKey,n?"1":"0"),i.setCnItem("fp",e),i.setCnItem("o",r.getAttribute("data-odds")),this._bsController.highlightSelectedBets(),this._bsController.updateMultiplesEachWayFlag(),this._bsInst.updateState(),this._updateStakeLabel(n),new b365.Ui.Betslip.TotalsCalculator(this._bsInst,this._bsController).calculate(),this._bsController.ausMultiplesEnabled()&&this._bsController.getMultipleInfo(),u=$('input[data-inp-type="sngstk"]',this._itemElement[0]),u&&u.length>0&&this._bsController.OnItemStakeChanged(u[0])),t.dropdownEle&&(t.dropdownEle.className.indexOf("disabled")>-1?($(t.dropdownEle).removeClass("disabled"),$(t.eachWaySelectionWrapper).removeClass("disabled")):($(t.dropdownEle).addClass("disabled"),$(t.eachWaySelectionWrapper).addClass("disabled"),t.eachWayExtraWrapperEle&&$(t.eachWayExtraWrapperEle).removeClass("showing")))))}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.FreeBetClickProcessor=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._itemIndex!="undefined"&&typeof this._itemType!="undefined"&&typeof this._itemElement!="undefined"};this._handleUpdates=function(n){var i,r,t;(this._stakeTextBoxes=this._itemElement.querySelectorAll('input[class~="stk"]'),this._stakeTextBox=this._getStakeInputForBetType(),this._stakeTextBox)&&(this._betCount=+this._bsInst.getBetItemById(this._itemType,this._itemIndex).getStItem("bc")||1,n?(this._itemElement.className.indexOf("errStk")>-1&&(this._itemElement.className=this._itemElement.className.replace("errStk",""),document.getElementsByClassName("errStk").length===0&&new b365.Ui.Betslip.AcceptChangesRequestDespatcher(this._bsInst,this._bsController).despatch(null)),this._itemElement.className.indexOf("bs-FreeBet-selected")===-1&&(this._itemElement.className=this._itemElement.className+" bs-FreeBet-selected"),this._insertFreeBetStakeForBetItem(),this._disableStakeInputs(),this._bsController&&this._bsController.clientEnhancedMode()&&this._bsController._stakeEntryHander.hide()):(this._itemElement.className=this._itemElement.className.replace(" bs-FreeBet-selected",""),this._enableStakeInputs(),this._clearFreeBetStakeFromBetItem(),i=$(".isocode","#bsDiv"),r=$("#bsDiv").children("ul:first-child").data("isocode"),i.text(r),this._resetStakeValue()),this._singlesMultiplier&&this._itemType==="single"&&(t=this._singlesMultiplier.innerText.replace(/[^0-9]/g,""),n?t-=1:t+=1,this._singlesMultiplier.innerText=t+" x"),new b365.Ui.Betslip.StakeChangedHandler(this._bsInst,this._bsController).handle(this._stakeTextBox),new b365.Ui.Betslip.BetCreditsCalculator(this._bsInst,this._bsController,n).calculate())}};b365.Ui.Betslip.FreeBetClickProcessor.prototype={init:function(n){var t=new b365.Ui.Betslip.ItemInformation(n),i=t.itemIndexAndType(),r=t.itemElement();return this._itemIndex=i[0],this._itemType=i[1],this._itemElement=r[0],this._element=n,this._freeBetIdCookieKey="ft",this._freeBetValueCookieKey="fbv",this._eachWayCookieKey="ew",this._multiplesStakeBox=document.getElementById("mltsngstk"),this._singlesMultiplier=document.querySelector('li[data-item-id="-1"] .multiplesBetCount'),this._freeBetContainer=this._itemElement.getElementsByClassName("bs-UseFreeBetContainer")[0],this._freeBetStake=this._itemElement.getElementsByClassName("bs-FreeBetStake")[0],this},handle:function(n){var t=this._bsInst.getBetItemById(this._itemType,this._itemIndex);this._isValid&&t&&(t.setStItem(this._freeBetIdCookieKey,n?this._freeBetContainer.getAttribute("data-item-fbt"):""),t.setStItem(this._freeBetValueCookieKey,n?this._freeBetContainer.getAttribute("data-item-fbv"):""),this._bsInst.updateState(),this._isEachWay=t.getStItem(this._eachWayCookieKey)==1,this._handleUpdates(n))},_getStakeInputForBetType:function(){var n="bs-Stake_TextBox";switch(this._itemType){case"single":case"betbuilder":n=".stk";break;case"cast":n=this._stakeTextBoxes[0].className.indexOf("Flexi")>=0?".bs-FlexiUnitStake_TextBox":".stk"}return this._itemElement.querySelector(n)},_insertFreeBetStakeForBetItem:function(){var n=this._freeBetContainer.getAttribute("data-item-fbv"),t;this._bsController.clientEnhancedMode()||(this._stakeTextBox.type="text");this._isEachWay?(n=ns_betcalculationslib_rounding.RoundingHelper.RoundUp(n/2),t=this._bsController._currencyDisplayHelper.getDecimalSeperator(),this._freeBetStake.childNodes[0].data=$blib.pad2DP(String(n*2),t)):this._itemType!=="single"?(n=ns_betcalculationslib_calculations.StakeCalculations.CalculateUnitStake(n,this._betCount).toFixed(2),this._resetStakeValue()):this._resetStakeValue();this._stakeTextBox.value=n},_clearFreeBetStakeFromBetItem:function(){this._bsController.clientEnhancedMode()||(this._stakeTextBox.type="number");this._stakeTextBox.value=this._itemType==="single"&&this._multiplesStakeBox&&this._multiplesStakeBox.value!=""?this._multiplesStakeBox.value:""},_toggleDisclaimerSection:function(n){var t=document.getElementsByClassName("bs-FreeBetDisclaimer")[0];n&&t.className.indexOf(" hidden")>-1?t.className=t.className.replace(" hidden",""):t.className.indexOf(" hidden")===-1&&(t.className+=" hidden")},_enableStakeInputs:function(){for(var t,n=0;n<this._stakeTextBoxes.length;n++)this._stakeTextBoxes[n].removeAttribute("disabled"),this._stakeTextBoxes[n].style.pointerEvents="",this._stakeTextBoxes[n].className=this._stakeTextBoxes[n].className.replace("bs-FreeBet-disabled","");for(t=document.getElementsByClassName("bs-UseFreeBet-disabled"),n=t.length-1;n>=0;n--)t[n].className=t[n].className.replace(" bs-UseFreeBet-disabled","")},_disableStakeInputs:function(){for(var t,n=0;n<this._stakeTextBoxes.length;n++)this._stakeTextBoxes[n].setAttribute("disabled","disabled"),this._stakeTextBoxes[n].style.pointerEvents="none",this._stakeTextBoxes[n].className=this._stakeTextBoxes[n].className+" bs-FreeBet-disabled";for(t=document.getElementsByClassName("bs-UseFreeBet"),n=0;n<t.length;n++)t[n]!==this._element.parentNode.parentNode&&(t[n].className=t[n].className+" bs-UseFreeBet-disabled")},_resetStakeValue:function(){this._freeBetStake.childNodes[0].data=this._freeBetContainer.getAttribute("data-item-fbv")}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.RemoveClickHandler=function(n,t){this._bsInst=n;this._bsController=t;this._enabled=!1;this._removeClickHandlers=[];this._isValid=function(){return typeof this._bsInst!="undefined"};this._reorderChildElements=function(n){var t,r,i=0;if(n.children.length!=0)for(t=0,r=n.children.length;t<r;t++)n.children[t].hasAttribute("data-item-id")&&(n.children[t].setAttribute("data-item-id",i),i=i+1)}};b365.Ui.Betslip.RemoveClickHandler.prototype={handle:function(n){var t=this,u,y=!1,h,c,e,l,a,f,o,v,p,w,s,i,r;typeof n!="undefined"&&n&&(t.removeHandlers(),u=n.target,h=$(u),h.prop("disabled")||h.parents().prop("disabled")||!h.hasClass("remove")?y=!0:(h.hasClass("restrictedMultiple")&&(h=$(u).parent().find("a.remove"),u=h[0]),t._bsInst._pollReqType===t._bsInst.reqTypePollTempBetReceipt&&t._bsInst.resetPoll(),s=new b365.Ui.Betslip.ItemInformation(u),i=s.itemIndexAndType(),r=s.itemElement(),f=$(u.parentNode).next()[0],i[1]!="tote-pot-leg"&&(i[1]!="tote-pot"||h.parent().hasClass("ToteRemoveAll"))?i[1]=="cast"&&f&&f.hasAttribute("data-item-type")&&f.getAttribute("data-item-type")?(u=f,s=new b365.Ui.Betslip.ItemInformation(u,!0),i=s.itemIndexAndType(),r=s.itemElement(),new b365.Ui.Betslip.TotePotLegDeleteExecutor(t._bsInst,u,i[0],i[1]).execute(),t.attachHandlers()):t._bsController.clientEnhancedMode()?(c=t._bsInst,e=t._bsController,l=i[0],a=i[1],f=r[0].parentElement,t._bsController._stakeEntryType==t._bsController._stakeEntryTypes.stakePad?(o=$("#stakePad",r),o.length>0&&!o.hasClass("hideStakePad")?e._enhancedBetSlipAnimations.removeSingleBet(r,!0,o,t.removeBetItemCallBack,[f,r[0],c,e,l,a],t):(o=$("#stakePad"),o.length>0?(v=o[0].getAttribute("data-item"),p=o[0].getAttribute("data-type"),w=r[0].getAttribute("data-item-id"),p!="multiple"&&w<v&&(v=v-1,o[0].setAttribute("data-item",v)),e._enhancedBetSlipAnimations.removeSingleBet(r,!1,null,t.removeBetItemCallBack,[f,r[0],c,e,l,a],t)):e._enhancedBetSlipAnimations.removeSingleBet(r,!1,null,t.removeBetItemCallBack,[f,r[0],c,e,l,a],t))):e._enhancedBetSlipAnimations.removeSingleBet(r,!1,null,t.removeBetItemCallBack,[f,r[0],c,e,l,a],t)):new b365.Ui.Betslip.ItemDeleteExecutor(t._bsInst,t._bsController,i[0],i[1]).execute():(u=f,s=new b365.Ui.Betslip.ItemInformation(u,!0),i=s.itemIndexAndType(),r=s.itemElement(),new b365.Ui.Betslip.TotePotLegDeleteExecutor(t._bsInst,u,i[0],i[1]).execute(),t.attachHandlers()),y=!0),y?(n.stopPropagation(),n.preventDefault()):t._bsController._stakeEntryType!=t._bsController._stakeEntryTypes.deviceKeyBoard&&t._bsController._stakeEntryHander._isShowing&&(t._bsController._stakeEntryHander.hide(),n.stopPropagation(),n.preventDefault()),t.attachHandlers())},removeBetItemCallBack:function(){var n=arguments[0],t=arguments[1],i=arguments[2],r=arguments[3],u=arguments[4],f=arguments[5];n.removeChild(t);new b365.Ui.Betslip.ItemDeleteExecutor(i,r,u,f).execute();this._reorderChildElements(n);this.attachHandlers()},attachHandlers:function(){var n=this,i=$(".remove",n._betSlipWrapper),t,r;if(n.removeHandlers(n),i.length==0){n._enabled=!1;return}for(t=0,r=i.length;t<r;t++)n._removeClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(i[t],$.proxy(n.handle,n),!1));n._enabled=!0},removeHandlers:function(){var n=this,t,i;if(n._removeClickHandlers.length>0){for(t=0,i=n._removeClickHandlers.length;t<i;t++)n._removeClickHandlers[t]._element&&n._removeClickHandlers[t].destroy();n._removeClickHandlers=[]}n._enabled=!1}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.EachWayClickHandler=function(n,t){this._bsInst=n;this._bsController=t;this._enabled=!1;this._eachWayClickHandlers=[];this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.EachWayClickHandler.prototype={handle:function(n){var f=this,t,i,o,e,r,u;if(typeof n!="undefined"&&n){f.removeHandlers();t=n.target;i=$(t);switch(t.nodeName.toLowerCase()){case"div":i=$(t).find('span.checkbox[data-inp-type="ewcb"]');t=i[0];break;default:i=$(t).parent().find('span.checkbox[data-inp-type="ewcb"]');t=i[0]}i.prop("disabled")||i.parents().prop("disabled")||i.hasClass("disabled")||(f._bsInst._pollReqType===f._bsInst.reqTypePollTempBetReceipt&&f._bsInst.resetPoll(),o=new b365.Ui.Betslip.ItemInformation(t),e=o.itemIndexAndType(),r=o.itemElement(),$(r).hasClass("suspended")||(u=$(t).hasClass("checked"),!1||(u?($(t).removeClass("checked"),u=!1):($(t).addClass("checked"),u=!0)),t.className.indexOf("js-EachWayExtra")>-1&&t.className.indexOf(" disabled")==-1&&new b365.Ui.Betslip.EachWayExtraClickProcessor(this._bsInst,this._bsController,e[0],e[1],r).handle(u),new b365.Ui.Betslip.EachWayClickProcessor(this._bsInst,this._bsController,e[0],e[1],r).handle(u),$(r).hasClass("bs-FreeBet-selected")&&this._freeBetTokenAdjustment(r)));f.attachHandlers();n.stopPropagation();n.preventDefault()}},attachHandlers:function(){var n=this,i=$('div[data-inp-type="ewcb"], span[data-inp-type="ewcb"]',"#bsDiv"),t,r;if(n.removeHandlers(n),i.length==0){n._enabled=!1;return}for(t=0,r=i.length;t<r;t++)n._eachWayClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(i[t],$.proxy(n.handle,n),!1));n._enabled=!0},removeHandlers:function(){var n=this,t,i;if(n._eachWayClickHandlers.length>0){for(t=0,i=n._eachWayClickHandlers.length;t<i;t++)n._eachWayClickHandlers[t]._element&&n._eachWayClickHandlers[t].destroy();n._eachWayClickHandlers=[]}n._enabled=!1},_freeBetTokenAdjustment:function(n){var t=n[0].querySelector('div[data-inp-type="fbcb"]'),i=!1;t&&t.parentNode.className.indexOf("bs-UseFreeBet-disabled")==-1&&t.parentNode.className.indexOf("bs-UseFreeBet-error")==-1&&(i=t.className.indexOf("bs-FreeBetCheckBox-selected")>-1);i&&new b365.Ui.Betslip.FreeBetClickProcessor(this._bsInst,this._bsController).init(t).handle(i)}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.FreeBetClickHandler=function(n,t){this._bsInst=n;this._bsController=t;this._enabled=!1;this._freeBetClickHandlers=[];this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.FreeBetClickHandler.prototype={handle:function(n){var i=this,t,f,u,r,e;i.removeHandlers();t=n.target;i._bsInst._pollReqType===i._bsInst.reqTypePollTempBetReceipt&&i._bsInst.resetPoll();f=new b365.Ui.Betslip.ItemInformation(t);u=f.itemElement()[0];t=u.querySelector(".bs-FreeBetCheckBox");u.className.indexOf("suspended")==-1&&t.parentNode.className.indexOf("bs-UseFreeBet-disabled")==-1&&t.parentNode.className.indexOf("bs-UseFreeBet-error")==-1&&$("#bsDiv.bs-inprogress").length==0&&(r=t.className.indexOf("bs-FreeBetCheckBox-selected")>-1,!1||(r?(t.className=t.className.replace("bs-FreeBetCheckBox-selected",""),r=!1):(this._bsInst.getValueFromBSCookie("fs")&&this._bsInst.getValueFromBSCookie("fs").replace("||","")==="1"&&(e=this._bsInst.getBetItems(this._bsInst.itemTypeSingle).concat(this._bsInst.getBetItems(this._bsInst.itemTypeBetBuilder)),e.length===1&&new b365.Ui.Betslip.ToggleBetCredits(this._bsInst,this._bsController).toggle()),t.className=t.className+" bs-FreeBetCheckBox-selected",r=!0),new b365.Ui.Betslip.FreeBetClickProcessor(this._bsInst,this._bsController).init(t).handle(r)));i.attachHandlers();n.stopPropagation();n.preventDefault()},toggle:function(n){var t,u,r,i;u=new b365.Ui.Betslip.ItemInformation(n);r=u.itemElement()[0];t=r.querySelector(".bs-FreeBetCheckBox");r.className.indexOf("suspended")==-1&&t&&t.parentNode.className.indexOf("bs-UseFreeBet-disabled")==-1&&t.parentNode.className.indexOf("bs-UseFreeBet-error")==-1&&(i=t.className.indexOf("bs-FreeBetCheckBox-selected")>-1,!1||(i?(t.className=t.className.replace("bs-FreeBetCheckBox-selected",""),i=!1):(t.className=t.className+" bs-FreeBetCheckBox-selected",i=!0),new b365.Ui.Betslip.FreeBetClickProcessor(this._bsInst,this._bsController).init(t).handle(i)));this.attachHandlers()},update:function(n){var i,t;n&&(checkBox=n.querySelector('div[data-inp-type="fbcb"]'),i=checkBox&&checkBox.className.indexOf("bs-FreeBetCheckBox-selected")>-1,n.className.indexOf("suspended")==-1&&i&&checkBox.parentNode.className.indexOf("bs-UseFreeBet-disabled")==-1&&checkBox.parentNode.className.indexOf("bs-UseFreeBet-error")==-1?new b365.Ui.Betslip.FreeBetClickProcessor(this._bsInst,this._bsController).init(checkBox).handle(i):(t=$('input[data-inp-type="sngstk"]',n),t&&t.length>0&&this._bsController.OnItemStakeChanged(t[0])))},attachHandlers:function(){for(var t=this,i=[],u,r=document.getElementsByClassName("bs-UseFreeBet"),n=0;n<r.length;n++)r[n].className.indexOf("bs-UseFreeBet-error")==-1&&r[n].className.indexOf("bs-UseFreeBet-disabled")==-1&&i.push(r[n].parentNode);if(t.removeHandlers(t),i.length==0){t._enabled=!1;return}for(n=0,u=i.length;n<u;n++)t._freeBetClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(i[n],$.proxy(t.handle,t),!1));t._enabled=!0},removeHandlers:function(){var n=this,t,i;if(n._freeBetClickHandlers.length>0){for(t=0,i=n._freeBetClickHandlers.length;t<i;t++)n._freeBetClickHandlers[t]._element&&n._freeBetClickHandlers[t].destroy();n._freeBetClickHandlers=[]}n._enabled=!1}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.BetslipClickHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"};this._reorderChildElements=function(n){var t,r,i=0;if(n.children.length!=0)for(t=0,r=n.children.length;t<r;t++)n.children[t].hasAttribute("data-item-id")&&(n.children[t].setAttribute("data-item-id",i),i=i+1)}};b365.Ui.Betslip.BetslipClickHandler.prototype={handle:function(n){var i=this,u,r=!1,t,o,h,c,s,l,e,f;if(typeof n!="undefined"&&n){if(u=n.target,t=$(u),u.id==="BetSlipTypeSelector"||u.id=="BetSlipTypeSelectorWrapper"){this._bsController._stakeEntryType!=this._bsController._stakeEntryTypes.deviceKeyBoard&&this._bsController._stakeEntryHander._isShowing&&this._bsController._stakeEntryHander.hide();i._bsController._enhancedBetSlipTypeSelector?i._bsController._enhancedBetSlipTypeSelector._enabled&&(i._bsController._enhancedBetSlipTypeSelector._isShowing?i._bsController._enhancedBetSlipTypeSelector.hidePopUpMenu():i._bsController._enhancedBetSlipTypeSelector.showPopUpMenu()):(i._bsController._enhancedBetSlipTypeSelector=new b365.Ui.Betslip.EnhancedBetSlipTypeSelector(i._bsController),i._bsController._enhancedBetSlipTypeSelector.enablePopUp(),i._bsController._enhancedBetSlipTypeSelector.showPopUpMenu());n.stopPropagation();n.preventDefault();return}if(t.hasClass(".bs-AusRaceBetType_Selection")){this._bsController._stakeEntryType!=this._bsController._stakeEntryTypes.deviceKeyBoard&&this._bsController._stakeEntryHander._is&&this._bsController._stakeEntryHander.hide();i._bsController._enhancedBetSlipAusRaceBetTypeSelector?i._bsController._enhancedBetSlipAusRaceBetTypeSelector._enabled&&i._bsController._enhancedBetSlipAusRaceBetTypeSelector.showPopUpMenu(n):(i._bsController._enhancedBetSlipAusRaceBetTypeSelector=new b365.Ui.Betslip.EnhancedBetSlipAusRaceBetTypeSelector(i._bsController),i._bsController._enhancedBetSlipAusRaceBetTypeSelector.enablePopUps(),i._bsController._enhancedBetSlipAusRaceBetTypeSelector.showPopUpMenu(n));n.stopPropagation();n.preventDefault();return}if(t.hasClass(".bs-EachWayExtraBetType_Selection")){this._bsController._stakeEntryType!=this._bsController._stakeEntryTypes.deviceKeyBoard&&this._bsController._stakeEntryHander._is&&this._bsController._stakeEntryHander.hide();i._bsController._enhancedBetSlipEachWayExtraSelector?i._bsController._enhancedBetSlipEachWayExtraSelector._enabled&&i._bsController._enhancedBetSlipEachWayExtraSelector.showPopUpMenu(n):(i._bsController._enhancedBetSlipEachWayExtraSelector=new b365.Ui.Betslip.EnhancedBetSlipEachWayExtraSelector(i._bsController),i._bsController._enhancedBetSlipEachWayExtraSelector.enablePopUps(),i._bsController._enhancedBetSlipEachWayExtraSelector.showPopUpMenu(n));n.stopPropagation();n.preventDefault();return}if(t.hasClass("telBreakout"))return;if(t.hasClass(".EnhancedOddsSelection")){this._bsController._stakeEntryType!=this._bsController._stakeEntryTypes.deviceKeyBoard&&this._bsController._stakeEntryHander._isShowing&&this._bsController._stakeEntryHander.hide();i._bsController._enhancedBetSlipOddsSelector?i._bsController._enhancedBetSlipOddsSelector._enabled&&i._bsController._enhancedBetSlipOddsSelector.showPopUpMenu(n):(i._bsController._enhancedBetSlipOddsSelector=new b365.Ui.Betslip.EnhancedBetSlipOddsSelector(i._bsController),i._bsController._enhancedBetSlipOddsSelector.enablePopUps(),i._bsController._enhancedBetSlipOddsSelector.showPopUpMenu(n));n.stopPropagation();n.preventDefault();return}if(t.hasClass(".EnhancedPitcherSelection")){this._bsController._stakeEntryType!=this._bsController._stakeEntryTypes.deviceKeyBoard&&this._bsController._stakeEntryHander._isShowing&&this._bsController._stakeEntryHander.hide();i._bsController._enhancedBetSlipPitcherSelector?i._bsController._enhancedBetSlipPitcherSelector._enabled&&i._bsController._enhancedBetSlipPitcherSelector.showPopUpMenu(n):(i._bsController._enhancedBetSlipPitcherSelector=new b365.Ui.Betslip.EnhancedBetSlipPitcherSelector(i._bsController),i._bsController._enhancedBetSlipPitcherSelector.enablePopUps(),i._bsController._enhancedBetSlipPitcherSelector.showPopUpMenu(n));n.stopPropagation();n.preventDefault();return}if(t.hasClass(".EnhancedToteSelection")){this._bsController._stakeEntryType!=this._bsController._stakeEntryTypes.deviceKeyBoard&&this._bsController._stakeEntryHander._isShowing&&this._bsController._stakeEntryHander.hide();i._bsController._enhancedBetSlipToteSelector?i._bsController._enhancedBetSlipToteSelector._enabled&&i._bsController._enhancedBetSlipToteSelector.showPopUpMenu(n):(i._bsController._enhancedBetSlipToteSelector=new b365.Ui.Betslip.EnhancedBetSlipToteSelector(i._bsController),i._bsController._enhancedBetSlipToteSelector.enablePopUps(),i._bsController._enhancedBetSlipToteSelector.showPopUpMenu(n));n.stopPropagation();n.preventDefault();return}if(t.hasClass(".EnhancedIfBetSelection")){this._bsController._stakeEntryType!=this._bsController._stakeEntryTypes.deviceKeyBoard&&this._bsController._stakeEntryHander._isShowing&&this._bsController._stakeEntryHander.hide();i._bsController._enhancedIfBetSelector?i._bsController._enhancedIfBetSelector._enabled&&i._bsController._enhancedIfBetSelector.showPopUpMenu(n):(i._bsController._enhancedIfBetSelector=new b365.Ui.Betslip.EnhancedBetSlipIfBetSelector(i._bsController),i._bsController._enhancedIfBetSelector.enablePopUps(),i._bsController._enhancedIfBetSelector.showPopUpMenu(n));n.stopPropagation();n.preventDefault();return}if(t.hasClass(".EnhancedTeaserSelection")){this._bsController._stakeEntryType!=this._bsController._stakeEntryTypes.deviceKeyBoard&&this._bsController._stakeEntryHander._isShowing&&this._bsController._stakeEntryHander.hide();i._bsController._enhancedTeaserSelector?i._bsController._enhancedTeaserSelector._enabled&&i._bsController._enhancedTeaserSelector.showPopUpMenu(n):(i._bsController._enhancedTeaserSelector=new b365.Ui.Betslip.EnhancedBetSlipTeaserSelector(i._bsController),i._bsController._enhancedTeaserSelector.enablePopUps(),i._bsController._enhancedTeaserSelector.showPopUpMenu(n));n.stopPropagation();n.preventDefault();return}if(t.prop("disabled")||t.parents().prop("disabled"))r=!0;else if((this._bsInst._pollReqType===this._bsInst.reqTypePollTempBetReceipt&&!i._bsController.IsItalianDomain||i._bsController.IsItalianDomain&&this._bsInst._pollReqType===this._bsInst.reqTypePollReferredBet)&&this._bsInst.resetPoll(),c=new b365.Ui.Betslip.ItemInformation(u),s=c.itemIndexAndType(),l=c.itemElement(),$(l).hasClass("suspended")&&!t.hasClass("remove"))r=!0;else if(t.hasClass("removeAll")||t.parents().hasClass("removeAll"))t.parents().hasClass("removeAll")&&(u=t[0].parentNode),this._bsController.clientEnhancedMode()?(h=$("#stakePad"),o=$('li[class*="multiple-section"], li[class*="single-section"], li[class*="cast-section"]',"#bsDiv"),o=o.filter(function(){return this.style.display!=="none"}),o.length>0?h.length>0?(this._bsController._enhancedBetSlipAnimations.removeAllBets(o,!0,h,this.removeAllBetsCallBack,[u],this),r=!0):(this._bsController._enhancedBetSlipAnimations.removeAllBets(o,!1,null,this.removeAllBetsCallBack,[u],this),r=!0):(new b365.Ui.Betslip.RemoveAllItemsRequestDespatcher(i._bsInst,i._bsController).despatch(u),r=!0)):(new b365.Ui.Betslip.RemoveAllItemsRequestDespatcher(i._bsInst,i._bsController).despatch(u),r=!0);else if(t.hasClass("abetslipRecBtn")||t.parent().hasClass("abetslipRecBtn")||t.hasClass("betConfirmCloseIcon")||t.parent().hasClass("betConfirmCloseIcon"))this._bsInst.clearBets(!1),r=this._bsController.clientContinueDelegate();else if(t.hasClass("rctrs"))i._bsInst.signupModel&&i._bsInst.signupModel.subscribe(),new b365.Ui.Betslip.RetainSelectionsRequestDespatcher(this._bsInst,i._bsController).despatch(u),r=!0;else if(t.hasClass("ebet"))new b365.Ui.Betslip.EditSelectionsRequestDespatcher(this._bsInst).despatch(u),r=!0;else if(t.hasClass("acceptChanges")||t.parent().hasClass("acceptChanges"))e=t.hasClass("acceptChanges")?t:t.parent(),e.hasClass("bbPricefetch")?($(".updatingOdds","#bsDiv").removeClass("hidden"),e.addClass("hidden"),r=!0):(new b365.Ui.Betslip.AcceptChangesRequestDespatcher(this._bsInst,this._bsController).despatch(u),r=!0);else if(t.hasClass("mlthd")||t.hasClass("mbHeader"))new b365.Ui.Betslip.ToggleMultiples(this._bsInst,this._bsController).toggle(),r=!0;else if(t.hasClass("ctcMessageContainer")||t.hasClass("ctcMessage")||t.hasClass("ctcQuestionmark"))$(".ctcMessageDetails").toggle(),r=!0;else if(t.hasClass("placeBet")||t.parent().hasClass("placeBet")||t.parent().parent().hasClass("placeBet"))u=t.hasClass("placeBet")?u:t.parent().parent().hasClass("placeBet")?t.parent().parent()[0]:t.parent()[0],e=$(u),e.hasClass("bbPricefetch")?($(".updatingOdds","#bsDiv").removeClass("hidden"),e.addClass("hidden"),r=!0):(i._bsController._stakeEntryType==i._bsController._stakeEntryTypes.deviceKeyBoard&&document.activeElement.blur(),new b365.Ui.Betslip.PlaceBetClickHandler(this._bsInst,this._bsController).handle(u),r=!0);else if(t.hasClass("btnSpeaker")||t.parent().hasClass("btnSpeaker")||t.parent().parent().hasClass("btnSpeaker"))u=t.hasClass("placeBet")?u:t.parent().parent().hasClass("placeBet")?t.parent().parent()[0]:t.parent()[0],f=this._bsInst.getClickToCallHandler(),f&&f.toggleSpeakerPhone(u),r=!0;else if(t.hasClass("placeCTCBet")||t.parent().hasClass("placeCTCBet")||t.parent().parent().hasClass("placeCTCBet")){u=t.hasClass("placeBet")?u:t.parent().parent().hasClass("placeBet")?t.parent().parent()[0]:t.parent()[0];var f=this._bsInst.getClickToCallHandler(),a=this._bsController&&this._bsController.betCallEnabled(),v=this._bsController&&this._bsController.betCallTwilioEnabled();f||(a&&(f=new b365.Ui.Betslip.BetCallHandler(this._bsInst,this._bsController,v)),this._bsInst.setClickToCallHandler(f));f.handleClick(u);r=!0}else t.hasClass("rptStake")?(new b365.Ui.Betslip.RepeatStakeClickHandler(this._bsInst,this._bsController,s[0],s[1],l).handle(n),r=!0):t.hasClass("sngbrk")||t.parents().hasClass("sngbrk")?(new b365.Ui.Betslip.SingleBreakdownRequestDespatcher(this._bsInst,this._bsController).despatch(s[0]),r=!0):t.hasClass("mltbrk")||t.parents().hasClass("mltbrk")||t.hasClass("bs-BetName")?(new b365.Ui.Betslip.MultiBreakdownRequestDespatcher(this._bsInst,this._bsController).despatch(s[0]),r=!0):t.hasClass("cstBrkDwn")||t.parents().hasClass("mltbrk")?(new b365.Ui.Betslip.CastBreakdownRequestDespatcher(this._bsInst).despatch(s[0]),r=!0):t.hasClass("banker")&&u.tagName.toLowerCase()=="button"||t.hasClass("bankerIndicatorWrapper")?$("#bsDiv").hasClass("receipt")||(new b365.Ui.Betslip.BankerToggleRequestDespatcher(this._bsInst,this._bsController).despatch(n),r=!0):t.hasClass("sngPD")?(new b365.Ui.Betslip.PitcherDetailsRequestDespatcher(this._bsInst).despatch(n),r=!0):t.attr("id")=="bsjn"?(this._bsController.joinNow(),r=!0):t.hasClass("minusIcon")||t.hasClass("plusIcon")?(new b365.Ui.Betslip.StakeChangedHandler(this._bsInst).handle(t.siblings(".stk").get(0)),r=!0):t.hasClass("ausHelp")?(this._bsController._ausToteToolTipHtmlBuilder||(this._bsController._ausToteToolTipHtmlBuilder=new b365.Ui.Betslip.AusToteToolTipHtmlBuilder(this._bsController)),this._bsController._ausToteToolTipHtmlBuilder.showInfo(u)):(t.hasClass("bs-CheckBoxFreeBet")||t.hasClass("bs-CheckBoxFreeBetWrapper")||t.hasClass("bs-useFreeBetAmount")||t.hasClass("bs-useFreeBetInfo"))&&(new b365.Ui.Betslip.ToggleBetCredits(this._bsInst,this._bsController).toggle(),r=!0);r?(n.preventDefault(),n.stopPropagation()):this._bsController._stakeEntryType==this._bsController._stakeEntryTypes.stakePad&&this._bsController._stakeEntryHander._isShowing&&(n.target.parentNode.id.toLowerCase().indexOf("stakepad")==-1&&this._bsController._stakeEntryHander.hide(),n.stopPropagation(),n.preventDefault())}},removeAllBetsCallBack:function(){var t=arguments[0],n=this;new b365.Ui.Betslip.RemoveAllItemsRequestDespatcher(n._bsInst,n._bsController).despatch(t)}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.BetslipChangeHandler=function(n,t){this._bsInst=n;this._controller=t;this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._controller!="undefined"}};b365.Ui.Betslip.BetslipChangeHandler.prototype={handle:function(n){var i,t,u,r;typeof n!="undefined"&&n&&(i=!1,t=$(n.target),t.prop("disabled")||t.parents().prop("disabled")||t.parents().attr("suspended")?i=!0:(u=new b365.Ui.Betslip.ItemInformation(n.target),r=u.itemIndexAndType(),t.hasClass("bet-slip-type")?(new b365.Ui.Betslip.BetslipTypeChangeHandler(this._bsInst,this._controller).handle(n.target),i=!0):t.hasClass("mlthd")||t.hasClass("mbHeader")?(new b365.Ui.Betslip.ToggleMultiples(this._bsInst,this._controller).toggle(),i=!0):t.hasClass("teaserSel")?(new b365.Ui.Betslip.TeaserChangeHandler(this._bsInst).handle(n),i=!0):t.hasClass("ausracebettype-sel")?(new b365.Ui.Betslip.AusRaceBetTypeChangeHandler(this._bsInst,this._controller).handle(n),i=!0):t.hasClass("pitcher-sel")?(new b365.Ui.Betslip.PitcherChangeHandler(this._bsInst).handle(n),i=!0):t.hasClass("ifbetaction")?(new b365.Ui.Betslip.IfBetActionChangeHandler(this._bsInst).handle(r[0],n.target),i=!0):t.hasClass("odds")?(new b365.Ui.Betslip.OddsChangeHandler(this._bsInst,this._controller).handle(n,r[0]),i=!0):t.hasClass("aus-tote")&&(new b365.Ui.Betslip.AusToteChangeHandler(this._bsInst).handle(n,r[0],r[1]),i=!0)),i&&n.preventDefault())}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ResponsiveClickHandler=function(n,t,i,r,u,f,e){this._touchStartEvent="touchstart";this._touchMoveEvent="touchmove";this._touchEndEvent="touchend";this._isTouch="ontouchstart"in window||window.navigator.msPointerEnabled;var o=parseFloat(window.device.osVersion);(window.device&&window.device.iosDevice||window.device&&(window.device.isBlackBerry&&parseFloat(window.device.osVersion)<10||window.device.isAndroid&&o>=3.1&&o<4&&!window.device.isChrome||window.device.isWindowsPhone||window.navigator.msPointerEnabled&&!window.device.isWindowsPhone))&&(this._isTouch=!1);this._events=[];this._touchEvents=[];this._element=n;this._handler=t;this._useCapture=i;this._startX=null;this._startY=null;this._touchHoldTimer=null;this._optionalTouchStartCallBack=r;this._optionalTouchMoveCallBack=u;this._optionalTouchEndCallBack=f;this._optionalTouchHoldCallBack=e;this._isTouch?this._events.push(this.addListener(n,this._touchStartEvent,this,this._useCapture)):this._events.push(this.addListener(n,"click",this,this._useCapture))};b365.Ui.Betslip.ResponsiveClickHandler.prototype.destroy=function(){for(var n=this._events.length-1;n>=0;n-=1)this._events[n].destroy();this._events=this._touchEvents=this._element=this._handler=this.ResponsiveClickHandler=null};b365.Ui.Betslip.ResponsiveClickHandler.prototype.reset=function(){if(this._touchEvents)for(var n=this._touchEvents.length-1;n>=0;n-=1)this._touchEvents[n].destroy();this._touchEvents=[]};b365.Ui.Betslip.ResponsiveClickHandler.prototype.addListener=function(n,t,i,r){if(n.addEventListener)return n.addEventListener(t,i,r),{destroy:function(){n.removeEventListener(t,i,r)}};var u=function(){i.handleEvent(window.event,i)};return n.attachEvent("on"+t,u),{destroy:function(){n.detachEvent("on"+t,u)}}};b365.Ui.Betslip.ResponsiveClickHandler.prototype.handleEvent=function(n){switch(n.type){case this._touchStartEvent:if(n.pointerType&&(n.pointerType=="touch"||n.pointerType==2)||typeof n.pointerType=="undefined"){this.onTouchStart(n);this._optionalTouchStartCallBack&&this._optionalTouchStartCallBack(n);this._optionalTouchHoldCallBack&&this.startTouchHoldTimer(n)}break;case this._touchMoveEvent:if(n.pointerType&&(n.pointerType=="touch"||n.pointerType==2)||typeof n.pointerType=="undefined"){this.onTouchMove(n);this._optionalTouchMoveCallBack&&this._optionalTouchMoveCallBack(n);this._optionalTouchHoldCallBack&&this._touchHoldTimer&&this.stopTouchHoldTimer(n)}break;case this._touchEndEvent:this.onClick(n);this._optionalTouchEndCallBack&&this._optionalTouchEndCallBack(n);this._optionalTouchHoldCallBack&&this._touchHoldTimer&&this.stopTouchHoldTimer(n);break;case"click":this.onClick(n)}};b365.Ui.Betslip.ResponsiveClickHandler.prototype.onTouchStart=function(n){n.stopPropagation?n.stopPropagation():n.cancelBubble=!0;this._touchEvents.push(this.addListener(this._element,this._touchEndEvent,this,this._useCapture));this._touchEvents.push(this.addListener(document.body,this._touchMoveEvent,this,this._useCapture));this._startX=n.touches?n.touches[0].clientX:n.clientX;this._startY=n.touches?n.touches[0].clientY:n.clientY};b365.Ui.Betslip.ResponsiveClickHandler.prototype.onTouchMove=function(n){var t=n.touches?n.touches[0].clientX:n.clientX,i=n.touches?n.touches[0].clientY:n.clientY;(Math.abs(t-this._startX)>10||Math.abs(i-this._startY)>10)&&this.reset()};b365.Ui.Betslip.ResponsiveClickHandler.prototype.onClick=function(n){var t;return!this._handler&&n.type==this._touchEndEvent?(n.target.removeEventListener(this._touchEndEvent,this.handleEvent,this._useCapture),!1):(!this._isTouch&&device.iosDevice&&(this._optionalTouchStartCallBack&&window.setTimeout(this._optionalTouchStartCallBack,0,n),this._optionalTouchMoveCallBack&&window.setTimeout(this._optionalTouchMoveCallBack,200,n),this._optionalTouchEndCallBack&&window.setTimeout(this._optionalTouchEndCallBack,250,n)),t=this._handler.call(this._element,n),n.target.tagName==="A"&&n.target.target&&n.target.target==="_blank"||(n.stopPropagation?n.stopPropagation():n.cancelBubble=!0,n.target.className.indexOf("instantbet")===-1&&n.target.tagName!=="INPUT"&&n.preventDefault(),this.reset(),window.touchBuster&&n.type==this._touchEndEvent&&window.touchBuster.preventGhostTouch(this._startX,this._startY)),t)};b365.Ui.Betslip.ResponsiveClickHandler.prototype.startTouchHoldTimer=function(n){this._touchHoldTimer=window.setTimeout(this._optionalTouchHoldCallBack,500,n)};b365.Ui.Betslip.ResponsiveClickHandler.prototype.stopTouchHoldTimer=function(){window.clearTimeout(this._touchHoldTimer);this._touchHoldTimer=null};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.BetslipTypeChangeHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"};this._clearCasts=function(n){(n==this._bsInst.slipIF||n==this._bsInst.slipReverseIF||n==this._bsInst.slipFixedTeaser||n==this._bsInst.slipBanker)&&this._bsInst.setBetItems([],this._bsInst.betTypeCast)};this._resetStakesAndEW=function(n){var i,t;if(n==this._bsInst.slipIF||n==this._bsInst.slipReverseIF||n==this._bsInst.slipBanker||n==this._bsInst.slipFixedTeaser||n==this._bsInst.slipStandard){for(i=this._bsInst.getBetItems(this._bsInst.betTypeNormal),t=0;t<i.length;t++)i[t].setStItem("ust","0"),i[t].setStItem("st","0"),i[t].setStItem("tr","0"),i[t].setStItem("ust","0"),i[t].setStItem("ac",""),n==this._bsInst.slipBanker||i[t].getCnItem("po")||i[t].setStItem("ew","0");if(n!=this._bsInst.slipBanker)for(i=this._bsInst.getBetItems(this._bsInst.betTypeMultiple),t=0;t<i.length;t++)i[t].setStItem("ew","0")}};this._setSlipType=function(n){this._bsInst.setValueInBSCookie("bt",n);this._clearCasts(n);this._resetStakesAndEW(n);this._bsInst.updateState();(n===this._bsInst.slipStandard||n===this._bsInst.slipBanker)&&(this._bsController.complexMultiplesCombinationsInit=!0);this._bsInst.refresh(this.betTypeAll)}};b365.Ui.Betslip.BetslipTypeChangeHandler.prototype={handle:function(n){typeof n!="undefined"&&n&&this._setSlipType(n.value)}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.AusRaceBetTypeChangeHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.AusRaceBetTypeChangeHandler.prototype={handle:function(n){var o=n.target,d=new b365.Ui.Betslip.ItemInformation(o),w=d.itemIndexAndType(),t=this._bsInst.getBetItemById(w[1],w[0]),c,l,e,k,y,r,p,n;if(t){var s=o.value.split("~"),i="",f="",u="",b="",h="";for(r=0;r<s.length;r++)i=s[r],(i.indexOf("FW")>-1||i.indexOf("TW")>-1)&&(c=i.split("#"),f=c[0].substr(2,i.length),b=c[1]),(i.indexOf("FP")>-1||i.indexOf("TP")>-1)&&(l=i.split("#"),u=l[0].substr(2,i.length),h=l[1]);e=f&&u?"1":"";e?(t.setStItem("ew",e),t.setCnItem("pp",u),t.setCnItem("po",h)):(t.getStItem("ew")&&t.removeStItem("ew"),t.getCnItem("pp")&&(t.removeCnItem("pp"),t.removeCnItem("po")));var g=$("#bsDiv"),a=$('li[data-item-fpid="'+t.getCnItem("fp")+'"]',g),v=f||u;for(a&&a.length>0&&a[0].setAttribute("data-item-fpid",v),t.setCnItem("fp",v),t.setCnItem("o",b||h),i=s[0],t.setCnItem("pt",i.indexOf("TW")>-1||i.indexOf("TP")>-1?"A":"N"),k=n.target.parentElement.getAttribute("data-previousid"),y=k.split("~"),r=0;r<y.length;r++)p=y[r],previousParticipantId=p.substring(2,p.indexOf("#")),this._bsController.itemsRemoved(previousParticipantId);this._bsController.highlightSelectedBets();this._bsController.updateMultiplesEachWayFlag();this._bsInst.updateState();this._bsController.getMultipleInfo();o.parentElement.getAttribute("data-isinplay")=="True"&&(n=new ns_betslip.BetSlipEvent(ns_betslip.BetSlipEvent.PARTICIPANT_ADDED_TO_BETSLIP),f&&(n.data={Id:f},Locator.inplayEvents.dispatchEvent(n)),u&&(n.data={Id:u},Locator.inplayEvents.dispatchEvent(n)));e?(this._bsController.addToBetsBank(f),this._bsController.addToBetsBank(u)):this._bsController.addToBetsBank(v)}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.PitcherChangeHandler=function(n){this._bsInst=n;this._baseBallFixtureParticipantCookieKey="bbfp";this._isValid=function(){return typeof this._bsInst!="undefined"};this._updateCustomDropdownAttribute=function(n){$(n).parent(".betslip-select").attr("data-text",$(n).find("option:selected").text())}};b365.Ui.Betslip.PitcherChangeHandler.prototype={handle:function(n){var t=n.target,u=new b365.Ui.Betslip.ItemInformation(t),i=u.itemIndexAndType(),r=this._bsInst.getBetItemById(i[1],i[0]);r&&(r.setStItem(this._baseBallFixtureParticipantCookieKey,t.value),this._updateCustomDropdownAttribute(t),this._bsInst.updateState());t.options[0].selected?$(t).parent().parent().find("span.pitch-warn").addClass("hidden"):$(t).parent().parent().find("span.pitch-warn").removeClass("hidden")}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.TotalsCalculator=function(n,t){this._bsInst=n;this._betSlipController=t;this._freeBetHelper=new b365.Ui.Betslip.BetCreditsCalculator(n,t);this._itemToReturnDisplayHelper=new b365.Ui.Betslip.ItemToReturnDisplayHelper(t);this._ttTotalsEle=$("#bsDiv .totals");this._ttStkEle=$("#bsDiv .totals .totalStake .total, #bsDiv .placeBet .totalStake");this._totalStakeElement=$("#totalStake","#bsDiv");this._ttTrCntEle=$("#bsDiv .totals .totalReturn");this._taxWarnEle=$("#bsDiv .totals .tax-warning");this._isoCurrencyElement=$(".isocode");this._taxHeader=$("#taxWarningHeader");this._formatter=new b365.Ui.Formatter;this._isValid=function(){return typeof this._bsInst!="undefined"};this._calcTotalStake=function(n,t,i){var s=this._bsInst.getSlipType()==this._bsInst.slipBanker,h=this._betSlipController.ausMultiplesEnabled()&&!s,e=0,u,r,f,o;for(t=t?t:"st",r=0;r<n.length;r++)u=n[r].getStItem(t),u=u&&Number(u)||"",f=n[r].getStItem("ew")=="1",isNaN(u)===!1&&(u=Math.round(u*100),o=Number(n[r].getCnItem("bc")?n[r].getCnItem("bc"):n[r].getStItem("bc")?n[r].getStItem("bc"):"1"),o>1||f?(h&&this._bsInst.getSlipType()==this._bsInst.slipStandard&&n[r].getCnItem("pt")==undefined&&(f=!1),e+=Number(String(u*(f?2:1)*o))):e+=u);return $blib.pad2DP(String(e/100),i)};this._updateIfReverseIfTotals=function(n){var i=bs.getBetItems(bs.betTypeNormal),r=i[0].getStItem("st"),u=0,t=0;i.length>0&&typeof r!="undefined"&&(u=$blib.roundDecimal(String(Number(r)*(bs.getSlipType()==bs.slipReverseIF?2:1))));(bs.getSlipType()==bs.slipIF||bs.getSlipType()==bs.slipReverseIF)&&this._setTotalToWin();t=$blib.pad2DP(String(u),n);this._ttStkEle.text(t);this._totalStakeElement.text(t)};this._hideTaxHeader=function(){this._taxHeader.addClass("hidden")};this._showTaxHeader=function(){this._taxHeader.removeClass("hidden")};this._setTotalToWin=function(){var n={},t;this._initParams(n);this._totalSingleItems(n);this._totalBetBuilderItems(n);n.someSp||this._totalCastItems(n);!(n.numStakes>0)||n.someSp||n.someEW||n.someRelated&&n.numStakes>1?this._hideTaxHeader():(t=this._bsInst.getSlipType()==this._bsInst.slipReverseIF?n.totTw*2:n.totTw,t=parseFloat(Math.floor(t*100+1e-6)/100),this._betSlipController&&this._betSlipController._currencyDisplayHelper?this._ttTrCntEle.find(".total").html(this._betSlipController._currencyDisplayHelper.formatCurrency(this._formatter.roundDecimal(String(t)))):this._ttTrCntEle.find(".total").html(this._formatter.roundDecimal(String(t))),this._showTaxHeader());this._hasMultiplesWithStake()&&this._showTaxHeader()};this._setTotalToReturn=function(){var e=$("#bsDiv .bs-TotalToReturn_TextValue")[0],n,r,t,u,i,o,f;if(e&&(n={},this._initParams(n),r=this._bsInst.getSlipType()==this._bsInst.slipBanker,n.ausMultiplesEnabled=this._betSlipController.ausMultiplesEnabled()&&!r,r&&$(e.parentElement).addClass("hidden"),this._totalSingleItems(n),this._totalBetBuilderItems(n),n.someSp||this._totalCastItems(n),(!n.ausMultiplesEnabled||n.ausMultiplesInvalid||n.someRelated)&&(t=$('#bsDiv .multiple-section [data-item-type="multiple"]'),u=0,t&&t.length>0)))for(u=t.length,i=r?0:1,i;i<u;i++)o=$(t[i]).find(".stk")[0],f=$(t[i]).find(".bs-StandardMultipleStake_ToReturn")[0],f&&f.setAttribute("style","display:none;")};this._initParams=function(n){n.numStakes=0;n.totTw=0;n.totalToReturn=0;n.someSp=!1;n.someEW=!1;n.someRelated=!1;n.totStk=isNaN(this._ttStkEle.text())?0:Number(this._ttStkEle.text());n.eachWayArray=[];n.ausMultiplesEnabled=!1;n.ausMultiplesInvalid=!1;n.singlesCount=0};this._totalSingleItems=function(n){var y=this._bsInst.getSlipType()==this._bsInst.slipBanker,h,v;n.ausMultiplesEnabled=this._betSlipController.ausMultiplesEnabled()&&!y;for(var c=new b365.Ui.Betslip.TaxCalculator(this._bsInst),l=0,i=this._bsInst.getBetItems(this._bsInst.betTypeNormal),r,u,o,s,e,a,t=0,f=i.length;t<f;t++)r=$blib.getItemOdds(this._bsInst.ItemTypeNormal,i[t]),s=r==""||r=="0"||r=="0/0"||i[t].getStItem("sp")=="1",s&&(n.hasSp=!0,n.ausMultiplesInvalid=!0),e=i[t].getStItem("ew")=="1",a=i[t].getCnItem("po")!=undefined,n.singlesCount++,(e||a)&&(n.singlesCount++,n.eachWayArray.push([(t+1).toString()])),u=i[t].getStItem("st"),u&&parseFloat(u)!=NaN&&parseFloat(u)>0&&(o=s,n.someSp=n.someSp||o,n.someEW=n.someEW||e,n.numStakes++,(this._bsInst.getSlipType()==this._bsInst.slipIF||this._bsInst.getSlipType()==this._bsInst.slipReverseIF)&&n.numStakes==1&&(n.totStk=Number(u))),n.someRelated||(n.someRelated=$('#bsDiv li[data-item-id="'+t+'"][data-item-type="single"]').hasClass("restrictedCong")),o||e&&!n.ausMultiplesEnabled||(u=$.isNumeric(u)?Number(u):0,c._isFreeBet=i[t].getStItem("ft"),l=this._totalSlipItem(c,t,u,r),h=$blib.pad2DP(String(l)),n.ausMultiplesEnabled||(this._itemToReturnDisplayHelper.setReturnValue(t,"single",h),this._itemToReturnDisplayHelper.setVisibility(t,"single",!0)),n.totTw+=Number(h)),n.totalToReturn=n.totTw;for(t=0,f=i.length;t<f;t++)r=$blib.getItemOdds(this._bsInst.ItemTypeNormal,i[t]),v=r==""||r=="0"||r=="0/0"||i[t].getStItem("sp")=="1",v?this._itemToReturnDisplayHelper.setVisibility(t,"single",!1):this._itemToReturnDisplayHelper.setVisibility(t,"single",!0)};this._totalBetBuilderItems=function(n){var r=this._bsInst.getBetItems(this._bsInst.betTypeBetBuilder),t,o,s,i,f,h,u,c,e;if(r&&r.length)for(f=new b365.Ui.Betslip.TaxCalculator(this._bsInst),t=0,o=r.length;t<o;t++)u=r[t],s=$blib.getItemOdds(this._bsInst.itemTypeBetBuilder,u),i=u.getStItem("st"),i=i&&parseFloat(i)||null,h=u.getStItem("ft"),f._isFreeBet=h,c=this._totalSlipItem(f,t,i,s),e=$blib.pad2DP(String(c)),this._itemToReturnDisplayHelper.setReturnValue(t,"betbuilder",e),n.totTw+=Number(e)};this._totalSlipItem=function(n,t,i,r){var u=n.calcReturnsByLine(i,r);switch(this._bsInst.getSlipType()){case this._bsInst.slipReverseIF:case this._bsInst.slipIF:t!==0&&(u=this._formatter.roundFixed(u,2)-this._formatter.roundFixed(i,2))}return u};this._totalCastItems=function(n){for(var o=new b365.Ui.Betslip.TaxCalculator(this._bsInst),r=this._bsInst.getBetItems(this._bsInst.betTypeCast),i,u,e,t=0,f=r.length;t<f&&!n.someSp;t++)i=$blib.getItemOdds(this._bsInst.betTypeCast,r[t]),o._isFreeBet=r[t].getStItem("ft"),u=r[t].getStItem("st"),u&&parseFloat(u)!=NaN&&parseFloat(u)>0&&(n.numStakes++,n.someSp=n.someSp||i==""||i=="0"||i=="0/0"||r[t].getStItem("sp")=="1",n.someRelated||(n.someRelated=$('#bsDiv li[data-item-id="'+t+'"][data-item-type="cast"]').hasClass("restrictedCong"))),n.someSp||(e=o.calcReturnsByLine(u,i),this._itemToReturnDisplayHelper.setReturnValue(t,"cast",$blib.pad2DP(String(e))),n.totTw+=e,n.totalToReturn+=Number(e));for(t=0,f=r.length;t<f;t++)i=$blib.getItemOdds(this._bsInst.betTypeCast,r[t]),n.someSp=i==""||i=="0"||i=="0/0"||r[t].getStItem("sp")=="1",n.someSp?this._itemToReturnDisplayHelper.setVisibility(t,"cast",!1):this._itemToReturnDisplayHelper.setVisibility(t,"cast",!0)};this._hasMultiplesWithStake=function(){for(var r=this._bsInst.getBetItems(this._bsInst.itemTypeMultiple),i=!1,t,n=0;n<r.length&&!i;n++)t=r[n].getStItem("st"),t&&parseFloat(t)!=NaN&&parseFloat(t)>0&&(i=!0);return i}};b365.Ui.Betslip.TotalsCalculator.prototype={calculate:function(){var t,n,u,f;if(this._isValid()){t=window.sProps.balance.currencyDecimalSeparator||this._ttStkEle.parents(".betReceipt:first").data("num-dec-sep");n=0;switch(this._bsInst.getSlipType()){case this._bsInst.slipReverseIF:case this._bsInst.slipIF:this._updateIfReverseIfTotals(t);break;case this._bsInst.slipBanker:this._betSlipController&&this._betSlipController._currencyDisplayHelper?(n=this._betSlipController._currencyDisplayHelper.formatCurrency(this._calcTotalStake(this._bsInst.getBetItems(this._bsInst.betTypeMultiple),undefined,t)),this._ttStkEle.text(n),this._totalStakeElement.text(n)):(this._ttStkEle.text(this._calcTotalStake(this._bsInst.getBetItems(this._bsInst.betTypeMultiple),undefined,t)),this._ttStkEle.text(n),this._totalStakeElement.text(n));this._setTotalToReturn();break;default:if(this._betSlipController&&this._betSlipController._currencyDisplayHelper)if(betItems=this._bsInst.getBetItems(this._bsInst.betTypeAll),betItems&&betItems.length)u=this._calcTotalStake(betItems),n=this._betSlipController._currencyDisplayHelper.formatCurrency(u,undefined,t),this._ttStkEle.text(n),this._totalStakeElement.text(n);else{var r=$(".tempbetstatus_title.accepted"),e=r.parents("li[data-item-type='single']").find(".stake>span:nth-child(2)"),o=r.parents("li[data-item-type='cast']").find(".stake>span:nth-child(1)"),s=r.parents("li[data-item-type='multiple']").find(".stake"),i=0;e.each(function(n,r){i+=+$(r).text().replace(t,".")});o.each(function(n,r){i+=+$(r).text().replace(t,".")});s.each(function(n,r){i+=+$(r).text().replace(/\w*/,"").replace(t,".")});n=i.toFixed(2).replace(".",t);this._ttStkEle.text(n);this._totalStakeElement.text(n)}else n=this._calcTotalStake(this._bsInst.getBetItems(this._bsInst.betTypeAll),undefined,t),this._ttStkEle.text(n),this._totalStakeElement.text(n);this._setTotalToWin();f=this._bsInst.getSlipType()==this._bsInst.slipBanker;(this._bsInst.getValueFromBSCookie("fs").replace("||","")==1||document.getElementsByClassName("bs-FreeBetCheckBox-selected").length>0||document.getElementsByClassName("br-UsingFreeBet").length>0||document.getElementsByClassName("fbt-FreeBetToken_Redeemed").length>0||document.getElementsByClassName("bs-MultipleBets_HighestAccumulator").length>0||document.getElementsByClassName("bs-EachWayCheckbox").length>0||this._betSlipController.ausMultiplesEnabled()&&!f)&&(this._freeBetHelper.calculate(),this._betSlipController._currencyDisplayHelper&&(n=this._betSlipController._currencyDisplayHelper.formatCurrency(this._calcTotalStake(this._bsInst.getBetItems(this._bsInst.betTypeAll),undefined,t))),document.getElementById("bstsx")&&(document.getElementById("bstsx").innerHTML=n),this._ttStkEle.text(n),this._totalStakeElement.text(n));this._setTotalToReturn()}this._bsInst.contentChangedOnClient()}},getFreeBetItem:function(){for(var t=this._bsInst.getBetItems()||[],n=0,i=t.length;n<i;n++)if(t[n].getStItem("ft"))return t[n];return null}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.MultipleStakeChangedHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.MultipleStakeChangedHandler.prototype={handle:function(n,t){var i,r;n>=0&&(i=this._bsInst.getBetItemById(this._bsInst.itemTypeMultiple,n),i&&($blib.isDecimal(t.value)==!0?(r=$blib.to2DP(t.value),Number(r)>$blib.getMaxStake()&&(t.value=String($blib.getMaxStake()))):t.value="",i.setStItem("st",t.value),i.setStItem("ust",t.value),this._bsController.updateMultiplesEachWayFlag(),this._bsInst.updateState()))}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.SingleStakeChangedHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.SingleStakeChangedHandler.prototype={updateAllStakes:function(n,t){var f=n,r=$('#bsDiv li[data-item-type="single"] .stake .stk'),u="",o=new b365.Ui.Betslip.ToReturnCalculator(this._bsInst),i,e;for(this._bsController&&this._bsController._currencyDisplayHelper&&(f=this._bsController._currencyDisplayHelper.unformatCurrency(n)),n!=""&&(u=$blib.pad2DP(String(f)),this._bsController.IsItalianDomain()&&(u=Math.floor(Number(f))),this._bsController._currencyDisplayHelper&&(u=this._bsController._currencyDisplayHelper.formatCurrency(u))),i=t,e=r.length;i<e;i++)r[i].className.indexOf("bs-FreeBet-disabled")>-1||($(r[i]).val(u),this._bsInst.getBetItems(this._bsInst.itemTypeSingle)[i].setStItem("st",f),o.calculate(i,this._bsInst.itemTypeSingle,r[i]),this._bsController.getPushMarketsEnabled()&&new b365.Ui.Betslip.StakeEntryRules(this._bsController).PushBetDisplayUpdate(i,this._bsInst.itemTypeSingle,r[i]))},handle:function(n,t,i){var a=document.getElementById("bsDiv"),e,o,r,u,h,c,s,f,l;if(this._isValid()){$("#mltsngstk").val("");switch(this._bsInst.getSlipType()){case this._bsInst.slipIF:new b365.Ui.Betslip.IFBetStakeChangedHandler(this._bsInst,this._bsController).handle(n,i);break;case this._bsInst.slipReverseIF:new b365.Ui.Betslip.ReverseIfBetStakeChangedHandler(this._bsInst,this._bsController).handle(n,i);break;default:new b365.Ui.Betslip.ToReturnCalculator(this._bsInst).calculate(n,t,i);this._bsController.getPushMarketsEnabled()&&new b365.Ui.Betslip.StakeEntryRules(this._bsController).PushBetDisplayUpdate(n,t,i)}if(this._bsController.getPushMarketsEnabled()&&(e=a.getElementsByClassName("single-section"),e.length>0))for(o=e[0].getElementsByTagName("li"),f=0,l=o.length;f<l;f++)r=o[f],h=r.getAttribute("data-item-push"),h>0&&(c=r.getAttribute("data-item-id"),u=r.getElementsByClassName("stk")[0],u.length>0&&(s=u.value),!isNaN(s)&&s>0&&new b365.Ui.Betslip.StakeEntryRules(scope._bsController).PushBetDisplayUpdate(c,scope._bsInst.itemTypeSingle,u));new b365.Ui.Betslip.RepeatStakeVisibilitySetter(this._bsInst).set(n,i)}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.CastStakeChangedHandler=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.CastStakeChangedHandler.prototype={handle:function(n,t,i){var f,r,u,e;this._isValid()&&(f=new b365.Ui.Formatter,r=this._bsInst.getBetItemById(t,n),i.value=$blib.isDecimal(i.value)?f.roundValue(i.value):"",r.setStItem("st",i.value),u=parseInt(r.getStItem("bc"),10),!isNaN(u)&&u>1&&(e=new b365.Ui.Betslip.ItemInformation(i).itemElement,$(".totestkbc",e).text(f.roundDecimal(Number(i.value)*u)),r.setStItem("gst",i.value),r.setStItem("gust",i.value)),this._bsInst.updateState());new b365.Ui.Betslip.ToReturnCalculator(this._bsInst).calculate(n,t,i);new b365.Ui.Betslip.RepeatStakeVisibilitySetter(this._bsInst).set(n,i)}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.CastFlexiChangedHandler=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.CastFlexiChangedHandler.prototype={handle:function(n,t,i){var l,f,h,u,r;if(this._isValid()){if(l=new b365.Ui.Formatter,f=this._bsInst.getBetItemById(t,n),i.value=$blib.isDecimal(i.value)?l.roundValue(i.value):"",h=i.parentNode.parentNode.parentNode.getElementsByClassName("bs-FlexiUnitStake_TextBox")[0],u=parseInt(f.getStItem("bc"),10),!isNaN(u)&&u>1){var e,o=i.parentNode.parentNode.parentNode.getElementsByClassName("bs-FlexiUnitStake_TextBox")[0],s=i.parentNode.parentNode.parentNode.getElementsByClassName("bs-FlexiPercentage_TextBox")[0],c=i.parentNode.parentNode.parentNode.getElementsByClassName("bs-FlexiTotalStake_TextBox")[0];i.className.indexOf("UnitStake")>-1?(r=ns_betcalculationslib_calculations_cast.BetSlipFlexiCast.GetFlexiValuesFromUnitStake(o.value,u),c.value=r.totalStake,s.value=r.flexiPercentage):i.className.indexOf("Percentage")>-1?(r=ns_betcalculationslib_calculations_cast.BetSlipFlexiCast.GetFlexiValuesFromPercentage(s.value,u),o.value=r.unitStake,s.value=r.flexiPercentage,c.value=r.totalStake):(r=ns_betcalculationslib_calculations_cast.BetSlipFlexiCast.GetFlexiValuesFromTotalStake(c.value,u),o.value=r.unitStake,s.value=r.flexiPercentage);e=o;f.setStItem("st",e.value);f.setStItem("gst",e.value);f.setStItem("gust",e.value)}this._bsInst.updateState()}new b365.Ui.Betslip.ToReturnCalculator(this._bsInst).calculate(n,t,h);new b365.Ui.Betslip.RepeatStakeVisibilitySetter(this._bsInst).set(n,h)}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.IFBetStakeChangedHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"};this._setMaxStake=function(n,t){if(t>0){var i=this._bsInst.getBetItemById(this._bsInst.itemTypeSingle,t-1),r=i.getStItem("st")?$blib.roundValue(i.getStItem("st")):0;if(Number(r)<Number(n))return r}return n}};b365.Ui.Betslip.IFBetStakeChangedHandler.prototype={handle:function(n,t){var f,i,r,u,e;this._isValid()&&(f=this._bsInst.getBetItemById(this._bsInst.itemTypeSingle,n),i=t.value,this._bsController&&this._bsController._currencyDisplayHelper&&i&&i!=""&&(i=this._bsController._currencyDisplayHelper.unformatCurrency(i)),$blib.isDecimal(i)==!1&&(t.value="",i=""),r=$blib.roundValue(i),u=this._setMaxStake(r,n),Number(u)<Number(r)&&(t.value=this._bsController._currencyDisplayHelper?this._bsController._currencyDisplayHelper.formatCurrency(u):u,r=u),new b365.Ui.Betslip.ToReturnCalculator(this._bsInst).calculate(n,this._bsInst.itemTypeSingle,t),e=r?$blib.pad2DP(r,this._bsController.getCurrencyObject().decimalSeparator):r,f.setStItem("st",e),f.setStItem("ust",e),new b365.Ui.Betslip.SingleStakeChangedHandler(this._bsInst,this._bsController).updateAllStakes("",Number(n)+1),this._bsInst.updateState())}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ReverseIfBetStakeChangedHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"};this._setMaxStake=function(n,t){if(t>0){var i=this._bsInst.getBetItemById(this._bsInst.itemTypeSingle,t-1),r=i.getStItem("st")?$blib.roundValue(i.getStItem("st")):0;return r<n?r:n}}};b365.Ui.Betslip.ReverseIfBetStakeChangedHandler.prototype={handle:function(n,t){var i,u,r;if(this._isValid()){for(i=t.value,this._bsController._currencyDisplayHelper&&i&&i!=""&&(i=this._bsController._currencyDisplayHelper.unformatCurrency(i)),$blib.isDecimal(i)==!1&&(t.value="",i=""),u=this._bsInst.getBetItems(this._bsInst.itemTypeSingle),r=0;r<u.length;r++)u[r].setStItem("st",i),u[r].setStItem("ust",i);this._bsInst.updateState()}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.StakeChangedHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.StakeChangedHandler.prototype={handle:function(n){if(this._isValid()){var i=new b365.Ui.Betslip.ItemInformation(n),t=i.itemIndexAndType(),u=i.itemElement(),r;if(i._parent[0].className.indexOf("suspended")>-1)return;switch(t[1]){case"single":new b365.Ui.Betslip.SingleStakeChangedHandler(this._bsInst,this._bsController).handle(t[0],t[1],n);break;case"tote-single":case"tote-cast":case"tote-pot":new b365.Ui.Betslip.ToteStakeChangedHandler(this._bsInst).handle(n);break;case"cast":n.className.indexOf("flexi")>-1?new b365.Ui.Betslip.CastFlexiChangedHandler(this._bsInst).handle(t[0],t[1],n):new b365.Ui.Betslip.CastStakeChangedHandler(this._bsInst).handle(t[0],t[1],n);break;case"multiple":t[0]!="-1"?new b365.Ui.Betslip.MultipleStakeChangedHandler(this._bsInst,this._bsController).handle(t[0],n):new b365.Ui.Betslip.SingleStakeChangedHandler(this._bsInst,this._bsController).updateAllStakes(n.value,0);break;case"betbuilder":new b365.Ui.Betslip.ToReturnCalculator(this._bsInst).calculate(t[0],this._bsInst.betTypeBetBuilder,n)}new b365.Ui.Betslip.TotalsCalculator(this._bsInst,this._bsController).calculate();this._bsInst.placebetBtnDisabledForSpanishStakeLimit&&(r=$(".placeBet.abetslipBtn","#bsDiv"),r&&r.removeClass("disabled abetslipgreyBtn"),this._bsInst.placebetBtnDisabledForSpanishStakeLimit=!1)}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ToReturnCalculator=function(n){this._bsInst=n;this._eachWayCookieKey="ew";this._taxRates=$("#bsDiv>ul").attr("data-txr");this._taxCalculationMethod=$("#bsDiv>ul").attr("data-tcm");this._WinRateIndex=3;this._ReturnRateIndex=4;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.ToReturnCalculator.prototype={calculate:function(n,t,i,r,u){var b,f,e,p,h,c,v,s,l,a,w;if(n>=0){if(b=new b365.Ui.Formatter,f=this._bsInst.getBetItems(t)[n],!f)return;var k=f.getStItem(this._eachWayCookieKey)=="1"?!0:!1,d=$blib.getMaxToWin(),o=$blib.getItemOdds(t,f),g=o==""||o=="0/0"||o=="0.0"||o=="0"||f.getStItem("sp")=="1",y=i?i.value:r;$blib.isDecimal(y)==!0?(e=$blib.to2DP(y),p=$blib.to2DP(u||""),Number(e)>$blib.getMaxStake()&&(e=String($blib.getMaxStake())),f.setStItem("st",e),f.setStItem("ust",e),f.setStItem("fb",p),h=new b365.Ui.Betslip.TaxCalculator(this._bsInst),h._isFreeBet=f.getStItem("ft"),c=h.calcReturnsByLine(Number(e),o),s=f.getCnItem("po"),s&&s.length?v=!0:f.getStItem("ew")=="1"&&(l=$('li[data-item-id="'+n+'"]').find(".placedivider"),l&&l.length&&(a=Number(l[0].getAttribute("data-place-divider")),a&&a>0&&(s=ns_betcalculationslib_util.OddsFormatter.GetFractionalPlaceOdds(o,a),v=!0))),v&&(w=h.calcReturnsByLine(Number(e),s),c=(Number(c)+Number(w)).toString()),f.setStItem("tr",c)):(i&&(i.value=""),f.setStItem("st",""),f.setStItem("tr",""));this._bsInst.updateState()}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.stakeLimitChangedHandler=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.stakeLimitChangedHandler.prototype={addStakeLimit:function(n,t,i){if(n>=0){var r=this._bsInst.getBetItems(t)[n];i&&$blib.isDecimal(i)===!0?r.setStItem("sl",$blib.to2DP(i)):r.setStItem("sl","");this._bsInst.updateState()}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ToolTipHtmlBuilder=function(n){this._ele=n;this._isValid=function(){return typeof this._ele!="undefined"}};b365.Ui.Betslip.ToolTipHtmlBuilder.prototype={getHtml:function(){var t="",i=$(this._ele).parents("[data-tooltip]:first"),n,r,u;if(i.length==1)if(i=$(i[0]),n=i.attr("data-tooltip").split("|"),$(this._ele).hasClass("ausHelp"))t=(new b365.Ui.Betslip.AusToteToolTipHtmlBuilder).getHtml(n[0]);else{r=i.parents("[data-item-id]:first");u=r.attr("data-item-type");switch(u){case"single":t=(new b365.Ui.Betslip.SingleToolTipHtmlBuilder).getHtml(r,n);break;case"tote-single":t=(new b365.Ui.Betslip.ToteSingleToolTipHtmlBuilder).getHtml(n);break;case"tote-cast":t=(new b365.Ui.Betslip.ToteCastToolTipHtmlBuilder).getHtml(this._ele,n);break;case"tote-pot":t=(new b365.Ui.Betslip.TotePotToolTipHtmlBuilder).getHtml(n);break;case"cast":t=$(this._ele).parents().hasClass("toteLeg")?(new b365.Ui.Betslip.TotePotToolTipHtmlBuilder).getHtml(n):(new b365.Ui.Betslip.CastToolTipHtmlBuilder).getHtml(r,n)}}return t}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.StakeToolTipHtmlBuilder=function(n){this._ele=n;this._isValid=function(){return typeof this._ele!="undefined"}};b365.Ui.Betslip.StakeToolTipHtmlBuilder.prototype={getStakeHtml:function(n,t){var r="",i=$(this._ele).parents("[data-tooltip]:first"),t;return i.length==1&&(i=$(i[0]),t=i.attr("data-tooltip"),r="<label class='ttHead'>"+t+"<\/label><br />"),r}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.PlaceBetClickHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.PlaceBetClickHandler.prototype={handle:function(n){var o,s,t,f,h,r,e,u,i;if(this._isValid()&&(o=new b365.Ui.Betslip.Validation.PlaceBetValidator(this._bsInst,this._bsController),$ele=$(n),window.device&&window.device.isWindowsPhone&&this._bsController._stakeEntryHander&&(this._bsController._stakeEntryHander._disableAnimation=!0,this._bsController._stakeEntryHander.hide(),this._bsController._stakeEntryHander._disableAnimation=!1),!($ele.hasClass("disabled")||$ele.hasClass("failed-min-odds"))))if(r=$ele.attr("data-atype"),r=="cnf")typeof window.MyBetsController!="undefined"&&window.MyBetsController.isInitialised()&&window.MyBetsController.disableButtonEvents(),this.updateStakes(),this._bsInst.confirmBets();else if(r=="cnf-ref")typeof window.MyBetsController!="undefined"&&window.MyBetsController.isInitialised()&&window.MyBetsController.disableButtonEvents(),this.updateStakes(),this._bsInst.referBets();else if(r=="clr")this._bsInst.refresh();else{if(typeof window.MyBetsController!="undefined"&&window.MyBetsController.isInitialised()&&window.MyBetsController.disableButtonEvents(),this.updateStakes(),h=$ele.hasClass("placeCTCBet"),e=[],h){for(u=this._bsInst.getBetItems("single"),i=0;i<u.length;i++)u[i].getStItem("pom")=="Y"&&e.push(i);if(e.length==u.length)return}f=o.validate();n.length>0&&(t=$(n[0].parentNode).find("#buttonContent"),t.length==0&&(t=n.find("button"),t.length>0&&(s=t[0].innerHTML,t=document.createElement("div"),t.setAttribute("id","buttonContent"),t.setAttribute("style","display:none;"),t.innerHTML=s,n[0].parentNode.appendChild(t),t=null)),f&&(n[0].innerHTML='<button><span class="buttonSpinner"><\/span><\/button>'));f&&(this._bsController.getPushMarketsEnabled()&&this._bsInst.backupPushBetPreSplitBSCookieValue(this._bsInst._betSlipCookieKey),this._bsInst.placeBets())}},updateStakes:function(){var t=$(".betslipWrapper input.stk"),n,r,i,u;if(this._bsInst.getSlipType()!=this._bsInst.slipIF&&t.length>0)for(n=0,r=t.length;n<r;n++)t[n].id!="mltsngstk"&&t[n].tagName=="INPUT"&&(t[n].type=="text"||t[n].type=="number"||t[n].type=="tel")&&(i=t[n].value?$blib.pad2DP(t[n].value,this._bsController.getCurrencyObject().decimalSeparator):t[n].value,i=i.replace(",","."),i=i.replace("..","."),i&&(u=new b365.Ui.Formatter,$blib.isDecimal(i)&&(t[n].value=u.roundValue(i))),new b365.Ui.Betslip.StakeChangedHandler(this._bsInst,this._bsController).handle(t[n]))}};Type.registerNamespace("b365.Ui.Betslip.Validation");b365.Ui.Betslip.Validation.PlaceBetValidator=function(n,t){this._bsInst=n;this._bsController=t;this._noStakeCssClass="errStk";this._isValid=function(){return typeof this._bsInst!="undefined"};this._defaultValidator=function(n){var r="",o=this,t=$("#bsDiv"),f,s,e,i=0,u;return n=n?n:$(".placeCTCBet",t).length>0,this._bsController._delegates.isAuthenticated()?n?this._bsController.betCallEnabled()||(r="INTERNAL MESSAGE: CTC DISABLED"):(u=$(".footer #totalStake",t),u.length==0&&(u=$(".footer .totalStake",t)),u.length>0&&(i=$(u[0]).text()),this._bsController&&this._bsController._currencyDisplayHelper&&(i=this._bsController._currencyDisplayHelper.unformatCurrency(i)),i=Number(i),isNaN(i)||i==0?this._bsController.clientEnhancedMode()?(this._bsController._noStakeCount=this._bsController._noStakeCount+1,f=$('li[class$="multiple-section multipleBets"]'),f.length>0?(s=$("ul:first-child",f),e=s.hasClass("open")?$('input[class*="stk"]',t):$('input[class*="stk"][id!="mltsngstk"][data-inp-type!="mltstk"]',t)):e=$('input[class*="stk"]',t),this._bsController._enhancedBetSlipAnimations.shakeStakeFields(e,t,null,[],null),this._bsController._noStakeCount>3?(r=betSlipML.pleaseenterstake,$("input:text[data-inp-type]",t).each(function(){var n=new b365.Ui.Betslip.ItemInformation($(this)).itemElement();n.addClass(o._noStakeCssClass)})):r="INTERNAL MESSAGE: NOT VALIDATED"):(this._bsController._noStakeCount=0,r=betSlipML.pleaseenterstake,$("input:text[data-inp-type]",t).each(function(){var n=new b365.Ui.Betslip.ItemInformation($(this)).itemElement();n.addClass(o._noStakeCssClass)})):this._bsController._noStakeCount=0):(r="INTERNAL MESSAGE: NOT LOGGED IN",this._bsController._noStakeCount=0),r}};b365.Ui.Betslip.Validation.PlaceBetValidator.prototype={validate:function(n){var t=this._defaultValidator(n),i;if(t=="")switch(this._bsInst.getSlipType()){case this._bsInst.slipIF:t=new b365.Ui.Betslip.Validation.IfPlaceBetValidator(this._bsInst).validate();break;case this._bsInst.slipUSTote:t=new b365.Ui.Betslip.Validation.UsTotePlaceBetValidator(this._bsInst).validate();break;case this._bsInst.slipUKTote:t=new b365.Ui.Betslip.Validation.UkTotePlaceBetValidator(this._bsInst).validate();break;case this._bsInst.slipETote:t=new b365.Ui.Betslip.Validation.ETotePlaceBetValidator(this._bsInst).validate()}if((t=="INTERNAL MESSAGE: NOT VALIDATED"||t=="")&&window.location.host.split(".").pop()=="it"&&(t=new b365.Ui.Betslip.Validation.ItalyBetValidator(this._bsInst).validate()),t!="")switch(t){case"INTERNAL MESSAGE: NOT VALIDATED":break;case"INTERNAL MESSAGE: CTC DISABLED":new b365.Ui.Betslip.MessageDisplayHandler(this._bsInst).showMsg(betSlipML.callUnsuccessful);break;case"INTERNAL MESSAGE: NOT LOGGED IN":this._bsController.clientEnhancedMode()?this._bsController._stakeEntryType==this._bsController._stakeEntryTypes.stakePad&&this._bsController._stakeEntryHander&&this._bsController._stakeEntryHander._isShowing?(i=$("#stakePad"),i.length>0?this._bsController._enhancedBetSlipAnimations.hideStakePad(i,!0,this._bsController.clientLoginDelegate,[],this._bsController):this._bsController.clientLoginDelegate()):this._bsController.clientLoginDelegate():this._bsController.clientLoginDelegate();break;default:new b365.Ui.Betslip.MessageDisplayHandler(this._bsInst).showMsg(t);this._bsInst.changeBetslipHeight()}return t==""}};Type.registerNamespace("b365.Ui.Betslip.Validation");b365.Ui.Betslip.Validation.ETotePlaceBetValidator=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.Validation.ETotePlaceBetValidator.prototype={validate:function(){var f="",n,i,s,r;if(this._isValid()){var t=!0,e=this._bsInst._betItems,u=e.length-1,o=betSlipML.etoteinvalidstake;for(n=u;n>-1&&t;n--)i=e[n].getStItem("gst"),isNaN(i)||i==""||(t=Number(i)>0?/^([1]\d+|[1-9]\d*)(\.[0-9]{1,2}?)?$/.test(i):!1);if(t){for(u=this._bsInst._betCastItems.length-1,s=this._bsInst._betCastItems,n=u;n>-1&&t;n--)r=Number(s[n].getStItem("gst")),!isNaN(r)&&Number(r)>0&&(t=/^([1]\d+|[1-9]\d*)(\.[0-9]{1,2}?)?$/.test(r));t||(o=betSlipML.exactainvalidstake)}t||(f=o)}return f}};Type.registerNamespace("b365.Ui.Betslip.Validation");b365.Ui.Betslip.Validation.IfPlaceBetValidator=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.Validation.IfPlaceBetValidator.prototype={validate:function(){var i="",t,n,r;if(this._isValid())if(t=this._bsInst.getBetItems(this._bsInst.itemTypeSingle),t.length<2)i=betSlipML.ifbetminselections;else for(n=1;n<t.length;n++)r=t[n].getStItem("st"),(isNaN(r)||Number(r)==0)&&(i=betSlipML.pleaseenterstakeorrisk,$('#bsDiv li[data-item-id="'+n+'"] input:text[data-inp-type]').addClass(this._noStakeCssClass));return i}};Type.registerNamespace("b365.Ui.Betslip.Validation");b365.Ui.Betslip.Validation.UkTotePlaceBetValidator=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.Validation.UkTotePlaceBetValidator.prototype={validate:function(){var t="",i,e,o,l,s,r,u,f;if(this._isValid()){var n=!0,c=this._bsInst._betItems,h=c.length-1;for(i=h;i>-1&&n;i--)e=c[i].getStItem("gst"),isNaN(e)||e==""||(o=Number(e),o>=2?(l=(o-Math.floor(o)).toFixed(2)*100,l%10!=0&&(n=!1)):n=!1);if(n){for(h=this._bsInst._betCastItems.length-1,s=this._bsInst._betCastItems,i=h;i>-1&&n;i--)if(r=Number(s[i].getStItem("gst")),!isNaN(r)&&Number(r)>0){u=Number(s[i].getStItem("bc"));u=isNaN(u)?1:u;f=$blib.roundDecimal(String(r*u));switch(s[i].getCnItem("cm")){case"6":n=/^2(\.00?)?$/.test(r);t=n?t:betSlipML.toteperunitstake;break;case"7":n=/^[0-9]\d*(\.(([1-9]{1}0?)|00))?$/.test(r);n&&(n=/^([1]\d+|[2-9])\d*(\.[0-9]{1}0?)?$/.test(f));t=n?t:betSlipML.totesuper7perunitstake;break;case"U":case"P":n=/^[0-9]\d*(\.[0-9]{1}0?)?$/.test($blib.roundDecimal(String(r)))&&/^[1-9]\d*(\.[0-9]{1}0?)?$/.test(f);t=n?t:betSlipML.toteinvalidstake;break;case"J":n=/^[1-9]\d*(\.[05]{1}0?)?$/.test(f);t=n?t:betSlipML.totejackpotinvalidstake;break;default:n=/^[0-9]\d*(\.(([1-9]{1}0?)|00))?$/.test(r);n&&(n=/^([1]\d+|[2-9])\d*(\.[0-9]{1}0?)?$/.test(f));t=n?t:betSlipML.minstaketote}}}else t=betSlipML.minstaketote}return t}};Type.registerNamespace("b365.Ui.Betslip.Validation");b365.Ui.Betslip.Validation.UsTotePlaceBetValidator=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.Validation.UsTotePlaceBetValidator.prototype={validate:function(){var r="",n,u,o,e;if(this._isValid()){var t=!0,i=this._bsInst._betItems,f=i.length-1;for(n=f;n>-1&&t;n--)u=i[n].getStItem("gst"),isNaN(u)||u==""||(t=this.checkstake(u));if(t)for(i=this._bsInst._betCastItems,f=i.length-1,n=f;n>-1&&t;n--)o=i[n],e=i[n].getStItem("gust"),isNaN(e)||(t=this.checkstake(e),r=t?"":r=betSlipML.ustotecastsinvalid);else r=betSlipML.ustotesinglesinvalid}return r},checkstake:function(n){var t=parseFloat(n);return t<2?!1:t%parseInt(n)==0}};Type.registerNamespace("b365.Ui.Betslip.Validation");b365.Ui.Betslip.Validation.ItalyBetValidator=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"};this._createExoticValidationPropsKey=function(n,t){return typeof n=="undefined"||typeof t=="undefined"?null:n+t};this._exoticValidationProps={I0:{minUnitStake:1,minTotalStake:2},I1:{minUnitStake:1,minTotalStake:2},I2:{minUnitStake:1,minTotalStake:2},I3:{hasProtocolLookup:!0,"89":{minUnitStake:1,minTotalStake:2},"90":{minUnitStake:.5,minTotalStake:1}},I4:{minUnitStake:.25,minTotalStake:.5},I5:{minUnitStake:.25,minTotalStake:.5}}};b365.Ui.Betslip.Validation.ItalyBetValidator.prototype={validate:function(){var o="",i,n,v,tt,c,h,it,t,f,y,l,rt,ut,p,w,d,g,ft,a,nt,s=!1,b=!1,u,k=!1,e,et,ot=null,r=null,st=!1,ht=0;if(this._isValid()){for(l=/^([1]\d+|[2-9]\d*)(\.00?)?$/,ut=/^(\d+?)(\.(25|50?|75|00?))?$/,rt=/^(\d+?)(\.(50?|00?))?$/,p=/^(\d+?)(\.(05?|10?|15|20?|25|30?|35|40?|45|50?|55|60?|65|70?|75|80?|85|90?|95|00?))?$/,i=!0,v=this._bsInst._betItems,tt=v.length-1,d=this._bsInst.getSlipType()==this._bsInst.slipBanker,t=tt;t>-1&&i;t--){n=v[t].getStItem("st");s=!1;b=!1;k=!1;et=v[t].getStItem("_tp");switch(et){case"v":s=!0;break;case"f":b=!0;break;case"t":k=!0}if(typeof n!="undefined"&&n!=""&&(n=n.replace(",","."),n=n.replace("..","."),s?(u=1,c=rt):b?(u=3,c=l):k?(u=2,c=l):Locator.pushedConfig.getIsPSQFV4Enabled()?(u=1,c=p):(u=2,c=l),!isNaN(n)&&n!=""&&n!="0"&&n!="0.00"))if(Number(n)>=u)i=c.test(Number(n));else{i=!1;break}}for(g=this._bsInst._betCastItems,ft=g.length-1,t=ft;t>-1&&i;t--)if((e=g[t],n=e.getStItem("st"),s=e.getStItem("_tp")==="v",r=this._exoticValidationProps[this._createExoticValidationPropsKey(e.getCnItem("spt"),e.getCnItem("cm"))],r&&r.hasProtocolLookup&&(ot=e.getCnItem("pr")?e.getCnItem("pr"):null,r=r[ot]||{minUnitStake:0,minTotalStake:0}),typeof n!="undefined"&&n!="")&&(n=n.replace(",","."),n=n.replace("..","."),f=Number(e.getCnItem("bc")||e.getStItem("bc")||"1"),f>0&&!d&&s?(a=Number(String(n*f)),nt=ut):r?a=n*f:(a=Number(n),nt=l),!isNaN(n)&&n!=""&&n!="0"&&n!="0.00")){if(r){if(ht=Math.max(r.minTotalStake,r.minUnitStake*f),i=n%r.minUnitStake==0&&a>=r.minTotalStake,i)continue;st=!0;break}if(Number(n)>=.25&&Number(a)>=1)i=nt.test(Number(n));else{i=!1;break}}for(h=this._bsInst._betMltItems,it=h.length-1,t=it;t>-1&&i;t--)if((n=h[t].getStItem("st"),typeof n!="undefined"&&n!="")&&(n=n.replace(",","."),n=n.replace("..","."),f=Number(h[t].getCnItem("bc")?h[t].getCnItem("bc"):h[t].getStItem("bc")?h[t].getStItem("bc"):"1"),f>1||f>0&&!d&&s?(y=Number(String(n*f)),w=p,u=1):(y=Number(n),Locator.pushedConfig.getIsPSQFV4Enabled()?(u=1,w=p):(u=2,w=l)),!isNaN(n)&&n!=""&&n!="0"&&n!="0.00"))if(Number(n)>=.05&&(Number(y)>=u||s&&Number(y)>=u))i=w.test(Number(n));else{i=!1;break}i||(k?o=betSlipML.minstakeitalyracingpools:b?o=betSlipML.minstakeitalyracing:s?o=betSlipML.minstakeitalyvirtuals:st?(o=betSlipML.minstakeitalyracingexotics.replace("{0}",String(ht).replace(".",",")),o=o.replace("{1}",String(r.minUnitStake).replace(".",","))):o=Locator.pushedConfig.getIsPSQFV4Enabled()?betSlipML.minstakeitalyv4:betSlipML.minstakeitaly)}return o}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.MessageDisplayHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.MessageDisplayHandler.prototype={showMsg:function(n,t){var i;this._isValid()&&(typeof t=="undefined"&&(t="alert"),i=$(".bsError"),i.addClass(t),n===betSlipML.pleasecheckmembers?($("#bsDiv ul").addClass("timeout"),this._bsInst.clearBets(!1),this._bsInst.betSlipItemsChanged(),this._bsController&&this._bsController.resetBetCount(),i.html('<div class="content timeout"><div class="text">'+n+"<\/div><\/div>")):i.html('<div class="content"><div class="text">'+n+"<\/div><\/div>"),$(document).trigger("bsInfoMessage",n),i.removeClass("hidden"),this._bsInst.contentChangedOnClient())},hideMsg:function(){this._isValid()&&($(".bsError").addClass("hidden").removeClass("alert"),this._bsInst.contentChangedOnClient())}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.PlaceBetRequestDespatcher=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.PlaceBetRequestDespatcher.prototype={despatch:function(){this._isValid()&&new b365.Ui.Betslip.Validation.PlaceBetValidator(this._bsInst,this._bsController).validate()&&this._bsInst.req(this._bsInst.reqTypePlaceBet,"","",this._bsController,"getMultipleOdds")}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ReferBetRequestDespatcher=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.ReferBetRequestDespatcher.prototype={despatch:function(){if(this._isValid()&&new b365.Ui.Betslip.Validation.PlaceBetValidator(this._bsInst,this._bsController).validate()){var t="",n=document.getElementById("refCode");n&&(t="refCode="+n.getAttribute("data-refCode")+"&reftime="+n.getAttribute("data-refTime"));this._bsInst.postPayload=t;this._bsInst.req(this._bsInst.reqTypeReferBet);this._bsInst.postPayload=""}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.MaxBetReqCompleteHandler=function(n,t){this._bsInst=n;this._bsController=t;this._serverErrorReqType=99;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.MaxBetReqCompleteHandler.prototype={handle:function(n){var r;if(this._isValid()){var u=n[0],i=n[1][7][1].split("=")[1].split("-"),t=u.split("|");if(t[1]!=""&&t[0]!="E"&&new b365.Ui.Betslip.MessageDisplayHandler(this._bsInst).showMsg(t[1]),t[0]!="E"&&t[0]!="L"){r=$blib.pad2DP(t[0]);switch(i[0]){case"M":new b365.Ui.Betslip.MultiplesMaxBetReqCompleteHandler(this._bsInst).handle(i[1],r);break;case"N":$("#mltsngstk").val("");new b365.Ui.Betslip.SinglesMaxBetReqCompleteHandler(this._bsInst).handle(i[1],r);break;case"C":new b365.Ui.Betslip.CastMaxBetReqCompleteHandler(this._bsInst).handle(i[1],r);break;case"B":new b365.Ui.Betslip.BetBuilderMaxBetReqCompleteHandler(this._bsInst,this._bsController).handle(i[1],r)}}else t[0]=="E"&&new b365.Ui.Betslip.MessageDisplayHandler(this._bsInst).showMsg(betSlipML.pleaselogin);new b365.Ui.Betslip.TotalsCalculator(this._bsInst,this._bsController).calculate()}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.MultiplesMaxBetReqCompleteHandler=function(n){this._bsInst=n;this._serverErrorReqType=99;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.MultiplesMaxBetReqCompleteHandler.prototype={handle:function(n,t){if(this._isValid()){var i=$("li[data-item-type='multiple'][data-item-id='"+n+"'] input[data-inp-type='mltstk']");i.length>0&&(i[0].value=t,this._bsInst.getBetItemById(this._bsInst.itemTypeMultiple,n).setStItem("st",t),this._bsInst.updateState())}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.SinglesMaxBetReqCompleteHandler=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.SinglesMaxBetReqCompleteHandler.prototype={handle:function(n,t){if(this._isValid()){var i=$("li[data-item-type='single'][data-item-id='"+n+"'] input[data-inp-type='sngstk']");i.length>0&&(i[0].value=t,this._bsInst.getBetItemById(this._bsInst.itemTypeSingle,n).setStItem("st",t),new b365.Ui.Betslip.StakeChangedHandler(this._bsInst).handle(i[0]),this._bsInst.updateState())}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.CastMaxBetReqCompleteHandler=function(n){this._bsInst=n;this._serverErrorReqType=99;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.CastMaxBetReqCompleteHandler.prototype={handle:function(n,t){if(this._isValid()){var i=$("li[data-item-type='cast'][data-item-id='"+n+"'] input[data-inp-type='cststk']");i.length>0&&(i[0].value=t,this._bsInst.getBetItemById(this._bsInst.itemTypeCast,n).setStItem("st",t),this._bsInst.updateState())}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.InstanceEventAttacher=function(n,t){this._bsInst=n;this._controller=t;this._betSlipResponsiveClickHandler=null;this._betSlipClickHandler=new b365.Ui.Betslip.BetslipClickHandler(this._bsInst,this._controller);this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._controller!="undefined"}};b365.Ui.Betslip.InstanceEventAttacher.prototype={attach:function(){if(this._isValid()){var n=this,t=$("#bsDiv");t.change(function(t){new b365.Ui.Betslip.BetslipChangeHandler(n._bsInst,n._controller).handle(t)});n._betSlipResponsiveClickHandler===null&&(n._betSlipResponsiveClickHandler=new b365.Ui.Betslip.ResponsiveClickHandler(t[0],$.proxy(n._betSlipClickHandler.handle,n._betSlipClickHandler),!1));this._bsInst.addOnHandleInProg(function(t,i){new b365.Ui.Betslip.InProgressDisplayHandler(t,n._controller).handle(i)});this._bsInst.addOnPBetError(function(t){new b365.Ui.Betslip.PlaceBetErrorHandler(t,n._controller).handle()});this._bsInst.addOnAddBet(function(t,i){new b365.Ui.Betslip.AddBetHandler(t,n._controller).handle(i)});this._bsInst.addOnPlaceBet(function(t,i){new b365.Ui.Betslip.PlaceBetRequestDespatcher(t,n._controller).despatch(i)});this._bsInst.addOnLock(function(t,i){new b365.Ui.Betslip.LockUnlockHandler(t,n._controller).handle(i)});this._bsInst.addOnReqComplete(function(t,i){new b365.Ui.Betslip.ReqCompleteHandler(t,n._controller).handle(i,n._controller)});this._bsInst.addOnConfirmBet(function(t){new b365.Ui.Betslip.ConfirmBetRequestDespatcher(t,n._controller).despatch()});this._bsInst.addOnContentLoaded(function(t,i){n._controller.OnBetslipContentLoaded(i)});this._bsInst.addOnUpdateState(function(n,t){new b365.Ui.Betslip.UpdateStateHandler(n).handle(t)});this._bsInst.addOnRestoreState(function(n,t){new b365.Ui.Betslip.RestoreStateHandler(n).handle(t)});$("#bsDlg").on("click",function(t){new b365.Ui.Betslip.DialogClickHandler(n._bsInst,n._controller).handle(t)});$("#bsCD").on("click",function(t){new b365.Ui.Betslip.ConfirmationDialog(n._bsInst,n._controller).handleClick(t)});this._bsInst.addOnPoll(function(t,i){new b365.Ui.Betslip.PollBetRequestDespatcher(t,n._controller).despatch(i)});this._bsInst.addOnPollExpired(function(t,i){new b365.Ui.Betslip.PollingExpiredHandler(t,n._controller).handle(i)});this._bsInst.addOnReferBet(function(t,i){new b365.Ui.Betslip.ReferBetRequestDespatcher(t,n._controller).despatch(i)});$("#BetSlipForm").submit(function(t){var i=t.keyCode?t.keyCode:t.charCode;i==13?(t.preventDefault(),t.stopPropagation(),n._controller.placeBet()):(t.preventDefault(),t.stopPropagation(),t.returnValue=!1)});this._bsInst.addOnHideBetSlip(function(t){new b365.Ui.Betslip.ItemSubscriptionManager(t).unsubscribe();var i=$("#bsDiv .betReceipt");i.length>0&&i.is(".visible")&&n._controller.itemsRemoved()})}},addOnBetAdded:function(n){this._bsInst.addOnBetAdded(function(t,i){n(t,i)})},addOnBetAddedReqComplete:function(n){this._bsInst.addOnBetAddedReqComplete(function(t){n(t)})},addOnEditBet:function(n){this._bsInst.addOnEditBet(function(t){n(t)})},addOnRefreshReqComplete:function(n){this._bsInst.addOnRefreshReqComplete(function(t){n(t)})},addOnBetSlipItemsChanged:function(n){this._bsInst.addOnBetSlipItemsChanged(function(t){n(t)})},addOnAcceptChanges:function(n){this._bsInst.addOnAcceptChanges(function(t){n(t)})},addOnBetSlipLoaded:function(n){this._bsInst.addOnBetSlipLoaded(function(t){n(t)})},addOnMaxSelections:function(n){this._bsInst.addOnMaxSelections(function(t){n(t)})},addOnBetslipDisplayed:function(n){this._bsInst.addOnBetslipDisplayed(function(t){n(t)})},addOnPlaceBet:function(n){this._bsInst.addOnPlaceBet(function(t){n(t)})},addOnPlaceBetSuccess:function(n){this._bsInst.addOnPlaceBetSuccess(function(t){n(t)})},addOnAddBetslipFooterLinks:function(n){this._bsInst.addOnAddBetslipFooterLinks(function(t){n(t)})},addOnAddReceiptFooterLinks:function(n){this._bsInst.addOnAddReceiptFooterLinks(function(t){n(t)})},addOnAddReceiptLiveAlertSignUp:function(n){this._bsInst.addOnAddReceiptLiveAlertSignUp(function(t){n(t)})},addOnBetslipError:function(n){this._bsInst.addOnBetslipError(function(t){n(t)})},addOnShowBetSlip:function(n){this._bsInst.addOnShowBetSlip(function(t){n(t)})},addOnHideBetSlip:function(n){this._bsInst.addOnHideBetSlip(function(t){n(t)})},addOnChangeBetslipHeight:function(n){this._bsInst.addOnChangeBetslipHeight(function(t){n(t)})},addOnSessionExpired:function(n){this._bsInst.addOnSessionExpired(function(t,i){n(t,i)})},addOnHandleBetGuidChange:function(n){this._bsInst.addOnHandleBetGuidChange(n)}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ReqCompleteHandler=function(n,t){this._bsInst=n;this._bsController=t;this._serverErrorReqType=99;this._betSlipDialogIndicator="BET_SLIP_DIALOG";this._showDlg=!1;this._resetButtonState=!0;this._hideInProg=!0;this._dlg=null;this._isValid=function(){return typeof this._bsInst!="undefined"};this._handleServerError=function(n){$("#bsDiv").html(n[0])};this._handleDialogReqComplete=function(n){n[0]=n[0].replace(this._betSlipDialogIndicator,"");this._showDlg=!0;this._dlg=new b365.Ui.Betslip.DialogReqCompleteHandler(this._bsInst,this._bsController).handle(n)};this._pollingContinuesHandler=function(n,t,i){this._resetButtonState=!1;var r=new b365.Ui.Betslip.PollingContinuesReqCompleteHandler(this._bsInst).handle(n,t);r&&(this._hideInProg=r.pollStatus!==b365.Ui.BetslipAPI.Polling.PollStatusEnum.StartOrContinue,this._bsInst._pollInProcess=!0,r.pollStatus===b365.Ui.BetslipAPI.Polling.PollStatusEnum.Succeeded&&i&&(this._addFooterLinks(i),this._bsInst._pollInProcess=!1,this._bsController.liveAlertsEnabled()&&this._betslipHasValidLiveAlertsBets()&&this._addLiveAlertSignUpButtons()))};this._defaultHandler=function(n){var t=this,e,s,h,o,i,c,u,l,f,r=n[0],a;if(t._bsController.clientEnhancedMode()&&t._bsController.clientBetSlipShowing()){if(r.indexOf("betReceipt")>-1){t._doStandardDOMUpdate(r,!1);return}if(t._bsController._stakeEntryType==t._bsController._stakeEntryTypes.stakePad)if(e=$("#stakePad"),e.length>0){if(s=e[0].getAttribute("data-item"),h=e[0].getAttribute("data-type"),o=document.createElement("div"),o.innerHTML=r,f=o.getElementsByTagName("li"),f.length>0)for(u=0,l=f.length;u<l;u++)if(f[u].getAttribute("data-item-id")==s&&f[u].getAttribute("data-item-type")==h){i=f[u];break}i?(i.innerHTML=i.innerHTML+t._bsController._stakeEntryHander.getStakePadMarkUp(s,h,!0),a=(i.getAttribute("class")?i.getAttribute("class"):"")+" keypad",i.setAttribute("class",a),c=$("input",i),t._compareMultiplesAndRenderDOM(o.innerHTML,!0,!1),t._bsController._stakeEntryHander.enableOrDisableKeys(c)):t._compareMultiplesAndRenderDOM(r,!1,!0)}else t._compareMultiplesAndRenderDOM(r,!1,!1);else t._compareMultiplesAndRenderDOM(r,!1,!1)}else t._doStandardDOMUpdate(r,!1)};this._compareMultiplesAndRenderDOM=function(n,t,i){var r=this,l=!1,a=!1,o,s,u,f,h,e,v=!1,y,c;if(o=document.createElement("div"),o.innerHTML=n,s=o.getElementsByTagName("li"),s.length>0){for(f=0,h=s.length;f<h;f++)if(s[f].getAttribute("class")=="multiple-section multipleBets"){u=$('li[class$="multiple-section multipleBets"]',"#bsDiv");u.length>0&&u[0].children[0].getAttribute("class")=="open"&&(a=!0);l=!0;break}if(l)if(a){for(u=$('li[data-item-type$="multiple"]'),f=0,h=u.length;f<h;f++)y=u[f].getAttribute("data-item-id"),n.indexOf('li data-item-id="'+y+'" data-item-type="multiple"')==-1&&(u[f].setAttribute("animate","yes"),v=!0);v?(r._createAndDisplayBetSlipContainerClone(i),u=$('li[data-item-type$="multiple"][animate$="yes"]',"#bsDivClone"),r._doStandardDOMUpdate(n,t),e=$("#bsDivClone"),i?(c=$("#stakePadClone","#bsDivClone"),r._bsController._enhancedBetSlipAnimations.hideBetMultiples(u,e,!0,c,r._removeCloneAndShowLiveBetSlipContainer,[],r)):r._bsController._enhancedBetSlipAnimations.hideBetMultiples(u,e,!1,null,r._removeCloneAndShowLiveBetSlipContainer,[],r)):r._doStandardDOMUpdate(n,t)}else r._doStandardDOMUpdate(n,t);else{if(u=$('li[class$="multiple-section multipleBets"]',"#bsDiv"),u.length==0||!u.is(".visible")){r._doStandardDOMUpdate(n,t);return}r._createAndDisplayBetSlipContainerClone(i);u=$('li[class$="multiple-section multipleBets"]',"#bsDivClone");r._doStandardDOMUpdate(n,t);e=$("#bsDivClone");i?(c=$("#stakePadClone","#bsDivClone"),r._bsController._enhancedBetSlipAnimations.hideBetMultiples(u,e,!0,c,r._removeCloneAndShowLiveBetSlipContainer,[],r)):r._bsController._enhancedBetSlipAnimations.hideBetMultiples(u,e,!1,null,r._removeCloneAndShowLiveBetSlipContainer,[],r)}}else r._doStandardDOMUpdate(n,t);o=null};this._doStandardDOMUpdate=function(n,t){var i=this,f=document.getElementById("bsDiv"),u,e,o,h,r,s;if(f.innerHTML=n,u=f.getElementsByClassName("stk"),i._bsController&&i._bsInst&&i._bsController._stakeEntryType==i._bsController._stakeEntryTypes.deviceKeyBoard&&u.length>0)for(r=0,s=u.length;r<s;r++)e=u[r].cloneNode(!0),e.setAttribute("type",i._bsInst.keyboardType),u[r].parentNode.replaceChild(e,u[r]),e=null;if(i._bsController&&i._bsController._currencyDisplayHelper&&u.length>0)for(r=0,s=u.length;r<s;r++)o=u[r].value,o.toString().indexOf(".")>-1&&(h=o.toString().split("."),u[r].value=h[1]=="00"?h[0]:i._bsController._currencyDisplayHelper.formatCurrency(o));t&&(i._bsController._stakeEntryHander.reenable(i._bsController._stakeEntryHander),i._bsController._stakeEntryHander._isShowing=!0);$(f).find('li[data-item-type$="tote-single"], li[data-item-type$="tote-cast"], li[data-item-type$="tote-pot"]').length>0&&$(f).find(".betslipHeader").removeClass("hidden");i._resetButtonState=!1;i._checkLoginStatus()};this._createAndDisplayBetSlipContainerClone=function(n){var i=document.getElementById("bsDiv"),t=i.cloneNode(!0),r;t.setAttribute("id","bsDivClone");n&&(r=t.innerHTML,r=r.replace('id="stakePad"','id="stakePadClone"'),t.innerHTML=r);i.parentNode.appendChild(t);i.setAttribute("style","display:none;");i=null;t=null};this._removeCloneAndShowLiveBetSlipContainer=function(){var n=document.getElementById("bsDiv"),t=document.getElementById("bsDivClone");n.parentNode.removeChild(t);n.removeAttribute("style");n=null;t=null};this._customerDialogHandler=function(n){this._resetButtonState=!0;new b365.Ui.Betslip.CustomerReqCompleteHandler(this._bsInst,this._bsController).handle(n)};this._checkLoginStatus=function(){var n=$("#bsDiv>ul:first").attr("data-bsuis");this._bsController._delegates.isAuthenticated()&&n=="0"&&this._bsInst.sessionExpired()};this._betPlacementAttempt=function(n){if(n){var t=window.location.host.split(".").pop()==="it";t||this._bsInst.placeBetSuccess();this._bsInst.setValueInBSCookie("processed","true");this._bsInst.backupBSCookieValue(this._bsInst._betSlipCookieKey)}};this._addFooterLinks=function(n){n?(this._bsInst.addReceiptFooterLinks(),new b365.Ui.Betslip.FooterLinksReceiptRender(this._bsInst).render()):(this._bsInst.betSlipDisplayed(),this._bsInst.addBetslipFooterLinks(),new b365.Ui.Betslip.FooterLinksSlipRender(this._bsInst,$(".footer")).render())};this._addLiveAlertSignUpButtons=function(){this._bsInst.addReceiptLiveAlertSignUp();new b365.Ui.Betslip.FooterLiveAlertsReceipt(this._bsInst,this._bsController).render()};this._betslipHasValidLiveAlertsBets=function(){var n=this._bsController.liveAlertsEnabledClassifications(),r,t,u,i;if(!n)return!1;for(t=0,u=this._bsInst._betItems.length;t<u;t++){r=this._bsInst._betItems[t].getCnItem("c");for(i in n)if(n.hasOwnProperty(i)&&n[i]==r)return!0}return this._bsInst._betBuilderItems.length>0?!0:!1};this._processResponse=function(n,t,i,r){var u=this,h,e,c,f,o;if(u._bsInst&&(h=u._bsInst.getSlipType(),h!==u._bsInst.slipIF))for(e=document.getElementsByClassName("stk"),c=new b365.Ui.Betslip.StakeChangedHandler(u._bsInst,u._bsController),f=0;f<e.length;f++)e[f].value>0&&c.handle(e[f]);if(new b365.Ui.Betslip.TotalsCalculator(u._bsInst,u._bsController).calculate(),new b365.Ui.Betslip.LockUnlockHandler(u._bsInst,u._bsController).handle(!1,u._resetButtonState,n===u._bsInst.reqTypeBetBrk),o=document.getElementsByClassName("bs-FreeBetError"),o.length>0){var a=new b365.Ui.Betslip.ItemInformation(o[0]),l=a.itemIndexAndType(),s=this._bsInst.getBetItemById(l[1],l[0]);s.setStItem("ft","");s.setStItem("fbv","");s.setStItem("st","");s.setStItem("ust","");u._bsInst.updateState();new b365.Ui.Betslip.FreeBetClickProcessor(this._bsInst,this._bsController).init(o[0]).handle(!1)}u._hideInProg&&u._bsInst.handleInProg("hide","");t.length>0&&n!=this._bsInst.reqTypeBetBrk&&t[0].indexOf("DepositMessage")==-1&&u._bsInst.contentLoaded();i&&new b365.Ui.Betslip.ItemSubscriptionManager(u._bsInst).attach(u._bsController);(u._receiptContext||r)&&u._bsInst.ScrollToTop();typeof window.MyBetsController!="undefined"&&window.MyBetsController.isInitialised()&&window.MyBetsController.bindButtonEvents();u._bsController&&u._bsController.clientActionInProgress(!1);u._bsInst.toggledBankerSelectionState&&(u._bsController.ausMultiplesEnabled()&&(u._bsController.complexMultiplesNeedsRefresh=!1,u._bsController.getMultipleInfo(!0)),u._bsInst.toggledBankerSelectionState=!1)}};b365.Ui.Betslip.Request={getTypeId:function(n){return n[1][7][0]},getResponse:function(n){return n[0]}};b365.Ui.Betslip.ReqCompleteHandler.prototype={handle:function(n){function ot(n,t,i){var r=n;return n&&i>0&&t>=0&&(r=n.substr(0,t)+n.substr(t+i)),r}var t=this,c,r,p,tt,h,l,w,a,b,v,it,s,k,d,g,e,rt,nt;if(t._bsController._noStakeCount=0,t._isValid()){e=!1;t._resetButtonState=!0;t._hideInProg=!0;var i=b365.Ui.Betslip.Request.getTypeId(n),u=b365.Ui.Betslip.Request.getResponse(n),f=i==bs.reqTypePlaceBet&&window.location.hostname.split(".").pop().toLowerCase()==="au",ut=u.indexOf("TELEBET_WRITE")>-1;this._receiptContext=!f&&u.indexOf("betReceipt")>-1;t._bsController.ausMultiplesEnabled()&&(n[1][7][4]=="getMultipleCombinations"||t._bsController.complexMultiplesCombinationsInit?(t._bsController.complexMultiplesCombinationsInit=!1,t._bsController.complexMultiplesNeedsRefresh=!0,rt=t._bsInst.getBetItems(t._bsInst.betTypeMultiple).length>0,(rt||t._bsController.hasMultipleStakeEntries())&&t._bsController.getMultipleInfo(!0)):n[1][7][4]=="getMultipleOdds"&&new b365.Ui.Betslip.TotalsCalculator(t._bsInst,t._bsController).calculate());t._bsController.clientEnhancedMode()&&!b365.Ui.BetslipAPI.Polling.isPollingRequestType(i)&&(r=$("#bsDiv"),($("li",r).hasClass("disableBetSlip")||$("li",r).hasClass("disabledBetSlip"))&&(c=$('li[data-item-type$="multiple"], li[data-item-type$="single"], li[data-item-type$="cast"], li[data-item-type$="tote-single"], li[data-item-type$="tote-cast"], li[data-item-type$="tote-pot"], li[data-item-type$="tote-pot-leg"]',r),t._bsController._enhancedBetSlipAnimations.enableBetSlip(c,r)));var ft=t._bsInst.getValueFromBSCookie("processed").replace("||",""),et=u.indexOf("DepositMessage")>-1||u.indexOf("CustomerMessage")>-1,y=b365.Ui.BetslipAPI.Polling.getInstructionSubStringInfo(u),o=null;if(y&&(o=y.content,t._receiptContext&&(u=ot(u,y.sourceStartIndex,y.length),n[0]=u)),o||(this._bsInst._pollInProcess=!1),u.indexOf("data-betguid")>-1&&(g=$(u).attr("data-betguid"),g&&t._bsInst.raiseBetGuidChangeEvent(g)),i==t._serverErrorReqType)t._handleServerError(n),t._processResponse(i,n,e,f);else if(i==t._bsInst.reqTypeMaxBet)new b365.Ui.Betslip.MaxBetReqCompleteHandler(t._bsInst,t._bsController).handle(n),t._processResponse(i,n,e,f);else if(i==t._bsInst.reqTypeBetBrk||i==t._bsInst.reqTypePitcher||u.indexOf(t._betSlipDialogIndicator)!=-1)t._handleDialogReqComplete(n),t._processResponse(i,n,e,f);else if(u.indexOf("DUPLICATE_BET")>-1||u.indexOf("CHECK_MEMBERS")>-1)new b365.Ui.Betslip.DuplicateBetHandler(t._bsInst,t._bsController).handle(),t._hideInProg=!0,t._processResponse(i,n,e,f);else if(u.indexOf("LOCKED")>-1)r=$("#bsDiv"),p=r.find(".placeBet button"),p.length>0&&(h=r.find("#buttonContent"),h.length>0&&(h=h[0].innerHTML,p[0].innerHTML=h)),t._processResponse(i,n,e,f);else{if(i==t._bsInst.reqTypePhoneBet){new b365.Ui.Betslip.PhoneBetHandler(t._bsInst,t._bsController).displayPopup(u);return}if(o&&!t._receiptContext)t._pollingContinuesHandler(i,o,!0),t._processResponse(i,n,e,f);else if(b365.Ui.BetslipAPI.Polling.isPollingRequestType(i))i!==t._bsInst.reqTypePollTempBetReceipt&&(new b365.Ui.Betslip.PollingFinishedReqCompleteHandler(t._bsInst,t._bsController).handle(n),t._betPlacementAttempt(t._receiptContext),$("#closeButton").removeClass("disabled"),$("#okButton").removeClass("disabled"),t._bsController.clientEnhancedMode()&&(r=$("#bsDiv"),($("li",r).hasClass("disableBetSlip")||$("li",r).hasClass("disabledBetSlip"))&&(c=$('li[data-item-type$="multiple"], li[data-item-type$="single"], li[data-item-type$="cast"], li[data-item-type$="tote-single"], li[data-item-type$="tote-cast"], li[data-item-type$="tote-pot"], li[data-item-type$="tote-pot-leg"]',r),t._bsController._enhancedBetSlipAnimations.enableBetSlip(c,r)),window.location.host.split(".").pop()!=="it"&&(this._receiptContext&&this._bsController.liveAlertsEnabled()&&this._betslipHasValidLiveAlertsBets()&&this._addLiveAlertSignUpButtons(),this._addFooterLinks(this._receiptContext||f)))),o&&t._pollingContinuesHandler(i,o,t._receiptContext),t._processResponse(i,n,e,f);else if(et)t._customerDialogHandler(n),t._processResponse(i,n,e,f);else{if(ut)return;new b365.Ui.Betslip.ItemSubscriptionManager(this._bsInst).unsubscribe();e=!0;this._bsController.getPushMarketsEnabled()&&i==this._bsInst.reqTypeRefreshAccept&&(s=$(".hcapChange",r)[0]);t._defaultHandler(n,i);this._receiptContext||f||ft!="true"?i==t._bsInst.reqTypeRefreshSlip?t._bsInst.refreshReqComplete():i==t._bsInst.reqTypeAddItems||i==t._bsInst.reqTypeConstructAndAddItems?(t._bsInst.betAddedReqComplete(),$(document).trigger("bsInfoMessage",n[0].toUpperCase().indexOf("ALREADY ADDED")>-1?window.betSlipML.duplicateselection:window.betSlipML.addedtobetslip),l=$("#BetSlipDialogueAddToBetslip"),l.length>0&&(w=n[0].match(/class=\"[\w\s]*acceptChanges[\w\s]*\"/i),w.length>0&&n[0].indexOf("oddsChange")<0&&n[0].indexOf("hcapChange")<0&&(w[0].toLowerCase().indexOf("hidden")<0?$("a",l).addClass("disabled").attr("data-nav",""):$("a",l).removeClass("disabled").attr("data-nav","AddToBetSlip")))):i==t._bsInst.reqTypePlaceBet||i==t._bsInst.reqTypeConfirmBet||i==t._bsInst.reqTypeGetCTCBetDetails||i==t._bsInst.reqTypeItalySplitStakeConfirm?(t._betPlacementAttempt(t._receiptContext),(i==t._bsInst.reqTypePlaceBet||i==t._bsInst.reqTypeItalySplitStakeConfirm)&&(r=r||$("#bsDiv"),tt=r.find(".placeBet.abetslipBtn"),t._bsInst.placebetBtnDisabledForSpanishStakeLimit=!!tt.attr("data-lineitemsabovebetlimits"))):i==t._bsInst.reqTypeRefreshAccept&&(r=$("#bsDiv"),r.trigger("b365.Ui.Betslip.acceptingchanges"),t._bsInst.acceptChanges(),s!=undefined&&(nt=parseInt(s.getAttribute("data-item-push"),10),it=this._bsInst._betItems[s.getAttribute("data-item-id")],nt>0&&(k=new b365.Ui.Betslip.PushBetDialog(this._bsInst,this._bsController,it.getCn(),nt,s.getAttribute("data-item-id"),s.getAttribute("data-item-type")),d=k.buildPushBetMessage(),d!=""&&this._bsController.showDialog(k,d,!0)))):new b365.Ui.Betslip.ViewResetter(t._bsInst,t._bsController).reset();o?t._pollingContinuesHandler(i,o,!1):(this._receiptContext&&this._bsController.liveAlertsEnabled()&&this._betslipHasValidLiveAlertsBets()&&this._addLiveAlertSignUpButtons(),this._addFooterLinks(this._receiptContext||f));this._bsController&&this._bsController._dlg&&(a=$("#okButton"),a.length>0&&(b=a[0].getAttribute("data-action"),b&&b==="refer"&&(v=$("#bsCD"),v.length>0&&v[0].hasAttribute("style")&&v.css("display")!="none"&&this._bsController._dlg.hideDialog(),a.removeClass("disabled"),$("#closeButton").removeClass("disabled"))));t._processResponse(i,n,e,f)}}}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.CustomerReqCompleteHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.CustomerReqCompleteHandler.prototype={handle:function(n){var i=this,r,t=n[0].split("|");t.splice(0,1);r={userBalance:t[0],totalStake:t[1],is3dSecure:t[2],isQuickDeposit:t[3],QuickDepositRemainingStake:t[4]};i._bsController.deposit(r);r.isQuickDeposit==="1"&&new b365.Ui.Betslip.MessageDisplayHandler(i._bsInst).showMsg(betSlipML.insufficientfunds);new b365.Ui.Betslip.LockUnlockHandler(i._bsInst,i._bsController).handle(!1,!0)}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.DialogReqCompleteHandler=function(n,t){this._bsInst=n;this._bsController=t;this._titleMarker="|title";this._messageMarker="|message";this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.DialogReqCompleteHandler.prototype={handle:function(n){if(this._isValid()){var i=this,u=n[0],f,r,e,o,s,h,c,t,l;u.length>0&&(t=$(u),l=t.attr("data-renderstyle")==="confirmation",f=t.attr("class"),r=t.children("#title").html(),e=t.children("#message").html(),o=t.children("#button1Text").html(),s=t.children("#button2Text").html(),h=t.children("#button1Action").html(),c=t.children("#button2Action").html(),r||l?i._bsController.showConfirmation(i,r,e,o,h,s,c,f):i._bsController.showDialog(i,t))}},setDialog:function(n){var t=this;t._bsController.SetCurrentDialogRef(n)}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.LockUnlockHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.LockUnlockHandler.prototype={handle:function(n,t,i){var e,o,u;if(this._isValid()){var f=$("#bsDiv a.placeBet"),s=$("#bsDiv select.bet-slip-type"),h=$("#bsDiv"),r=$("#bsDiv ul>li");typeof t=="undefined"&&(t=!0);e=this._bsInst._pollReqType===this._bsInst.reqTypePollTempBetReceipt;n=n||this._bsInst.pollInProgress()&&!e;typeof i=="undefined"&&(i=!1);f.length>0&&(n||this._bsInst.numItems()==0?(f.disableElement("disabled"),s.disableElement(),new b365.Ui.Betslip.EnhancedElementsLockUnlockHandler(this._bsInst,this._bsController).lock()):t&&(o=$("#bsDiv a.acceptChanges"),(!this._bsInst.isEmpty()&&this._bsController._delegates.isAuthenticated()&&(o.length==0||o.hasClass("hidden"))||i)&&f.enableElement("disabled"),s.enableElement(),new b365.Ui.Betslip.EnhancedElementsLockUnlockHandler(this._bsInst,this._bsController).unlock()));n==!0?r.find("input").disableElement():r.find("input").enableElement();n==!0?r.find("select").disableElement():r.find("select").enableElement();n==!0?h.addClass("bs-inprogress"):h.removeClass("bs-inprogress");u=r.find("a:not(.placeBet,.placeCTCBet)");(e||this._bsInst.reqType===this._bsInst.reqTypePollTempBetReceipt)&&(u=u.filter(function(){if(!this.parentElement)return!0;var n=$(this.parentElement);return!(n.hasClass("footer")||n.hasClass("footerLinks"))}));n==!0?u.disableElement():u.enableElement()}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.EnhancedElementsLockUnlockHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.EnhancedElementsLockUnlockHandler.prototype.lock=function(){this._bsController._enhancedBetSlipTypeSelector&&this._bsController._enhancedBetSlipTypeSelector.disablePopUp();this._bsController._enhancedBetSlipOddsSelector&&this._bsController._enhancedBetSlipOddsSelector.disablePopUps();this._bsController._enhancedBetSlipPitcherSelector&&this._bsController._enhancedBetSlipPitcherSelector.disablePopUps();this._bsController._enhancedBetSlipToteSelector&&this._bsController._enhancedBetSlipToteSelector.disablePopUps();this._bsController._enhancedIfBetSelector&&this._bsController._enhancedIfBetSelector.disablePopUps();this._bsController._enhancedTeaserSelector&&this._bsController._enhancedTeaserSelector.disablePopUps();this._bsController._removeClickHandler&&this._bsController._removeClickHandler.removeHandlers();this._bsController._eachWayClickHandler&&this._bsController._eachWayClickHandler.removeHandlers();this._bsController._noReservesClickHandler&&this._bsController._noReservesClickHandler.removeHandlers();this._bsController._stakeEntryType==this._bsController._stakeEntryTypes.stakePad&&this._bsController._stakeEntryHander&&this._bsController._stakeEntryHander._isShowing&&this._bsController._stakeEntryHander.detach()};b365.Ui.Betslip.EnhancedElementsLockUnlockHandler.prototype.unlock=function(){var n=this;this._bsController._enhancedBetSlipTypeSelector&&this._bsController._enhancedBetSlipTypeSelector.enablePopUp();this._bsController._enhancedBetSlipOddsSelector&&this._bsController._enhancedBetSlipOddsSelector.enablePopUps();this._bsController._enhancedBetSlipPitcherSelector&&this._bsController._enhancedBetSlipPitcherSelector.enablePopUps();this._bsController._enhancedBetSlipToteSelector&&this._bsController._enhancedBetSlipToteSelector.enablePopUps();this._bsController._enhancedIfBetSelector&&this._bsController._enhancedIfBetSelector.enablePopUps();this._bsController._enhancedTeaserSelector&&this._bsController._enhancedTeaserSelector.enablePopUps();this._bsController._removeClickHandler?this._bsController._removeClickHandler.attachHandlers():(this._bsController._removeClickHandler=new b365.Ui.Betslip.RemoveClickHandler(n._bsInst,n._bsController),this._bsController._removeClickHandler.attachHandlers());this._bsController._eachWayClickHandler?this._bsController._eachWayClickHandler.attachHandlers():b365.Ui.Betslip.EachWayClickHandler&&(this._bsController._eachWayClickHandler=new b365.Ui.Betslip.EachWayClickHandler(n._bsInst,n._bsController),this._bsController._eachWayClickHandler.attachHandlers());this._bsController._freeBetClickHandler?this._bsController._freeBetClickHandler.attachHandlers():b365.Ui.Betslip.FreeBetClickHandler&&(this._bsController._freeBetClickHandler=new b365.Ui.Betslip.FreeBetClickHandler(n._bsInst,n._bsController),this._bsController._freeBetClickHandler.attachHandlers());this._bsController._noReservesClickHandler?this._bsController._noReservesClickHandler.attachHandlers():b365.Ui.Betslip.NoReservesClickHandler&&(this._bsController._noReservesClickHandler=new b365.Ui.Betslip.NoReservesClickHandler(n._bsInst,n._bsController),this._bsController._noReservesClickHandler.attachHandlers());this._bsController._stakeEntryType==this._bsController._stakeEntryTypes.stakePad&&this._bsController._stakeEntryHander&&this._bsController._stakeEntryHander._isShowing&&this._bsController._stakeEntryHander.init()};Type.registerNamespace("b365.Ui.BetslipAPI"),function(n){var i="BET_POLL",t="ENDPOLLDATA",r="PS=",u="RDAT=",f="NPRP=";n.PollStatusEnum={StartOrContinue:0,Succeeded:1,Failed:2};n.getInstructionSubStringInfo=function(n){var u,r=n.indexOf(i),f;return r<0?null:(f=n.indexOf(t,r+i.length),u=f>-1?n.substring(r,f+t.length):n.substring(r),{content:u,sourceStartIndex:r,length:u.length})};n.boundedSubString=function(n,t,i){var r,u;return!n||!t||!i||n.length<t.length+i.length?null:(r=n.indexOf(t),r<=-1)?null:(r+=t.length,u=n.indexOf(i,r),u<r)?null:n.substring(r,u)};n.parsePollInfo=function(e){var s=n.boundedSubString(e,i,t),o,h=null;return s&&(o=s.split("|"),h={reqType:o.length>1?Number(o[1]):null,referenceId:o.length>2?o[2]:"",time:o.length>3?o[3]:null,interval:o.length>4?o[4]:null,pollStatus:n.PollStatusEnum.StartOrContinue,nextPollRequestParams:null,responseData:null},s.indexOf(r)>0&&(h.pollStatus=Number(n.boundedSubString(s,r,f)),h.nextPollRequestParams=n.boundedSubString(s,f,u),h.responseData=n.boundedSubString(e,u,t))),h};n.isPollingRequestType=function(n){return n===bs.reqTypePollReferredBet||n===bs.reqTypePollTempBetReceipt}}(window.b365.Ui.BetslipAPI.Polling=window.b365.Ui.BetslipAPI.Polling||{});Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.PollingContinuesReqCompleteHandler=function(n){this._bsInst=n;this._isValid=function(){return this._bsInst!==undefined}};b365.Ui.Betslip.PollingContinuesReqCompleteHandler.prototype={EnableGuiControlsForTempReceipt:function(n){var i=$("#bsDiv"),t=i.find(".abetslipRecBtn button"),r=t&&n!==t.prop("disabled");r||(i.find(".rctrs").prop("disabled",!n),t.prop("disabled",!n),n?t.parent().removeClass("disabled"):t.parent().addClass("disabled"))},handle:function(n,t){var i=null;if(this._isValid()){if((i=b365.Ui.BetslipAPI.Polling.parsePollInfo(t),!i||!i.referenceId&&!i.nextPollRequestParams&&!i.responseData)||(n=Number(n),b365.Ui.BetslipAPI.Polling.isPollingRequestType(n)===i.reqType&&this._bsInst._pollReqType===0))return null;n===this._bsInst.reqTypePollTempBetReceipt&&this.handleTempReceiptData(i);i.pollStatus===b365.Ui.BetslipAPI.Polling.PollStatusEnum.StartOrContinue&&this._bsInst.pollBet(i.reqType,i.referenceId,i.time,i.interval,i.nextPollRequestParams);i.reqType===this._bsInst.reqTypePollTempBetReceipt&&this.EnableGuiControlsForTempReceipt(i.pollStatus!==b365.Ui.BetslipAPI.Polling.PollStatusEnum.StartOrContinue)}return i},handleTempReceiptData:function(n){var i=n.responseData,o=2,s=3,r,h,t,u=null,c,l,f=null,a,e;if(n.pollStatus!==b365.Ui.BetslipAPI.Polling.PollStatusEnum.Failed&&i&&i.length!==0&&(i=JSON.parse(i),i)){for(h=i.BetList.length,r=0;r<h;r+=1){t=i.BetList[r];switch(t.Status){case-1:u="timedout";break;case o:u="accepted";f=t.PSQFReference;$("#tempbetstatus_reference_"+t.TempBettingSlipId).text(t.BetReference).prev().show();break;case s:u="rejected";f=betSlipML.aamsrejected}l=$("#tempbetstatus_title_"+t.TempBettingSlipId+" .bs-tempbetstatus_titleText");(t.Status===o||t.Status===s)&&(l.text(f),$("#tempbetstatus_desc_"+t.TempBettingSlipId).hide());c=$("#tempbetstatus_title_"+t.TempBettingSlipId);a=t.Status===0||t.Status===1;a===!1&&c.removeClass("pending").addClass(u)}n.pollStatus===b365.Ui.BetslipAPI.Polling.PollStatusEnum.Succeeded&&i.UserBalanceDisplayValue.length>0&&($("#bsDiv > ul:first-child").attr("data-ub",i.UserBalanceDisplayValue),e=$("#bsDiv > ul:first-child .betslipHeaderTempReceipt"),e&&e[0]&&$("#bsDiv > ul:first-child .betslipHeaderTempReceipt").addClass("betslipHeaderTempReceiptComplete"),this._bsInst.placeBetSuccess())}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.PollingFinishedReqCompleteHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.PollingFinishedReqCompleteHandler.prototype={handle:function(n){if(this._isValid()){this._bsInst.resetPoll();var t=n[0].indexOf("DepositMessage")>-1||n[0].indexOf("CustomerMessage")>-1;t?(this._bsController._dlg&&this._bsController._dlg.hideDialog(),new b365.Ui.Betslip.CustomerReqCompleteHandler(this._bsInst,this._bsController).handle(n)):(this._bsController._dlg&&this._bsController._dlg.hideDialog(),$("#bsDiv").html(n[0]))}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.MultiBreakdownRequestDespatcher=function(n,t){this._bsController=t;this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.MultiBreakdownRequestDespatcher.prototype={despatch:function(n){this._isValid()&&this._bsInst.req(this._bsInst.reqTypeBetBrk,new b365.Ui.Betslip.BetBreakdownKeyGenerator(this._bsInst,this._bsInst.getBetItemById(this._bsInst.itemTypeMultiple,n),this._bsInst.itemTypeMultiple,n).generate(),undefined,this._bsController)}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.RemoveAllItemsRequestDespatcher=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"};this._closeBetSlip=function(){var n=this;n._bsInst.hideBetSlip()}};b365.Ui.Betslip.RemoveAllItemsRequestDespatcher.prototype={despatch:function(n){var t,i;this._isValid()&&!$(n).hasClass("disabled")&&(this._closeBetSlip(),this._bsInst.clearBets(!1),this._bsInst.betSlipItemsChanged(),this._bsController.itemsRemoved(),$("#bsDiv").trigger("b365.Ui.Betslip.removingall"),sProps.instantBet&&(new b365.Ui.Betslip.TotalsCalculator(this._bsInst,this._bsController).calculate(),$(".single-section,.multiple-section,.totals,.bsError,#pro").addClass("hidden"),$(".emptyBetslip").removeClass("hidden"),$(".betslipHeader").addClass("hidden"),$(".bs-useFreeBet").addClass("hidden"),$(".placeBet").addClass("hidden"),$(".placeBet").addClass("disabled"),$(".abetslipBtn").text(betSlipML.AddSelections),t=document.getElementById("ib-betcount"),t&&(t.innerHTML="")));i=this._bsController._bsInst.getClickToCallHandler();i&&(ctcTokenData=i.dispose())}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.EditSelectionsRequestDespatcher=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.EditSelectionsRequestDespatcher.prototype={despatch:function(){this._isValid()&&(this._bsInst.editBet(),this._bsInst.setClearOnAdd(!1),this._bsInst.setValueInBSCookie("processed","false"),this._bsInst.refresh(this._bsInst.betTypeNormal))}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.DialogClickHandler=function(n,t){this._bsInst=n;this._controller=t;this._closeAction="close";this._referAction="refer";this._italyPushProceed="ipProceed";this._italyPushCancel="ipCancel";this._pdProceed="pdProceed";this._pdHelp="pdHelp";this._hrefClick="href";this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._controller.GetCurrentDialogRef()!="undefined"};this._handleRefer=function(){new b365.Ui.Betslip.ReferBetRequestDespatcher(this._bsInst,this._controller).despatch()}};b365.Ui.Betslip.DialogClickHandler.prototype={handle:function(n){var i=$(n.target),r=i.attr("data-action"),t;if(this._isValid()){if(r!==this._hrefClick&&(n.preventDefault(),n.stopPropagation()),i.hasClass("disabled"))return;switch(r){case this._closeAction:$("#closeButton").removeClass("disabled");$("#okButton").removeClass("disabled");this.hideDialog();break;case this._referAction:$("#closeButton").addClass("disabled");t=$("#okButton");t.addClass("disabled");t[0].innerHTML=window.betSlipML.referringBet+'<span class="buttonSpinner"><\/span>';this._handleRefer();break;case this._italyPushProceed:case this._italyPushCancel:case this._pdProceed:case this._pdHelp:this._controller._dlg.controller.handleClick(n)}}}};b365.Ui.Betslip.DialogClickHandler.prototype.hideDialog=function(){this._controller._dlg&&this._controller._dlg.hideDialog()};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.DialogCloser=function(n,t){this._controller=n;this._dialogContainer=$(t);this._isValid=function(){return typeof this._controller!="undefined"&&typeof this._dialogContainer!="undefined"}};b365.Ui.Betslip.DialogCloser.prototype={closeDialog:function(){this._isValid()&&(this._dialogContainer.addClass("hidden"),$(".centergreyout").remove())}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.RetainSelectionsRequestDespatcher=function(n,t){this._bsInst=n;this._controller=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.RetainSelectionsRequestDespatcher.prototype={despatch:function(n){var i,t;if(this._isValid()&&!$(n).hasClass("disabled")){for(this._controller.getPushMarketsEnabled()?this._bsInst.restoreBSCookieValue("bs",this._bsInst._pushBetSlipCookieBackup):this._bsInst.restoreBSCookieValue("bs",this._bsInst._betSlipCookieBackup),this._bsInst.setValueInBSCookie("processed","false"),new b365.Ui.Betslip.RestoreStateHandler(this._bsInst).handle(),this._bsInst.setClearOnAdd(!1),new b365.Ui.Betslip.UpdateStateHandler(this._bsInst).handle(),i=this._bsInst.getBetItems(this._bsInst.itemTypeAll),t=0;t<i.length;t++)i[t].setStItem("st",""),i[t].setStItem("ust",""),i[t].setStItem("gust",""),i[t].setStItem("gst",""),i[t].setStItem("tr",""),i[t].setStItem("fbv",""),i[t].setStItem("ft",""),i[t].setStItem("rfs","");this._bsInst.updateState();this._bsInst.refresh(this._bsInst.betTypeNormal);this._controller.retainSelectionsDelegate()}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.SingleBreakdownRequestDespatcher=function(n,t){this._bsController=t;this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.SingleBreakdownRequestDespatcher.prototype={despatch:function(n){this._isValid()&&this._bsInst.req(this._bsInst.reqTypeBetBrk,new b365.Ui.Betslip.BetBreakdownKeyGenerator(this._bsInst,this._bsInst.getBetItemById(this._bsInst.itemTypeSingle,n),this._bsInst.itemTypeSingle,n).generate(),undefined,this._bsController)}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.RepeatStakeClickHandler=function(n,t,i,r,u){this._bsInst=n;this._bsController=t;this._itemIndex=i;this._itemType=r;this._itemElement=u;this._isItalianDomain=window.location.host.split(".").pop()=="it";this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._itemIndex!="undefined"&&typeof this._itemType!="undefined"&&typeof this._itemElement!="undefined"};this._isValidRepeatStake=function(n){return n!=""&&Number(n)>0};this._repeatStake=function(n,t,i){var f,e,r,u;if(this._isValid()){for(f=this._bsInst.getBetItems(t),e=new b365.Ui.Betslip.StakeChangedHandler(this._bsInst),r=i;r<f.length;r++)u=$("#bsDiv "+(t==this._bsInst.itemTypeSingle?".single-section":".cast-section")+" li[data-item-id='"+r+"']:not(.suspended) .stk"),u.length>0&&u[0].className.indexOf("bs-FreeBet-disabled")==-1&&(f[r].setStItem("st",n),u[0].value=n,e.handle(u[0]));this._bsInst.updateState()}}};b365.Ui.Betslip.RepeatStakeClickHandler.prototype={handle:function(n){if(typeof n!="undefined"&&n&&this._isValid()){var r=n.target,i=$(this._itemElement).find(".stk:first"),t=(new b365.Ui.Formatter).padStringTo2DP(i[0].value);this._isItalianDomain&&(t=Math.floor(Number(t)));i[0].value=t;this._isValidRepeatStake(t)&&(this._itemType==this._bsInst.itemTypeSingle?(this._repeatStake(t,this._bsInst.itemTypeSingle,Number(this._itemIndex)+1),this._repeatStake(t,this._bsInst.itemTypeCast,0)):this._itemType==this._bsInst.itemTypeCast&&this._repeatStake(t,this._bsInst.itemTypeCast,Number(this._itemIndex)+1),new b365.Ui.Betslip.TotalsCalculator(this._bsInst,this._bsController).calculate())}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.RepeatStakeVisibilitySetter=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.RepeatStakeVisibilitySetter.prototype={set:function(n,t){this._isValid()&&n==0&&$blib.isDecimal(t.value)===!0&&$(".rptStake").removeClass("hidden")}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.NoReservesClickHandler=function(n,t){this._bsInst=n;this._bsController=t;this._enabled=!1;this._noReservesClickHandlers=[];this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.NoReservesClickHandler.prototype={handle:function(n){var r=this,t,i,f,e,o,u;if(typeof n!="undefined"&&n){if(r.removeHandlers(),t=n.target,i=$(t),!i.prop("disabled")&&!i.parents().prop("disabled")){switch(t.nodeName.toLowerCase()){case"div":i=$(t).find('span.checkbox[data-inp-type="nrcb"]');t=i[0];break;default:i=$(t).parent().find('span.checkbox[data-inp-type="nrcb"]');t=i[0]}r._bsInst._pollReqType===r._bsInst.reqTypePollTempBetReceipt&&r._bsInst.resetPoll();f=new b365.Ui.Betslip.ItemInformation(t);e=f.itemIndexAndType();o=f.itemElement();$(o).hasClass("suspended")||(u=$(t).hasClass("checked"),!1||(u?($(t).removeClass("checked"),u=!1):($(t).addClass("checked"),u=!0)),new b365.Ui.Betslip.NoReservesClickProcessor(this._bsInst,e[0],e[1],o).handle(u,n));r.attachHandlers()}n.stopPropagation();n.preventDefault()}},attachHandlers:function(){var n=this,i=$('div[data-inp-type="nrcb"], span[data-inp-type="nrcb"]',"#bsDiv"),t,r;if(n.removeHandlers(n),i.length==0){n._enabled=!1;return}for(t=0,r=i.length;t<r;t++)n._noReservesClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(i[t],$.proxy(n.handle,n),!1));n._enabled=!0},removeHandlers:function(){var n=this,t,i;if(n._noReservesClickHandlers.length>0){for(t=0,i=n._noReservesClickHandlers.length;t<i;t++)n._noReservesClickHandlers[t]._element&&n._noReservesClickHandlers[t].destroy();n._noReservesClickHandlers=[]}n._enabled=!1}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.NoReservesClickProcessor=function(n,t,i,r){this._bsInst=n;this._itemIndex=t;this._itemType=i;this._itemElement=r;this._noReservesCookieKey="nr";this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._itemIndex!="undefined"&&typeof this._itemType!="undefined"&&typeof this._itemElement!="undefined"};this._updateSelectionLabel=function(n){var t=$(this._itemElement).find(".no-reserves-hidden").text().split("|");$(this._itemElement).find(".selectionDescription").text(n?t[1]:t[0])}};b365.Ui.Betslip.NoReservesClickProcessor.prototype={handle:function(n,t){if(typeof t!="undefined"&&t&&this._isValid()){var i=this._bsInst.getBetItemById(this._itemType,this._itemIndex);i&&(i.setStItem(this._noReservesCookieKey,n?"1":"0"),this._bsInst.updateState(),this._updateSelectionLabel(n))}}};b365.Ui.Formatter=function(){this._to2DP=function(n){n=n.replace(",",".");var t=n.indexOf(".");return t!=-1&&n.length-t>3&&(n=n.substr(0,t+3)),n}};b365.Ui.Formatter.prototype={padStringTo2DP:function(n){var t,i;return typeof n!="string"&&(n=String(n)),n=n.replace(/,/g,"."),n=n.trim(),n==="."||n===""?n="0.00":(n=this._to2DP(n),t=n.indexOf("."),t==-1?n+=".00":(i=n.length-(t+1),i==0?n+="00":i==1&&(n+="0"))),n},numDecPlcs:function(n){typeof n!="string"&&(n=String(n));var t=".";return n.indexOf(t)>-1?n.length-n.indexOf(t)-1:0},roundValue:function(n){var u,f,t,i,r,e;if(typeof n!="string"&&(n=String(n)),n=n.trim(),n!="NaN"&&n.indexOf(".")>=0){if(f=n.split("."),t=f[0],i=f[1],i.trim().length==0)return n;i=i.length>4?i.substring(0,3):i;r=i.substring(2,3);Number(r)>=5?(r=i.substring(1,2),Number(r)==9?(e=i.substring(0,1),Number(e)==9?(t=Number(t)+1,u=t):(r=Number(e)+1,t=t+"."+r,u=t)):(r=Number(r)+1,r=String(i.substring(0,1))+String(r),t=t+"."+r,u=t)):i.length==1?(t=t+"."+i,u=t):(t=t+"."+i.substring(0,2),u=t)}else u=n===""||n=="NaN"?"":isNaN(n)?n:n;return u},roundDecimal:function(n){return typeof n!="string"&&(n=String(n)),n=n.replace(/,/g,"."),n=n.trim(),n==="."||n===""?"0.00":this.padStringTo2DP(this.roundValue(n))},round:function(n,t){return Math.round(parseFloat(n)*Math.pow(10,t))/Math.pow(10,t)},roundFixed:function(n,t){return this.round(n,t).toFixed(t)}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.AcceptChangesRequestDespatcher=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.AcceptChangesRequestDespatcher.prototype={despatch:function(){var i,f,v,o=0,s,l,h=!1,a=0,n,t,r,b,y,p,w,e,u,c;if(this._isValid()){if(window.location.host.split(".").pop()=="au"&&(i=$(".betCallDisabled"),i.length>0))if(i.length>1)new b365.Ui.Betslip.RemoveAllItemsRequestDespatcher(this._bsInst,this._bsController).despatch(null);else for(f=0,v=i.length;f<v;f++)new b365.Ui.Betslip.ItemDeleteExecutor(this._bsInst,this._bsController,i[f].getAttribute("data-item-id"),i[f].getAttribute("data-item-type")).execute();for(n=this._bsInst.getBetItems(this._bsInst.betTypeAll),t=0;t<n.length;t++)s=n[t].getStItem("olc"),e=n[t].getCnItem("id"),n[t].type==this._bsInst.betTypeNormal?(e=n[t].getCnItem("fp"),u=$('li[data-item-fpid="'+e+'"]',this._bsWrapper)):n[t].type==this._bsInst.betTypeMultiple?u=$('li[data-item-id="'+e+'"][data-item-type="multiple"]',this._bsWrapper):n[t].type==this._bsInst.betTypeCast?u=$('li[data-item-id="'+e+'"][data-item-type="cast"]',this._bsWrapper):n[t].type==this._bsInst.betTypeBetBuilder&&(a++,u=$('li[data-item-id="'+a+'"][data-item-type="betbuilder"]',this._bsWrapper)),n[t].getStItem("ft")&&n[t].getStItem("fbv")&&n[t].setStItem("rs",n[t].getStItem("fbv")),n[t].getStItem("rs")&&n[t].getStItem("rs").length>0&&(r=n[t].getStItem("rs"),n[t].setStItem("st",r),n[t].setStItem("rs",""),n[t].getStItem("ust")&&n[t].setStItem("ust",r),c=$('input[class*="stk"]',u),c.length>0&&(c[0].value=r,new b365.Ui.Betslip.StakeChangedHandler(this._bsInst,this._bsController).handle(c[0]))),l=u.attr("data-item-push"),l&&l!=""&&(s=="2"||s=="3")&&(h=!0),s&&(n[t].setStItem("olc","0"),h=!0),r=n[t].getStItem("st"),b=n[t].getStItem("ew"),y=$blib.getItemOdds(bs.betTypeNormal,n[t])||$blib.getItemOdds(bs.betTypeBetBuilder,n[t]),p=new b365.Ui.Betslip.TaxCalculator(this._bsInst),w=p.calcReturnsByLine(r,y),n[t].setStItem("tr",w),n[t].getCnItem("fp")&&n[t].getStItem("_s")!==undefined&&n[t].getStItem("_s")=="1"&&(this._bsController.itemsRemoved(n[t].getCnItem("fp"),!0),o++),n[t].type===this._bsController._bsInst.betTypeBetBuilder&&n[t].getStItem("_s")==="1"&&(this._bsController.itemsRemoved(a,!0),o++);this._bsInst.updateState();this._bsInst.betSlipItemsChanged();o>0&&(o!=n.length?h=!0:(new b365.Ui.Betslip.RemoveAllItemsRequestDespatcher(this._bsInst,this._bsController).despatch(null),new b365.Ui.Betslip.ItemSubscriptionManager(this._bsInst).unsubscribe()));h?(this._bsInst.refresh(this._bsInst.betTypeAllAccept),new b365.Ui.Betslip.ItemSubscriptionManager(this._bsInst).unsubscribe()):($(".acceptChanges",this._bsWrapper).addClass("hidden"),$("a.placeBet",this._bsWrapper).removeClass("hidden"),$(".oddsChange",this._bsWrapper).removeClass("oddsChange"),$(".hcapChange",this._bsWrapper).removeClass("hcapChange"),$(".errStk",this._bsWrapper).removeClass("errStk"),new b365.Ui.Betslip.MessageDisplayHandler(this._bsInst).hideMsg())}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.AddBetConstructDecoder=function(n,t){this._bsInst=n;this._construct=t;this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._construct!="undefined"};this._getSpecificType=function(n,t){switch(n){case this._bsInst.toteTypeUKTote:return t==this._bsInst.betTypeToteNonCast?this._bsInst.betTypeToteNonCast:t==this._bsInst.betTypeTotePot?this._bsInst.betTypeTotePot:this._bsInst.betTypeToteCast;case this._bsInst.toteTypeETote:return t==this._bsInst.betTypeToteNonCast?this._bsInst.betTypeEToteNonCast:t==this._bsInst.betTypeTotePot?this._bsInst.betTypeETotePot:this._bsInst.betTypeEToteCast;case this._bsInst.toteTypeUSTote:return t==this._bsInst.betTypeToteNonCast?this._bsInst.betTypeUsToteNonCast:t==this._bsInst.betTypeTotePot?this._bsInst.betTypeUsTotePot:this._bsInst.betTypeUsToteCast;default:return t==this._bsInst.betTypeToteNonCast?this._bsInst.betTypeFrgnToteNonCast:t==this._bsInst.betTypeTotePot?this._bsInst.betTypeFrgnTotePot:this._bsInst.betTypeFrgnToteCast}}};b365.Ui.Betslip.AddBetConstructDecoder.prototype={betType:function(){var n=bs.betTypeNormal,i,r,t;if(this._isValid())if($.isArray(this._construct)){if(this._construct[0].stype&&this._construct[0].cmask){i=this._construct[0].stype;r=this._construct[0].ttype;switch(i){case"N":case"I":n=this._bsInst.betTypeCast;break;case"A":case"O":t=new b365.Ui.Betslip.CastMaskInfo(this._construct[0].cmask);n=t.isToteCast(i)?this._bsInst.betTypeCast:t.isTotePot()?this._bsInst.betTypeTotePotAus:this._bsInst.betTypeCast;break;case"T":case"R":case"J":case"E":t=new b365.Ui.Betslip.CastMaskInfo(this._construct[0].cmask);n=t.isToteCast(i)?this._getSpecificType(r,this._bsInst.betTypeToteCast):t.isTotePot()?this._getSpecificType(r,this._bsInst.betTypeTotePot):this._getSpecificType(r,this._bsInst.betTypeToteNonCast)}}}else this._construct.indexOf("bc=")>-1?n=bs.betTypeMultiple:this._construct.indexOf("il=")>-1&&(n=bs.betTypeBetBuilder);return n}},function(){Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.AddBetHandler=function(n,t){typeof $displayHelper!="undefined"&&(n._betItems.length==0&&$displayHelper.isPortraitMode()&&$displayHelper.isPrematch()&&window.MyBetsController.isInitialised()?window.MyBetsController.showBetSlip():$displayHelper.isPortraitMode()&&!$displayHelper.isPrematch()&&window.MyBetsController.isInitialised()?window.MyBetsController.showBetSlip():!$displayHelper.isPortraitMode()&&window.MyBetsController.isInitialised()&&window.MyBetsController.showBetSlip());this._bsInst=n;this._controller=t;this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._controller!="undefined"};this._getConstruct=function(n){var t=n;return typeof n=="string"||$.isArray(n)||(t=Array.prototype.slice.call(n)[0]),t||(t=n.ConstructString),t};this._failedToAddBet=function(n,t){t===this._bsInst.betTypeNormal&&n.length>0&&$("#bsDiv").trigger("b365.Ui.Betslip.failedtoaddbet",n[0])};this._duplicateCheck=function(n){for(var r=new b365.Ui.Betslip.DuplicateItemValidator(this._bsInst),i=!1,t=0;t<n.length&&!i;t++)i=r.isDuplicate(n[t]);return i}};b365.Ui.Betslip.AddBetHandler.prototype={handle:function(n,t,i){var w,a,y,l;if(this._isValid()){var r=[],o=[],f=this._getConstruct(n),b=new b365.Ui.Betslip.AddBetConstructDecoder(this._bsInst,f),s,h,c,e=!0,u=b.betType();if(this._bsInst.getPendingPushBetStatus()>0){w=new b365.Ui.Betslip.PushBetDialog(this._bsInst,this._controller,f,this._bsInst.getPendingPushBetStatus());return}if(f.indexOf("pom")>-1&&this._controller.betCallTwilioEnabled()&&!sProps.microphonePermissionGranted){this._controller.showEnableMicrophoneMessage();return}if(a=$("#bsDiv .betReceipt"),this._bsInst.setClearOnAdd(t===!0||a.length>0&&a.is(".visible")),s=this._bsInst.getClearOnAdd(),y=new b365.Ui.Betslip.AddBetTypeValidator(this._bsInst,this._controller).validate(u,f),s||y){if(this._bsInst._pollReqType===this._bsInst.reqTypePollTempBetReceipt&&this._bsInst.resetPoll(),u===this._bsInst.betTypeFrgnToteCast&&(f=new b365.Ui.Betslip.ForeignToteConstructCorrector(this._bsInst,f).GetCorrectedConstruct()),r=new b365.Ui.Betslip.AddBetItemsBuilder(this._bsInst,f).betItems(u),r.length>14&&(r=r.slice(0,14),this._bsInst.maxSelections()),s||(h=this._bsInst.okToAdd(r.length))){if(c=s,s){for(var v=0,p=this._bsInst.getBetItems(u),k=p.length;v<k;v++)this._controller.itemsRemoved(p[v].getCnItem("fp"));this._bsInst.clearBets(!1);h=this._bsInst.okToAdd(r.length)}else o=this._bsInst.getBetItems(u),c=!this._duplicateCheck(r);c&&h?(o.length===0&&(new b365.Ui.Betslip.DefaultSlipTypeSetter(this._bsInst).setSlipType(u),this._bsInst.showBetSlip()),this._controller.isReqOnBetAddedEnabled()&&this._bsInst.locked()||(o=o.concat(r),this._bsInst.setBetItems(o,u),this._bsInst.updateState(),this._bsInst.betAdded(r),this._bsInst.betSlipItemsChanged()),this._controller.isReqOnBetAddedEnabled()&&(this._bsInst.req(this._bsInst.reqTypeAddItems)||(this._failedToAddBet(r,u),e=!1))):c||(this._bsInst.unlock(),new b365.Ui.Betslip.InProgressDisplayHandler(this._bsInst,this._controller).handle(["hide",betSlipML.duplicateselection]),e=!1)}if(h||(this._bsInst.unlock(),new b365.Ui.Betslip.InProgressDisplayHandler(this._bsInst,this._controller).handle(["hide",u==this._bsInst.betTypeCast?betSlipML.tomanyselection:betSlipML.maxselections]),this._bsInst.maxSelections(),this._duplicateCheck(r)||(this._failedToAddBet(r,u),e=!1)),e||this._controller.itemsRemoved(r[0].getCnItem("fp")),e){var d=this._controller&&this._controller.betCallEnabled(),g=this._controller&&this._controller.betCallTwilioEnabled(),nt=this._bsInst.containsPhoneOnlyBet(),tt=this._controller._delegates.isAuthenticated();nt&&(tt?(l=this._bsInst.getClickToCallHandler(),l||(d&&(l=new b365.Ui.Betslip.BetCallHandler(this._bsInst,this._controller,g)),this._bsInst.setClickToCallHandler(l))):this._controller.betCallLoginPopupDisplayed||(this._controller.betCallLoginPopupDisplayed=!0,this._controller.clientLoginDelegate()));this._controller.complexMultiplesCombinationsInit=!0}e&&i&&typeof i=="function"&&i.call(this,r[0].getCnItem("id")||r[0].getCnItem("fp"))}else{if(u==this._bsInst.betTypeBetBuilder){if(this._bsInst.getSlipType()==this._bsInst.slipStandard){$log("Rejected BetBuilder Addbet action: Validation failure");Locator.participantEvents.dispatchEvent(new ns_betslip.BetSlipEvent("bb_maxExceeded"));return}Locator.participantEvents.dispatchEvent({type:"bb_incompatible"})}new b365.Ui.Betslip.ConfirmationDialog(this._bsInst,this._controller).showIncompatibleSelectionsDialog(f)}}}}}(),function(){Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.DeleteBetHandler=function(n,t){this._bsInst=n;this._controller=t;this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._controller!="undefined"}};b365.Ui.Betslip.DeleteBetHandler.prototype={handle:function(n){if(this._isValid()){var t=$blib.getBetItemIndex(n,this._bsInst);t!=-1&&new b365.Ui.Betslip.ItemDeleteExecutor(this._bsInst,this._controller,t,this._bsInst.betTypeNormal).execute()}}}}();Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.AddBetItemsBuilder=function(n,t){this._bsInst=n;this._construct=t;this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._construct!="undefined"}};b365.Ui.Betslip.AddBetItemsBuilder.prototype={betItems:function(n){var t=[];if(this._isValid())switch(n){case this._bsInst.betTypeCast:case this._bsInst.betTypeToteCast:case this._bsInst.betTypeUsToteCast:case this._bsInst.betTypeEToteCast:case this._bsInst.betTypeFrgnToteCast:t=new b365.Ui.Betslip.CastBetItemsBuilder(this._bsInst,this._construct).betItems();break;case this._bsInst.betTypeToteNonCast:case this._bsInst.betTypeUsToteNonCast:case this._bsInst.betTypeEToteNonCast:case this._bsInst.betTypeTotePot:case this._bsInst.betTypeUsTotePot:case this._bsInst.betTypeETotePot:case this._bsInst.betTypeFrgnToteNonCast:case this._bsInst.betTypeFrgnTotePot:case this._bsInst.betTypeTotePotAus:t=new b365.Ui.Betslip.ToteBetItemsBuilder(this._bsInst,this._construct).betItems();break;case this._bsInst.betTypeNormal:case this._bsInst.betTypeBetBuilder:t.push(new b365.Ui.BetDTO(n));t[0].parse(this._construct)}return t}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.AddBetTypeEToteValidator=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.AddBetTypeEToteValidator.prototype={validate:function(n){var t=!1;return this._isValid()&&(t=n==this._bsInst.betTypeEToteCast||n==this._bsInst.betTypeEToteNonCast||n==this._bsInst.betTypeETotePot),t}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.AddBetTypeIfRevIfBankerTeaserValidator=function(n,t){this._bsInst=n;this._construct=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.AddBetTypeIfRevIfBankerTeaserValidator.prototype={validate:function(n){var t=!1;return this._isValid()&&(t=n==this._bsInst.betTypeNormal,this._construct&&typeof this._construct=="string"&&(this._construct.indexOf("c=2110")>-1||this._construct.indexOf("c=2111")>-1))?!1:t}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.AddBetTypeStandardValidator=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.AddBetTypeStandardValidator.prototype={validate:function(n){var i=!0,t=this._bsInst.getBetItems(this._bsInst.betTypeTotePotAus);return n==this._bsInst.betTypeTotePotAus?i=t.length>0&&(t[0].getCnItem("spt")=="A"||t[0].getCnItem("spt")=="O")&&new b365.Ui.Betslip.CastMaskInfo(t[0].getCnItem("cm")).isTotePot():n==bs.betTypeBetBuilder?i=this._validateBetBuilder():(i=!(t.length>0&&(t[0].getCnItem("spt")=="A"||t[0].getCnItem("spt")=="O")&&new b365.Ui.Betslip.CastMaskInfo(t[0].getCnItem("cm")).isTotePot()),i&&(i=n==this._bsInst.betTypeNormal||n==this._bsInst.betTypeCast||n==bs.betTypeFrgnToteCast||n==bs.betTypeFrgnToteNonCast||n==bs.betTypeFrgnTotePot)),i},_validateBetBuilder:function(){var n;return n=this._bsInst.getBetItems(this._bsInst.betTypeBetBuilder),!n||n.length<4}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.AddBetTypeUkToteValidator=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.AddBetTypeUkToteValidator.prototype={validate:function(n){var t=!1;return this._isValid()&&(t=n==this._bsInst.betTypeToteCast||n==this._bsInst.betTypeToteNonCast||n==this._bsInst.betTypeTotePot),t}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.AddBetTypeUsToteValidator=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.AddBetTypeUsToteValidator.prototype={validate:function(n){var t=!1;return this._isValid()&&(t=n==this._bsInst.betTypeUsToteCast||n==this._bsInst.betTypeUsToteNonCast||n==this._bsInst.betTypeUsTotePot),t}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.AddBetTypeValidator=function(n,t){this._bsInst=n;this._controller=t;this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._controller!="undefined"}};b365.Ui.Betslip.AddBetTypeValidator.prototype={validate:function(n,t){var i=!0;if(this._bsInst.numItems()>0)switch(this._bsInst.getSlipType()){case this._bsInst.slipStandard:i=new b365.Ui.Betslip.AddBetTypeStandardValidator(this._bsInst).validate(n);break;case this._bsInst.slipBanker:case this._bsInst.slipIF:case this._bsInst.slipReverseIF:case this._bsInst.slipFixedTeaser:i=new b365.Ui.Betslip.AddBetTypeIfRevIfBankerTeaserValidator(this._bsInst,t).validate(n);n==this._bsInst.slipFixedTeaser||i||n!=this._bsInst.betTypeCast||(this._bsInst.setValueInBSCookie("bt",this._bsInst.slipStandard),i=!0);break;case this._bsInst.slipUKTote:i=new b365.Ui.Betslip.AddBetTypeUkToteValidator(this._bsInst).validate(n);break;case this._bsInst.slipUSTote:i=new b365.Ui.Betslip.AddBetTypeUsToteValidator(this._bsInst).validate(n);break;case this._bsInst.slipETote:i=new b365.Ui.Betslip.AddBetTypeEToteValidator(this._bsInst).validate(n)}return i}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.CastMaskInfo=function(n){this._castmask=n;this._isValid=function(){return typeof this._castmask!="undefined"}};b365.Ui.Betslip.CastMaskInfo.prototype={isToteCast:function(n){return n=="J"&&this._castmask!="D"?!0:this._castmask=="E"||this._castmask=="T"||this._castmask=="W"||this._castmask=="S"||this._castmask=="Q"},isTotePot:function(){return this._castmask=="P"||this._castmask=="U"||this._castmask=="J"||this._castmask=="6"||this._castmask=="7"||this._castmask=="2"||this._castmask=="3"||this._castmask=="4"}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.CastBetItemsBuilder=function(n,t){this._bsInst=n;this._construct=t;this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._construct!="undefined"};this._getTotePotItemConstructs=function(n,t){for(var f=[],e="#fp=",u,r,i=0;i<t.valuelist.length;i++)for(u=0;u<t.valuelist[i].length;u++)r=t.valuelist[i][u].split(":"),i===0&&u===0&&(n+="#cm="+r[2]+"#tmn="+r[4]+"#tmi="+r[3]),e+=r[5]+":"+r[0]+":"+r[6]+":"+r[1]+(i==t.valuelist.length-1&&u==t.valuelist[i].length-1?"":",");return f.push(n+e+(t.mediaType!==""?"|#mt="+t.mediaType+"#":"")),f};this._getCombinations=function(n,t){for(var r=[],u=t[0],f,i=0;i<u.length;i++)n.indexOf(u[i])==-1&&(f=n+(n===""?"":",")+u[i],t.length>1&&t[1]?r=r.concat(this._getCombinations(f,t.slice(1))):r.push(f));return r};this._getNoneTotePotItemConstructs=function(n,t){var u=[],r="#fp=",f,i;if(t.ctype=="C"||t.cmask=="Q"){for(i=0;i<t.valuelist[0].length;i++)r+=t.valuelist[0][i]+(i==t.valuelist[0].length-1?"":",");u.push(n+r)}else if(t.ctype=="B"){for(r+=t.valuelist[0],i=1;i<t.valuelist.length;i++)t.valuelist[i]&&(r+=","+t.valuelist[i].toString());u.push(n+r+(t.mediaType!==""?"|#mt="+t.mediaType+"#":""))}else for(f=this._getCombinations("",t.valuelist),i=0;i<f.length;i++)u.push(n+r+f[i]+(t.mediaType!==""?"|#mt="+t.mediaType+"#":""));return u};this._getAusCastItemConstructs=function(n,t){for(var u=[],r="#fp=",i=0;i<t.valuelist.length;i++)t.valuelist[i]&&(r+=t.valuelist[i].join(",")),i!=t.valuelist.length-1&&t.valuelist[i+1]&&(r+="~");return u.push(n+r+"|#atc="+t.atcValue+"#"+(t.mediaType!==""?"mt="+t.mediaType+"#":"")),u};this._isItalyExotics=function(n){if(n.stype!=="I")return!1;var t=this._italianExoticsCastMaskLookup[n.cmask];return!!t&&!!t[n.ctype]};this._getItalyExoticsNXP1CastItemConstructs=function(n,t){var e=[],i,r,u,f;return t.valuelist[0]&&!t.valuelist[1]?i=t.valuelist[0]:t.valuelist[0]&&t.valuelist[1]&&!t.valuelist[2]?(r=t.valuelist[0],u=t.valuelist[1]):t.valuelist[0]&&t.valuelist[1]&&t.valuelist[2]&&(i=t.valuelist[0],r=t.valuelist[1],u=t.valuelist[2]),i&&(f="#fp="+i.join(","),e.push(n+f+"|"+(t.mediaType!==""?"mt="+t.mediaType+"#":""))),r&&u&&(f="#fp="+r.join(",")+"~"+u.join(","),n=n.replace("ct=N","ct=O"),e.push(n+f+"|"+(t.mediaType!==""?"mt="+t.mediaType+"#":""))),e};this._getItalyExoticsCastItemConstructs=function(n,t){for(var u=[],r="#fp=",i=0;i<t.valuelist.length;i++)t.valuelist[i]&&(r+=t.valuelist[i].join(",")),i!=t.valuelist.length-1&&t.valuelist[i+1]&&(r+="~");return u.push(n+r+"|"+(t.mediaType!==""?"mt="+t.mediaType+"#":"")),u}};b365.Ui.Betslip.CastBetItemsBuilder.prototype={betItems:function(){for(var o=[],t="",n,i,r,f,e,u=0;u<this._construct.length;u++){if(n=this._construct[u],t==="")switch(n.ttype){case this._bsInst.toteTypeUKTote:t=this._bsInst.betTypeToteCast;break;case this._bsInst.toteTypeETote:t=this._bsInst.betTypeEToteCast;break;case this._bsInst.toteTypeUSTote:t=this._bsInst.betTypeUsToteCast;break;case this._bsInst.toteTypeForeignTote:t=this._bsInst.toteTypeForeignTote;break;default:t=this._bsInst.betTypeCast}if(i="pt="+(t==this._bsInst.betTypeCast?"C":"T")+"B#spt="+n.stype+(n.cmask=="P"?"":"#cm="+n.cmask)+"#ct="+n.ctype+(n.c2ID?"#c2="+n.c2ID:"#f="+n.fixid)+(n.classificationId?"#c="+n.classificationId:""),n.cmask=="P")r=this._getTotePotItemConstructs(i,n);else if(this._isItalyExotics(n))r=n.cmask=="0"||n.cmask=="1"?this._getItalyExoticsNXP1CastItemConstructs(i,n):this._getItalyExoticsCastItemConstructs(i,n);else switch(n.stype){case"A":case"O":r=this._getAusCastItemConstructs(i,n);break;default:r=this._getNoneTotePotItemConstructs(i,n)}for(f=0;f<r.length;f++)e=new b365.Ui.BetDTO(t),e.parse(r[f]),o.push(e)}return o},_italianExoticsCastMaskLookup:{"0":{N:!0,O:!0},"1":{N:!0,O:!0},"2":{N:!0,O:!0,T:!0,U:!0},"3":{N:!0,O:!0,Z:!0,T:!0,U:!0,V:!0},"4":{N:!0,O:!0,Z:!0,Q:!0,T:!0,U:!0,V:!0,W:!0},"5":{N:!0,O:!0,Z:!0,Q:!0,R:!0,T:!0,U:!0,V:!0,W:!0,X:!0}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ToteBetItemsBuilder=function(n,t){this._bsInst=n;this._construct=t;this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._construct!="undefined"};this._addWinEwPlBet=function(n,t,i){var u,r;n+="#f="+t.fixid;n+=t.stype=="J"?"#o=0/0":"";n+=t.id?"#id="+t.id:"";var f=t.ctype=="E"||t.ctype=="H",o=f?":":",",e="#fp=";if(f)for(r=0;r<t.valuelist[0].length;r++)i.push(n+e+t.valuelist[0][r]);else for(u=t.valuelist[0].slice(o),r=0;r<u.length;r++)i.push(n+e+u[r])};this._addPotBet=function(n,t,i,r){n+="#tmn="+t.totemn+"#tmi="+t.totemi+"#c2="+t.c2ID;i.push(n+this._getTotePotFid(t)+this._getTotePotFp(t)+(r==bs.betTypeTotePotAus?"|#atc="+t.atcValue:""))};this._getTotePotFp=function(n){for(var t="#fp=",r,i=0;i<n.valuelist.length;i++){for(r=0;r<n.valuelist[i].length;r++)t+=n.valuelist[i][r]+"-";t.endsWith("-")&&(t=t.substring(0,t.lastIndexOf("-")));t+=","}return t.endsWith(",")&&(t=t.substring(0,t.lastIndexOf(","))),t};this._getTotePotFid=function(n){return n.fixid&&n.fixid!=""?"#f="+n.fixid:""}};b365.Ui.Betslip.ToteBetItemsBuilder.prototype={betItems:function(n){var o=[],r,t,u,i,f,e;if(this._isValid())for(r=0;r<this._construct.length;r++){t=this._construct[r];t.stype!="T"&&t.stype!="E"&&t.ctype=="E"&&(t.ctype="H");u="pt=TB#spt="+t.stype+"#cm="+t.cmask;i=[];switch(t.cmask){case"D":u+="#ct="+t.ctype;this._addWinEwPlBet(u,t,i);break;default:this._addPotBet(u,t,i,n)}for(f=0;f<i.length;f++)e=new b365.Ui.BetDTO(n),e.parse(i[f]),o.push(e)}return o}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.DefaultSlipTypeSetter=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.DefaultSlipTypeSetter.prototype={setSlipType:function(n){if(this._isValid()){var t=this._bsInst.slipStandard;switch(n){case this._bsInst.betTypeToteCast:case this._bsInst.betTypeToteNonCast:case this._bsInst.betTypeTotePot:t=this._bsInst.slipUKTote;break;case this._bsInst.betTypeUsToteCast:case this._bsInst.betTypeUsToteNonCast:case this._bsInst.betTypeUsTotePot:t=this._bsInst.slipUSTote;break;case this._bsInst.betTypeEToteCast:case this._bsInst.betTypeEToteNonCast:case this._bsInst.betTypeETotePot:t=this._bsInst.slipETote}this._bsInst.setValueInBSCookie("bt",t)}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.DuplicateItemValidator=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.DuplicateItemValidator.prototype={isDuplicate:function(n){var r=!1,t;if(this._isValid()){if(n.type==bs.betTypeBetBuilder)return!1;var i=this._bsInst.getBetItems(n.type),f=n.getCnItem("pt"),u=function(n,t){return n.getCnItem("spt")===t.getCnItem("spt")&&n.getCnItem("cm")===t.getCnItem("cm")&&n.getCnItem("ct")===t.getCnItem("ct")&&n.getCnItem("f")===t.getCnItem("f")&&n.getCnItem("fp")===t.getCnItem("fp")};for(t=0;!r&&t<i.length;t++)switch(f){case"S":r=i[t].getCnItem("pid")===n.getCnItem("pid")&&i[t].getCnItem("mid")===n.getCnItem("mid");break;case"CB":r=u(n,i[t]);break;case"TB":switch(n.type){case bs.betTypeToteCast:case bs.betTypeUsToteCast:case bs.betTypeEToteCast:case bs.betTypeToteNonCast:case bs.betTypeUsToteNonCast:case bs.betTypeEToteNonCast:r=u(n,i[t])}break;default:i[t].getCnItem("fp")===n.getCnItem("fp")&&i[t].getCnItem("f")==n.getCnItem("f")&&i[t].getCnItem("pt")!=="S"&&(r=i[t].getCnItem("Inc")==n.getCnItem("Inc")?!0:!1)}}return r}},function(){Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.InProgressDisplayHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"};this._setText=function(n){$("#bsDiv #pro>ul>li .progressMsg").html(n)}};b365.Ui.Betslip.InProgressDisplayHandler.prototype={handle:function(n){var f=n[0],r=n[1],e=n.length>3?n[3]:"alert",s=n.length>4&&n[4]!=="undefined"?n[4]:!0,u,t,i,o;this._isValid()&&(i=n[2],f=="show"?(o=i==this._bsInst.reqTypeBetBrk,i==this._bsInst.reqTypeReferBet||i==this._bsInst.reqTypePollReferredBet?this._setText(betSlipML.processingbet+"<br/><br/>"+betSlipML.additionalstakereferred):i==this._bsInst.reqTypePollTempBetReceipt&&this._setText(betSlipML.processingbet),new b365.Ui.Betslip.EnhancedElementsLockUnlockHandler(this._bsInst,this._bsController).lock()):(this._bsInst.isSiteOverlaySpinnerShowing&&(this._bsInst.isSiteOverlaySpinnerShowing=!this._bsController.hideSiteOverlaySpinner()),t=$("#bsDiv"),$("#bsDiv #pro").addClass("hidden"),t.hasClass("receipt")&&t.find(".footer").removeClass("hidden"),this._bsController.clientActionInProgress(!1),r&&new b365.Ui.Betslip.MessageDisplayHandler(this._bsInst,this._bsController).showMsg(r,e),this._bsController&&this._bsController.clientEnhancedMode()&&$("li",t).hasClass("disabledBetSlip")&&($("li",t).hasClass("disableBetSlip")||$("li",t).hasClass("disabledBetSlip"))&&(u=$('li[data-item-type$="multiple"], li[data-item-type$="single"], li[data-item-type$="cast"], li[data-item-type$="tote-single"], li[data-item-type$="tote-cast"], li[data-item-type$="tote-pot"], li[data-item-type$="tote-pot-leg"]',t),this._bsController._enhancedBetSlipAnimations.enableBetSlip(u,t)),new b365.Ui.Betslip.EnhancedElementsLockUnlockHandler(this._bsInst,this._bsController).unlock()),this._bsInst.contentChangedOnClient())}}}(),function(){Type.registerNamespace("b365.Ui.Betslip");var n;b365.Ui.Betslip.ConfirmationDialog=function(t,i){this._bsInst=t;this._controller=i;this._closeAction="close";this._referAction="refer";this._italyConfirmStakes="icStakes";this._clearAndAddAction="clearAndAdd";this._isValid=function(){return typeof this._bsInst!="undefined"};this._clearDialogAndConstruct=function(){n=null;this._controller.ClearCurrentDialogRef()};this._handleCancel=function(){this.hideDialog();this._clearDialogAndConstruct();Locator.participantEvents.dispatchEvent(new ns_betslip.BetSlipEvent("InCompatibleCancel"))};this._handleClearAndAdd=function(){function r(n){this._controller.addToBetsBank(n)}var t=this,i=n;this.hideDialog();this._clearDialogAndConstruct();window.bsApp.removeBets();new b365.Ui.Betslip.AddBetHandler(this._bsInst,this._controller).handle(i,!0,r);window.mobileLazyLoaders.addAndLoadFiles([window.mobileLazyLoaders.lazyLoaderTypes.betslipStyles],function(){t._controller.refreshBetslip()});Locator.participantEvents.dispatchEvent(new ns_betslip.BetSlipEvent("InCompatibleClear"))};this._handleRefer=function(){new b365.Ui.Betslip.ReferBetRequestDespatcher(this._bsInst,this._controller).despatch()}};b365.Ui.Betslip.ConfirmationDialog.prototype={showIncompatibleSelectionsDialog:function(t){var r=this,i=!1;typeof t!="undefined"&&t&&(n=t,t.indexOf("pom")>-1?i=!0:(items=this._bsInst.getBetItems(),i=items.length>0&&items[0].getStItem("pom")=="Y"),r._controller.showConfirmation(r,"",i?betSlipML.incompatiblectcselectionsclear:betSlipML.incompatibleselectionsclear,i?betSlipML.ok:betSlipML.cont,this._clearAndAddAction,betSlipML.cancel,this._closeAction,"incompDialogue",!0))},handleClick:function(n){var i=$(n.target),r=i.attr("data-action"),t;if(n.preventDefault(),n.stopPropagation(),!i.hasClass("disabled"))switch(r){case this._closeAction:$("#closeButton").removeClass("disabled");$("#okButton").removeClass("disabled");this._handleCancel();break;case this._clearAndAddAction:$("#closeButton").removeClass("disabled");$("#okButton").removeClass("disabled");this._handleClearAndAdd();break;case this._referAction:$("#closeButton").addClass("disabled");t=$("#okButton");t.addClass("disabled");t[0].innerHTML=window.betSlipML.referringBet+'<span class="buttonSpinner"><\/span>';this._handleRefer();break;case this._italyConfirmStakes:this._bsInst.req(this._bsInst.reqTypeItalySplitStakeConfirm);this.hideDialog()}},setDialog:function(n){this._controller.SetCurrentDialogRef(n)}};b365.Ui.Betslip.ConfirmationDialog.prototype.hideDialog=function(){this._controller._dlg&&this._controller._dlg.hideDialog()}}(),function(){Type.registerNamespace("b365.Ui.Betslip");var n={None:0,SystemDrawNoBet:5,SystemHandicap:6,SystemTotals:7,AsianHcapQtrPointAboveInt:8,AsianHcapQtrPointBelowInt:9,GoalLineQtrPointAboveIntUnderOrBelowIntOver:10,GoalLineQtrPointBelowIntUnderOrAboveIntOver:11,AsianHcapInPlayWholePoint:12,AsianHcapInPlayHalfPoint:13,AsianHcapInPlayQtrPointAboveInt:14,AsianHcapInPlayQtrPointBelowInt:15,GoalLineHalfPoint:16,GoalLineWholePoint:17};b365.Ui.Betslip.PushBetDialog=function(n,t,i,r,u,f){this._bsInst=n;this._controller=t;this._construct=i;this._pushStatus=r;this._betItemId=u;this._betItemType=f;this._proceedAction="ipProceed";this._cancelAction="ipCancel";this._clearDialogAndConstruct=function(){this._construct=null;this._controller.ClearCurrentDialogRef()};this._handleCancel=function(){this._betItemId&&this._betItemType&&new b365.Ui.Betslip.ItemDeleteExecutor(this._bsInst,this._controller,"0","single").execute();this.hideDialog();this._clearDialogAndConstruct()};this._handleProceed=function(){this._controller.addBet(this._construct);this._controller.highlightSelectedBets();this.hideDialog();this._clearDialogAndConstruct()};Locator.pushedConfig.getIsPSQFV4Enabled()?this.checkIfRequired():this._controller.showDialog(this,this.buildPushBetMessage(),!0)};b365.Ui.Betslip.PushBetDialog.prototype={checkIfRequired:function(){var n=new ns_gen5_net.Loader,t=this;n.completeHandler=function(i,r){t.checkIfRequiredComplete(i,r);n=null};n.errorHandler=function(i){t.checkIfRequiredFailed(i);n=null};n.load("/betSlip/quickbet.ashx?op=26&_"+(new Date).getTime(),{method:"POST",urlVariables:new ns_gen5_net.URLVariables("ns="+this._construct),contentType:"application/x-www-form-urlencoded",withCredentials:!0})},checkIfRequiredComplete:function(n){JSON.parse(n).message?this._controller.showDialog(this,this.buildPushBetMessage(),!0):(this._controller._bsInst.setPendingPushBet(0),this._controller.addBet(this._construct),this._controller.highlightSelectedBets())},checkIfRequiredFailed:function(){this._controller.showDialog(this,this.buildPushBetMessage(),!0)},buildPushBetMessage:function(){var t="",h,c,i,o,e,s,r,u,f,l;if((this._pushStatus==="undefined"||this._pushStatus===null)&&(h=$("li[data-item-id]","#bsDiv"),c=h[h.length-1],this._pushStatus=parseInt(c.getAttribute("data-item-push"))),this._pushStatus===n.None||this._pushStatus===n.AsianHcapInPlayHalfPoint||this._pushStatus===n.GoalLineHalfPoint)return"";switch(this._pushStatus){case n.SystemDrawNoBet:t=window.betSlipML.pushDrawNoBetBody;break;case n.SystemHandicap:t=window.betSlipML.pushHandicapBody;break;case n.SystemTotals:case n.GoalLineWholePoint:t=window.betSlipML.pushTotalBody;break;case n.AsianHcapQtrPointAboveInt:case n.AsianHcapInPlayQtrPointAboveInt:t=window.betSlipML.pushAsianHandicapHalfWinningBody;break;case n.AsianHcapQtrPointBelowInt:case n.AsianHcapInPlayQtrPointBelowInt:t=window.betSlipML.pushAsianHandicapHalfLosingBody;break;case n.GoalLineQtrPointAboveIntUnderOrBelowIntOver:t=window.betSlipML.pushGoalLineHalfWinningBody;break;case n.GoalLineQtrPointBelowIntUnderOrAboveIntOver:t=window.betSlipML.pushGoalLineHalfLosingBody;break;case n.AsianHcapInPlayWholePoint:t=window.betSlipML.pushAsianHandicapInPlayWholePoint;break;default:return""}return f=document.createElement("a"),f.textContent=window.betSlipML.pushLinkText,f.setAttribute("data-action","href"),l="http://"+window.location.hostname.replace("mobile","help")+this._controller.pushBetRulesLink(),f.setAttribute("href",l),f.setAttribute("target","_blank"),i=document.createElement("div"),i.setAttribute("id","italy-push-message"),i.setAttribute("class","mobile"),o=document.createElement("h3"),o.setAttribute("id","italy-push-message-title"),o.innerText=window.betSlipML.pushMessageTitle,i.appendChild(o),e=document.createElement("div"),e.setAttribute("id","italy-push-message-body"),e.innerHTML=t,i.appendChild(e),s=document.createElement("p"),s.setAttribute("id","italy-push-message-more-info-link"),s.innerHTML=f.outerHTML,e.appendChild(s),r=document.createElement("a"),r.setAttribute("class","italy-push-message-button"),r.setAttribute("id","okButton"),r.setAttribute("data-action","ipProceed"),r.innerText=window.betSlipML.ok,i.appendChild(r),sProps.instantBet||(u=document.createElement("a"),u.setAttribute("class","italy-push-message-button"),u.setAttribute("id","closeButton"),u.setAttribute("data-action","ipCancel"),u.innerText=window.betSlipML.pushMarketCancel,i.appendChild(u)),this._controller._bsInst.setPendingPushBet(0),i},handleClick:function(n){var t=$(n.target),i=t.attr("data-action");if(n.preventDefault(),n.stopPropagation(),!t.hasClass("disabled"))switch(i){case this._cancelAction:this._handleCancel();break;case this._proceedAction:this._handleProceed()}},setDialog:function(n){this._controller.SetCurrentDialogRef(n)}};b365.Ui.Betslip.PushBetDialog.prototype.hideDialog=function(){this._controller._dlg&&this._controller._dlg.hideDialog()}}();Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.BetMaxRequestDespatcher=function(n,t){this._bsInst=n;this._bsController=t;this._maxBetKeySingles="N";this._maxBetKeyCasts="C";this._maxBetKeyMultiples="M";this._maxBetKeyBetBuilder="B";this._maxBetItemTypeSingle="1";this._maxBetItemTypeBetBuilder="22";this._maxBetItemTypeCast="50";this._getKey=function(n){return n==this._bsInst.itemTypeSingle?this._maxBetKeySingles:n==this._bsInst.itemTypeCast?this._maxBetKeyCasts:n==this._bsInst.itemTypeBetBuilder?this._maxBetKeyBetBuilder:this._maxBetKeyMultiples};this._getMaxBetItemType=function(n,t){return n==this._bsInst.itemTypeSingle?this._maxBetItemTypeSingle:n===this._bsInst.itemTypeBetBuilder?this._maxBetItemTypeSingle:n==this._bsInst.itemTypeCast?this._maxBetItemTypeCast:this._bsInst.getBetItemById(this._bsInst.itemTypeMultiple,t).getCnItem("id")}};this._isValid=function(){return typeof this._bsInst!="undefined"};this._getMaxBetType=function(n){return n==this._bsInst.itemTypeSingle?this._bsInst.betTypeNormal:n==this._bsInst.itemTypeCast?this._bsInst.betTypeCast:n==this._bsInst.itemTypeBetBuilder?this._maxBetItemTypeBetBuilder:this._bsInst.betTypeMultiple};b365.Ui.Betslip.BetMaxRequestDespatcher.prototype={despatch:function(n){if(this._isValid())if(this._bsController._delegates.isAuthenticated()){var i=new b365.Ui.Betslip.ItemInformation(n),t=i.itemIndexAndType();this._bsInst.req(this._bsInst.reqTypeMaxBet,"key="+this._getKey(t[1])+"-"+t[0]+"-"+this._getMaxBetItemType(t[1],t[0])+"-"+this._getMaxBetType(t[1]))}else new b365.Ui.Betslip.MessageDisplayHandler(this._bsInst).showMsg(betSlipML.pleaselogin)}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.IfBetActionChangeHandler=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.IfBetActionChangeHandler.prototype={handle:function(n,t){var u,i;if(n>0)u=this._bsInst.getBetItemById(this._bsInst.betTypeNormal,n),u.setStItem("ac",t.value);else{var f=this._bsInst.getBetItems(this._bsInst.betTypeNormal),r=$("#bsDiv .ifbetaction"),e=$(t).find("option:selected").text();for(i=0;i<f.length;i++)f[i].setStItem("ac",t.value),r[i].selectedIndex=t.value==r[i].options[0].value?0:1,$(r[i]).parent(".betslip-select").attr("data-text",e)}this._bsInst.updateState()}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.BankerToggleRequestDespatcher=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.BankerToggleRequestDespatcher.prototype={despatch:function(n){var t=$(n.target),i=n.target,r,u,f;this._isValid()&&(t.hasClass("bankerIndicatorWrapper")&&(t=t.find("button"),i=t[0]),i.tagName.toLowerCase()=="button"&&(r=new b365.Ui.Betslip.ItemInformation(i),u=r.itemIndexAndType(),f=this._bsInst.getBetItemById(this._bsInst.betTypeNormal,u[0]),f.setStItem("bk",t.hasClass("selected")?"0":"1"),this._bsInst.toggledBankerSelectionState=!0,this._bsInst.updateState(),this._bsInst.refresh(this._bsInst.betTypeAll)))}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.OddsChangeHandler=function(n,t){this._bsInst=n;this._bsController=t;this._serverErrorReqType=99;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.OddsChangeHandler.prototype={handle:function(n,t){if(this._isValid()){var i=n.target,r=this._bsInst.getBetItemById(this._bsInst.betTypeNormal,t);i.value=="SP"?(r.setStItem("sp","1"),r.setStItem("tr","")):r.setStItem("sp","0");$(i).parent(".betslip-select").attr("data-text",$(i).find("option:selected").text());this._bsInst.updateState();new b365.Ui.Betslip.TotalsCalculator(this._bsInst,this._bsController).calculate()}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.OddsLineChangedHandler=function(n,t){this._bsInst=n;this._bsController=t;this._bsWrapper=$("#bsDiv");this._isValid=function(){return typeof this._bsInst!="undefined"};this._roundDown=function(n,t){return t=t||0,Math.floor(n*Math.pow(10,t))/Math.pow(10,t)}};b365.Ui.Betslip.OddsLineChangedHandler.prototype={handle:function(n){var i,h,f,r,e,t,s,v;if(this._isValid()){var o=n||!1,c=this._bsInst.getBetItems(),u="0",l="0",a=this._bsInst.getBetItems(this._bsInst.betTypeBetBuilder);if(c.length===0&&a.length===0)return;if(h=[],f=1,!o){for(t=0,s=c.length;t<s;t++)i=c[t],u=i.getStItem("olc"),l=i.getStItem("_s"),(u&&Number(u)>0||l&&Number(l)>0)&&(o=!0),r=eval(i.getCnItem("o"))+1,h.push(i.getCnItem("o")),this._bsInst.useTruncated2dpPriceForReturnsCalc?(r=Math.floor(r*100+1e-6)/100,f*=r):window.location.host.split(".").pop()=="it"&&window.pushedConfig.getIsPSQFV4Enabled()&&(r=Math.floor(r*1e3+1e-6)/1e3,f*=r);e=document.getElementsByClassName("bs-multiple-odds");e&&e.length>0&&e[0]&&(window.location.host.split(".").pop()=="it"?(f=this._roundDown(f,2),e[0].textContent=f):e[0].textContent=ns_betcalculationslib_formatter.FormatMultipleOdds.Format(h,Locator.user.oddsTypeId))}if(h=null,!o)for(t=0,s=a.length;t<s;t++)if(i=a[t],u=i.getStItem("olc"),u&&Number(u)>0){o=!0;break}v=$("#BetSlipDialogueAddToBetslip");o?($(".acceptChanges",this._bsWrapper).removeClass("hidden"),$("a.placeBet",this._bsWrapper).addClass("hidden"),$("a",v).addClass("disabled").attr("data-nav",""),new b365.Ui.Betslip.MessageDisplayHandler(this._bsInst).showMsg(betSlipML.oddsChanged)):($(".acceptChanges",this._bsWrapper).addClass("hidden"),$("a.placeBet",this._bsWrapper).removeClass("hidden"),$("a",v).removeClass("disabled").attr("data-nav","AddToBetSlip"),new b365.Ui.Betslip.MessageDisplayHandler(this._bsInst).hideMsg());this._bsInst.changeBetslipHeight()}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.UpdateStateHandler=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.UpdateStateHandler.prototype={handle:function(){this._isValid()&&(this._bsInst.setValueInBSCookie("ns",$bto.serialize(this._bsInst.getBetItems(this._bsInst.betTypeNormal))),this._bsInst.setValueInBSCookie("ms",$bto.serialize(this._bsInst.getBetItems(this._bsInst.betTypeMultiple))),this._bsInst.setValueInBSCookie("cs",$bto.serialize(this._bsInst.getBetItems(this._bsInst.betTypeCast))),this._bsInst.setValueInBSCookie("bb",$bto.serialize(this._bsInst.getBetItems(this._bsInst.betTypeBetBuilder))))}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.RestoreStateHandler=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.RestoreStateHandler.prototype={handle:function(){this._isValid()&&(this._bsInst.setBetItems($bto.parseCookieString(this._bsInst.getValueFromBSCookie("ns",""),this._bsInst.betTypeNormal),this._bsInst.betTypeNormal),this._bsInst.setBetItems($bto.parseCookieString(this._bsInst.getValueFromBSCookie("ms",""),this._bsInst.betTypeMultiple),this._bsInst.betTypeMultiple),this._bsInst.setBetItems($bto.parseCookieString(this._bsInst.getValueFromBSCookie("cs",""),this._bsInst.betTypeCast),this._bsInst.betTypeCast),this._bsInst.setBetItems($bto.parseCookieString(this._bsInst.getValueFromBSCookie("bb",""),this._bsInst.betTypeBetBuilder),this._bsInst.betTypeBetBuilder),this._bsInst.betSlipItemsChanged())}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.PlaceBetErrorHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.PlaceBetErrorHandler.prototype={handle:function(){this._isValid()&&($(".emptyBetslip").hide(),$(".placeBet").hide(),this._bsInst.betslipError(),new b365.Ui.Betslip.ViewResetter(this._bsInst,this._bsController).reset(),this._bsInst.addReceiptFooterLinks(),new b365.Ui.Betslip.FooterLinksSlipRender(this._bsInst,$(".footer")).render())}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.CastBreakdownRequestDespatcher=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.CastBreakdownRequestDespatcher.prototype={despatch:function(n){this._isValid()&&this._bsInst.req(this._bsInst.reqTypeBetBrk,new b365.Ui.Betslip.BetBreakdownKeyGenerator(this._bsInst,this._bsInst.getBetItemById(this._bsInst.itemTypeCast,n),this._bsInst.itemTypeCast,n).generate())}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.AusToteToolTipHtmlBuilder=function(n){this._bsController=n;this._activePopup=null;this._siteClickHandlers=[]};b365.Ui.Betslip.AusToteToolTipHtmlBuilder.prototype={getHtml:function(n){return"<span>"+n+"<\/span>"},showInfo:function(n){var t=n.parentElement,u=document.getElementById("bsDiv"),i,r;t.className.indexOf("show")<0?(this.hidePopUpMenu(),i=t.getElementsByClassName("bs-Tote_Popup")[0],i&&(r=n.offsetLeft,i.style.left=r-90>10?r-90+"px":"30px"),t.className+=" show",this._activePopup&&(this._activePopup.className=this._activePopup.className.replace(" show","")),this._activePopup=t,this._siteClickHandlers.push(new b365.Ui.Betslip.ResponsiveClickHandler(u,$.proxy(this.hidePopUpMenu,this),!1))):(t.className=t.className.replace(" show",""),this._activePopup=null)},hidePopUpMenu:function(){var t=document.getElementsByClassName("bs-ToteContainer"),n;for(t.length==0&&(t=document.getElementsByClassName("bs-AusRaceBetType_HelpIcon")),t.length==0&&(t=document.getElementsByClassName("ausToteTypeContent")),n=0;n<t.length;n++)t[n].className.indexOf("show")>-1&&(t[n].className=t[n].className.replace(" show",""));if(this._activePopup=null,this._siteClickHandlers.length>0){for(n=0,il=this._siteClickHandlers.length;n<il;n++)this._siteClickHandlers[n]._element&&this._siteClickHandlers[n].destroy();this._siteClickHandlers=[]}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.SingleToolTipHtmlBuilder=function(){this._alwaysInclude="*~"};b365.Ui.Betslip.SingleToolTipHtmlBuilder.prototype={getHtml:function(n,t){var r=n.find("input[data-inp-type='ewcb']").length>0||t.length>=3&&t[2].startsWith(this._alwaysInclude),u,i;return r&&(t[2]=t[2].replace(this._alwaysInclude,"")),u=n.hasClass("hdCap"),i="<label class='ttHead'>"+t[0]+"<\/label><br />",i+=t[1]&&t[1].length>0?"<label>"+t[1]+"<\/label><br />":"",i+="<label>",i+=$("#bsDiv .betReceipt").length==0&&n.children("div.pitcher").length>0?n.find("div.pitcher").find(".pitcher-sel")[0].options[0].selected?t[3]:"("+n.find("div.pitcher .pitcher-sel>option:selected").text()+")":t[3]&&t[3].length>0?t[3]:"",i+=(u?" "+n.find(".hdCapDisplay").text():"")+"<\/label><br/>",t.length==5&&t[4]!=""&&(i+="<label>"+t[4]+"<\/label><br />"),r&&(i+=t[2]),i}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ToteSingleToolTipHtmlBuilder=function(){};b365.Ui.Betslip.ToteSingleToolTipHtmlBuilder.prototype={getHtml:function(n){var t="",r;return n.length>2&&n[2].length>0&&n[2].indexOf("#")>-1&&(r=n[i].split("#"),t+="<br /><label>"+r[0]+" ("+r[1]+")<\/label>"),t+="<br /><label>"+n[3]+"<\/label>","<label class='ttHead'>"+n[0]+"<\/label><br /><label>"+n[1]+"<\/label>"+t}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.UKToteBetStakeChangedHandler=function(n){this._bsInst=n;this._stakeCookieKey="st";this._eachWayCookieKey="ew";this._betCountCookieKey="bc";this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.UKToteBetStakeChangedHandler.prototype={handle:function(n){var e,o;if(this._isValid()){var b=$(n),s=new b365.Ui.Betslip.ItemInformation(n),h=s.itemIndexAndType(),c=s.itemElement();$blib.isDecimal(n.value)==!1&&(n.value="");var w=n.getAttribute("data-no-convert")?!0:!1,t=new b365.Ui.Formatter,i=Number($("#bsDiv>ul:first-child").attr("data-xrte"));(i==0||w==!0)&&(i=1);var l=Math.pow(10,t.numDecPlcs(i)),r=this._bsInst.getBetItemById(h[1],h[0]),u=r.getStItem(this._betCountCookieKey);typeof u=="undefined"&&(u=1);r.getStItem(this._eachWayCookieKey)=="1"&&(u=u*2);var f=t.roundValue(n.value),a=Math.pow(10,t.numDecPlcs(f)),v=t.roundDecimal(String(u*f)),y=$(".totestkbc",c),p=$(".totestkuc",c);y.length>0||p.length>0?(e=i==0?0:t.roundDecimal(String(Number(f)*a*i*l/l/a)),o=i==0?0:t.roundDecimal(String(e*u)),p.text(o=="0"?"":o),r.setStItem("st",e),y.text(v=="0"?"":v)):r.setStItem("st",f);r.setStItem("gust",f);r.setStItem("gst",f)}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.USToteBetStakeChangedHandler=function(n){this._bsInst=n;this._stakeCookieKey="st";this._eachWayCookieKey="ew";this._betCountCookieKey="bc";this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.USToteBetStakeChangedHandler.prototype={handle:function(n){var o,e,s,h;if(this._isValid()){var d=$(n),c=new b365.Ui.Betslip.ItemInformation(n),l=c.itemIndexAndType(),a=c.itemElement();$blib.isDecimal(n.value)==!1&&(n.value="");var v=n.getAttribute("data-no-convert")?!0:!1,t=new b365.Ui.Formatter,i=Number($("#bsDiv>ul:first-child").attr("data-xrte"));(i==0||v==!0)&&(i=1);o=Math.pow(10,t.numDecPlcs(i));e=Number($("#bsDiv>ul:first-child").attr("data-xrte-us"));(e==0||v==!0)&&(e=1);var y=Math.pow(10,t.numDecPlcs(e)),r=this._bsInst.getBetItemById(l[1],l[0]),u=r.getStItem(this._betCountCookieKey);typeof u=="undefined"&&(u=1);r.getStItem(this._eachWayCookieKey)=="1"&&(u=u*2);var f=t.roundValue(n.value),p=Math.pow(10,t.numDecPlcs(f)),w=t.roundDecimal(String(u*f)),b=$(".totestkbc",a),k=$(".totestkuc",a);b.length>0||k.length>0?(s=i==0?0:t.roundDecimal(String(Number(f)*p*e*y/y/p*i*o/o)),h=i==0?0:t.roundDecimal(String(s*u)),k.text(h=="0"?"":h),r.setStItem("st",s),b.text(w=="0"?"":w)):r.setStItem("st",f);r.setStItem("gust",f);r.setStItem("gst",f)}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ToteStakeChangedHandler=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.ToteStakeChangedHandler.prototype={handle:function(n){if(this._isValid()){switch(this._bsInst.getSlipType()){case this._bsInst.slipUKTote:new b365.Ui.Betslip.UKToteBetStakeChangedHandler(this._bsInst).handle(n);break;case this._bsInst.slipUSTote:new b365.Ui.Betslip.USToteBetStakeChangedHandler(this._bsInst).handle(n);break;default:new b365.Ui.Betslip.UKToteBetStakeChangedHandler(this._bsInst).handle(n)}this._bsInst.updateState()}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ToteCastToolTipHtmlBuilder=function(){};b365.Ui.Betslip.ToteCastToolTipHtmlBuilder.prototype={getHtml:function(n,t){return"<label class='ttHead'>"+t[0]+"<\/label><br /><label>"+t[1]+"<\/label><br/>"+$(n).closest(".bs-tt").html()}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.TotePotToolTipHtmlBuilder=function(){};b365.Ui.Betslip.TotePotToolTipHtmlBuilder.prototype={getHtml:function(n){return"<label class='ttHead'>"+n[0]+"<\/label><br /><label>"+n[1]+"<\/label><br /><label>"+n[2]+"<\/label>"}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.TotePotLegDeleteExecutor=function(n,t,i,r){this._bsInst=n;this._legIndex=i;this._legType=r;this._legEle=t;this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._legIndex!="undefined"&&typeof this._legType!="undefined"&&typeof this._legEle!="undefined"}};b365.Ui.Betslip.TotePotLegDeleteExecutor.prototype={execute:function(){var n,r,i,u;if(this._isValid()){var c=new b365.Ui.Betslip.ItemInformation(this._legEle),s=c.itemIndexAndType(),h=this._bsInst.getBetItemById(s[1],s[0]),f=this._legIndex.split(":"),e=h.getCnItem("fp").split(","),t=e[f[0]-1].split("-"),l=t.length,o=-1;for(n=l-1;o<0;n--)o=t[n].startsWith(f[1])?n:-1;for(t.splice(o,1),r="",n=0;n<e.length;n++){if(i=e[n],n==f[0]-1)for(i="",u=0;u<t.length;u++)i+=(i.length>0?"-":"")+t[u];r+=(r.length>0?",":"")+i}h.setCnItem("fp",r);this._bsInst.updateState();this._bsInst.req(this._bsInst.reqTypeRefreshSlip)}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ConfirmBetRequestDespatcher=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.ConfirmBetRequestDespatcher.prototype={despatch:function(){this._isValid()&&this._bsInst.req(this._bsInst.reqTypeConfirmBet)}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.PitcherDetailsRequestDespatcher=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.PitcherDetailsRequestDespatcher.prototype={despatch:function(n){if(this._isValid()){var t=n.target;t.tagName=="A"&&this._bsInst.req(this._bsInst.reqTypePitcher,"key=B-"+t.href.split("_")[1])}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.CastToolTipHtmlBuilder=function(){};b365.Ui.Betslip.CastToolTipHtmlBuilder.prototype={getHtml:function(n,t){return"<label class='ttHead'>"+t[0]+"<\/label><br /><label>"+t[1]+"<\/label><br />"+$(n).find(".bs-tt").html()}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.TeaserChangeHandler=function(n){this._bsInst=n;this._teaserItemCookieKey="ti";this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.TeaserChangeHandler.prototype={handle:function(n){if(this._isValid()){var t=n.target;t.selectedIndex>-1&&(this._bsInst.setValueInBSCookie("ti",t.options[t.selectedIndex].value),this._bsInst.updateState(),this._bsInst.refresh(this._bsInst.betTypeAll))}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.AusToteChangeHandler=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.AusToteChangeHandler.prototype={handle:function(n,t,i){if(this._isValid()){console.log(1);var r=$(n.target),f=this._bsInst.getBetItemById(i,t),u=$(r).find("option:selected");f.setStItem("atc",u.val());$(r).parent(".betslip-select").attr("data-text",u.text());this._bsInst.updateState()}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ForeignToteConstructCorrector=function(n,t){this._bsInst=n;this._construct=t;this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._construct!="undefined"}};b365.Ui.Betslip.ForeignToteConstructCorrector.prototype={GetCorrectedConstruct:function(){if($.isArray(this._construct))for(var n=0;n<this._construct.length;n++)(this._construct[n].cmask=="1"||this._construct[n].cmask=="2"||this._construct[n].cmask=="3"||this._construct[n].cmask=="4")&&(this._construct[n].ctype="C");return this._construct}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.PollingExpiredHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.PollingExpiredHandler.prototype={handle:function(n){if(this._isValid()&&(n[0]===this._bsInst.reqTypePollTempBetReceipt&&$("#bsDiv").find("[id^=tempbetstatus_title_].pending").removeClass("pending").addClass("timedout"),this._bsInst.resetPoll(),new b365.Ui.Betslip.LockUnlockHandler(this._bsInst,this._bsController).handle(!1,!1),new b365.Ui.Betslip.InProgressDisplayHandler(this._bsInst,this._bsController).handle(["hide",betSlipML.pleasecheckmembers]),n[0]===this._bsInst.reqTypePollReferredBet)){var t=this._bsController.GetCurrentDialogRef();t&&t.hideDialog()}}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.PollBetRequestDespatcher=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.PollBetRequestDespatcher.prototype={despatch:function(n){var i,t;this._isValid()&&(t="",n[1]&&n[1].length>0&&(t="br="+n[1]),n.length>2&&n[2]&&n[2].length>0&&(t.length>0&&(t+="&"),t+=n[2]),this._bsController.clientEnhancedMode()&&(i=$("#bsDiv"),i.find("ul:first-child").hasClass("betReceipt")&&i.find("li").removeClass("disableBetSlip").removeClass("enableBetSlip").removeClass("disabledBetSlip")),this._bsInst.req(n[0],t))}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.BetBreakdownKeyGenerator=function(n,t,i,r){this._bsInst=n;this._item=t;this._itemType=i;this._itemIndex=r;this._betTypeIDCookieKey="id";this._eachWayCookieKey="ew";this._fixtureCookieKey="f";this._fixtureParticipantCookieKey="fp";this._stakeCookieKey="st";this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._item!="undefined"&&typeof this._itemType!="undefined"&&typeof this._itemIndex!="undefined"};this._getStake=function(){return this._item.getStItem(this._stakeCookieKey)===undefined?"0":String(parseInt(this._item.getStItem(this._stakeCookieKey)*100))};this._isEachWay=function(){return this._item.getStItem(this._eachWayCookieKey)&&this._item.getStItem(this._eachWayCookieKey)=="1"?!0:!1};this._getCastKey=function(){return"key=C-"+(this._getStake(this._item)+"-"+String(Number(this._itemIndex)+1)+"-0")};this._getMultiplesKey=function(){return"key=M-"+(this._getStake(this._item)+"-"+this._item.getCnItem(this._betTypeIDCookieKey)+"-"+(this._isEachWay()?"1":"0"))};this._getSingleKey=function(){return"key=N-"+(this._getStake(this._item)+"-"+this._item.getCnItem(this._fixtureCookieKey)+"-"+this._item.getCnItem(this._fixtureParticipantCookieKey)+"-"+(this._isEachWay()?"1":"0"))}};b365.Ui.Betslip.BetBreakdownKeyGenerator.prototype={generate:function(){var n=null;if(this._isValid())switch(this._itemType){case this._bsInst.itemTypeMultiple:n=this._getMultiplesKey();break;case this._bsInst.itemTypeCast:n=this._getCastKey();break;default:n=this._getSingleKey()}return n}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.BetSlipPopUpMessageController=function(n){this._bsContext=n;this._messageTimeout=function(){window.clearTimeout(this._autoCloseTimer);this.HideMessage()};this._clearPopUpShowingClass=function(){$(".showing-fade-popup").removeClass("showing-fade-popup")};this._eventTargetElement=$(".betSlipPopupHeader>a>span:first-child");$(document).on("bsInfoMessage",$.proxy(this.ShowMessage,this));$(document).on("HideBsInfoMessage",$.proxy(this.HideMessage,this))};b365.Ui.Betslip.BetSlipPopUpMessageController.prototype={ShowMessage:function(n,t,i){var r=this,u,s,h;if(r._bsContext.IsPortraitMode()&&r._bsContext.IsPrematch()&&!$("#bsDiv").is(":visible")){r._eventTargetElement=typeof window.MyBetsController!="undefined"&&window.MyBetsController.isInitialised()?$("#myBetsHeader>ul>li:first-child"):$(".betSlipPopupHeader>a>span:first-child");u=$("#ttDivFade");u.removeClass("ttHidden");r._autoCloseTimer!=-1&&r._messageTimeout();r._clearPopUpShowingClass();r._eventTargetElement.addClass("showing-fade-popup");i||(i=140);$.isNumeric(i)||(i=parseInt(i.replace(/px/g,"").replace(/;/g,"")));u.find(".cnt").html(t).css("max-width",i).css("width",i);var f=10,e=r._eventTargetElement.offset(),o=r._eventTargetElement.outerHeight(!0);o&&(f=o);s=e.top+f+4;h=e.left+r._eventTargetElement.outerWidth(!0)/2-i/2;u.css("top",s).css("left",h).css("max-width",i+"px").css("width",i+"px");u.fadeIn();this._autoCloseTimer=window.setTimeout(Function.createDelegate(r,r._messageTimeout),3500)}n.stopPropagation()},HideMessage:function(){this._clearPopUpShowingClass();$("#ttDivFade").fadeOut().addClass("ttHidden")}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.TaxCalculator=function(n){this._bsInst=n;this._taxRates=0;this._taxCalculationMethod="";this._isFreeBet=!1;var t=$("#bsDiv>ul").attr("data-txr"),i=$("#bsDiv>ul").attr("data-tcm");typeof t!="undefined"&&(this._taxRates=t);typeof i!="undefined"&&(this._taxCalculationMethod=i);this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.TaxCalculator.prototype={getstakeToTax:function(n,t,i){return t==-1?i-n:i<=t?i-n:t-n},parseTaxRateForStakeAndCalculateTotalReturns:function(n,t){for(var p=new b365.Ui.Formatter,r=0,u=0,s=0,w=this._taxRates.toString(),e=w.split("#"),b=Number(p.roundValue(String(n))),l=t*b,a=Number(0),v=Number(0),i,f,o,y,h,c,r=0;r<e.length;r++)i=e[r].split(","),i.length>4&&(f=Number(i[0]),o=Number(i[1]),y=Number(i[2]),h=Number(i[3]),c=Number(i[4]),l>f&&(a=this.getstakeToTax(f,o,l),u=u+a*h));for(this._isFreeBet||(u=u+n),r=0;r<e.length;r++)i=e[r].split(","),i.length>4&&(f=Number(i[0]),o=Number(i[1]),y=Number(i[2]),h=Number(i[3]),c=Number(i[4]),u>f&&(v=this.getstakeToTax(f,o,u),s=s+v*c));return s},calcReturnsByLine:function(n,t){n=isNaN(n)?0:Number(n);var r=0,i,u;try{i=eval(t)}catch(f){return 0}return isNaN(i)?0:(this._bsInst.useTruncated2dpPriceForReturnsCalc?i=Math.floor(i*100+1e-6)/100:window.location.host.split(".").pop()=="it"&&Locator.pushedConfig.getIsPSQFV4Enabled()&&(i=Math.floor(i*1e3+1e-6)/1e3),this._taxCalculationMethod==2?(u=n*100%100,u>0&&(u=u/100,r=this.parseTaxRateForStakeAndCalculateTotalReturns(u,i)),n=Math.floor(n),r=r+n*this.parseTaxRateForStakeAndCalculateTotalReturns(1,i)):r=this.parseTaxRateForStakeAndCalculateTotalReturns(n,i),r=parseFloat(r.toPrecision(12)),this.floorTo2dp(r))},floorTo2dp:function(n){var t,i;return t=n.toString(),i=t.indexOf("."),i>-1?t=t.substr(0,i+3):t+=".00",parseFloat(t).toFixed(2)}};BetSlipDelegates.prototype.isPortraitMode=function(){var n=this;return n._bsContext&&n._bsContext.IsPortraitMode?n._bsContext.IsPortraitMode():!1};BetSlipDelegates.prototype.isPrematch=function(){var n=this;return n._bsContext&&n._bsContext.IsPrematch?n._bsContext.IsPrematch():!1};BetSlipDelegates.prototype.isAuthenticated=function(){var n=this;return n._bsContext&&n._bsContext.IsAuthenticated?n._bsContext.IsAuthenticated():!1};BetSlipDelegates.prototype.updateBalance=function(){var n=this;n._bsContext&&n._bsContext.UpdateBalance&&n._bsContext.UpdateBalance()};BetSlipDelegates.prototype.showOverlay=function(){var n=this;n._bsContext&&n._bsContext.ShowPleaseWaitSpinner&&n._bsContext.ShowPleaseWaitSpinner()};BetSlipDelegates.prototype.hideOverlay=function(){var n=this;n._bsContext&&n._bsContext.HidePleaseWaitSpinner&&n._bsContext.HidePleaseWaitSpinner()};BetSlipDelegates.prototype.showTooltip=function(n){var t=this;t._bsContext&&t._bsContext.ShowTooltip&&t._bsContext.ShowTooltip(n)};BetSlipDelegates.prototype.hideTooltip=function(){var n=this;n._bsContext&&n._bsContext.HideTooltip&&n._bsContext.HideTooltip()};BetSlipDelegates.prototype.showLoginPage=function(){var n=this;n._bsContext&&n._bsContext.ShowLoginPage&&n._bsContext.ShowLoginPage()};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.StakeEntryRules=function(){function n(n){this._bsController=n}return n.prototype.ItalianStakeEntryRulesForKeyboardEntry=function(n){var i=this,t=n.value,r;t=t.replace("..",".");t=t.replace(",,",",");t=i._bsController._currencyDisplayHelper&&t!=""?i._bsController._currencyDisplayHelper.unformatCurrency(t):t.replace(",",".");typeof n.attributes["data-system"]!="undefined"&&n.attributes["data-system"].value=="true"||(r=t?Math.floor(Number(t)):"",n.value=r===""?"":r,new b365.Ui.Betslip.StakeChangedHandler(i._bsController._bsInst,i._bsController).handle(n))},n.prototype.ItalianStakeEntryRulesForStakePadEntry=function(n){var i=this,r,t=n.value;t=t.replace("..",".");t=t.replace(",,",",");t=i._bsController._currencyDisplayHelper&&t!=""?i._bsController._currencyDisplayHelper.unformatCurrency(t):t.replace(",",".");typeof n.attributes["data-system"]!="undefined"&&n.attributes["data-system"].value=="true"||(t.toString().indexOf(".")>-1&&(n.value=t.substring(0,t.toString().indexOf("."))),r=$("#betSlipStakePadDecimalPoint","#stakePad").find("button"),r.hasClass("betSlipStakePadDisabledKey")||$("#betSlipStakePadDecimalPoint","#stakePad").find("button").addClass("betSlipStakePadDisabledKey").removeClass("stakePadKeyDown"))},n.prototype.PushBetDisplayUpdate=function(n,t,i){var f=$('#bsDiv li[data-item-id="'+n+'"]'),e=f.attr("data-item-push"),o=$blib.to2DP(i.value),s=this._bsController._bsInst.getBetItems(t)[n],h=new b365.Ui.Betslip.TaxCalculator(this._bsController._bsInst),p=$blib.getItemOdds(t,s),u,r,c,l,a,v,y;this._bsController.getPushMarketsEnabled()&&e>0&&e<5&&(r=f.children(".italy-push-text"),o>0?(u=$blib.pad2DP(String(o/2)),c=r.find(".italy-push-stake"),v=r.find(".italy-push-win-return"),y=r.find(".italy-push-draw-return"),c.text(u+" "+betSlipML.towin+" "),l=$blib.pad2DP(String(h.calcReturnsByLine(Number(u),p)*2)),a=$blib.pad2DP(String(h.calcReturnsByLine(Number(u),"1/1"))),v.text(this._bsController._currencyDisplayHelper.formatCurrency(l)),y.text(this._bsController._currencyDisplayHelper.formatCurrency(a)),r.removeClass("no-stake")):r.addClass("no-stake"),s.setCnItem("ipms",1))},n}();BetSlipController.betCallLoginPopupDisplayed=!1;BetSlipController.prototype.GetBetSlipMode=function(){var n=this;return new b365.Ui.Betslip.ModeResolver(n._bsInst).resolve()};BetSlipController.prototype.SetBetSlipTextBoxMinValues=function(){this._setTextBoxesMinNumeric()};BetSlipController.prototype.OnItemBetMax=function(n){new b365.Ui.Betslip.BetMaxRequestDespatcher(this._bsInst,this).despatch(n)};BetSlipController.prototype.OnItemStakeChanged=function(n){new b365.Ui.Betslip.StakeChangedHandler(this._bsInst,this).handle(n)};BetSlipController.prototype.SetCurrentDialogRef=function(n){this._dlg=n};BetSlipController.prototype.GetCurrentDialogRef=function(){return this._dlg};BetSlipController.prototype.ClearCurrentDialogRef=function(){this._dlg=null};BetSlipController.prototype.CloseCurrentDialogClearRef=function(){if(this._dlg!==null){try{this._dlg.hideDialog()}catch(n){}this._dlg=null}};BetSlipController.prototype.OnBetslipContentLoaded=function(){var n=this,t,r,i;new b365.Ui.Betslip.RestoreStateHandler(n._bsInst).handle();b365.Ui.Betslip.ToggleMultiples&&new b365.Ui.Betslip.ToggleMultiples(n._bsInst,n).reset();n._suspendSelections();b365.Ui.Betslip.ToggleBetCredits&&document.getElementsByClassName("bs-useFreeBet")[0]&&n._currencyDisplayHelper&&new b365.Ui.Betslip.ToggleBetCredits(n._bsInst,n).reset();typeof n._stakeEntryHander!="undefined"&&n._stakeEntryHander.init();t=$("#bsDiv");$(".betslip-select select",t).on("click change customselect",function(){$(this).parent().attr("data-text",$(this).find(":selected").text())}).trigger("customselect");n._enhancedBetSlipTypeSelector?n._enhancedBetSlipTypeSelector.enablePopUp():n._enhancedBetSlipTypeSelector=new b365.Ui.Betslip.EnhancedBetSlipTypeSelector(n);n._enhancedBetSlipOddsSelector?n._enhancedBetSlipOddsSelector.enablePopUps():n._enhancedBetSlipOddsSelector=new b365.Ui.Betslip.EnhancedBetSlipOddsSelector(n);n._enhancedBetSlipPitcherSelector?n._enhancedBetSlipPitcherSelector.enablePopUps():n._enhancedBetSlipPitcherSelector=new b365.Ui.Betslip.EnhancedBetSlipPitcherSelector(n);n._enhancedBetSlipToteSelector?n._enhancedBetSlipToteSelector.enablePopUps():n._enhancedBetSlipToteSelector=new b365.Ui.Betslip.EnhancedBetSlipToteSelector(n);n._enhancedBetSlipIfBetSelector?n._enhancedBetSlipIfBetSelector.enablePopUps():n._enhancedBetSlipIfBetSelector=new b365.Ui.Betslip.EnhancedBetSlipIfBetSelector(n);n._enhancedBetSlipTeaserTypeSelector?n._enhancedBetSlipTeaserTypeSelector.enablePopUps():n._enhancedBetSlipTeaserTypeSelector=new b365.Ui.Betslip.EnhancedBetSlipTeaserTypeSelector(n);n._enhancedBetSlipAusRaceBetTypeSelector?n._enhancedBetSlipAusRaceBetTypeSelector.enablePopUps():n._enhancedBetSlipAusRaceBetTypeSelector=new b365.Ui.Betslip.EnhancedBetSlipAusRaceBetTypeSelector(n);n._enhancedBetSlipEachWayExtraSelector?n._enhancedBetSlipEachWayExtraSelector.enablePopUps():n._enhancedBetSlipEachWayExtraSelector=new b365.Ui.Betslip.EnhancedBetSlipEachWayExtraSelector(n);n._ausToteToolTipHtmlBuilder||(n._ausToteToolTipHtmlBuilder=new b365.Ui.Betslip.AusToteToolTipHtmlBuilder(n));n._removeClickHandler||(n._removeClickHandler=new b365.Ui.Betslip.RemoveClickHandler(n._bsInst,n));!n._eachWayClickHandler&&b365.Ui.Betslip.EachWayClickHandler&&(n._eachWayClickHandler=new b365.Ui.Betslip.EachWayClickHandler(n._bsInst,n));!n._freeBetClickHandler&&b365.Ui.Betslip.FreeBetClickHandler&&(n._freeBetClickHandler=new b365.Ui.Betslip.FreeBetClickHandler(n._bsInst,n));!n._noReservesClickHandler&&b365.Ui.Betslip.NoReservesClickHandler&&(n._noReservesClickHandler=new b365.Ui.Betslip.NoReservesClickHandler(n._bsInst,n));n._currencyDisplayHelper||(n._currencyDisplayHelper=new b365.Ui.Betslip.CurrencyDisplayHelper(n,n.getCurrencyObject()));$(".footer .placeBet .isocode",t).text(t.children("ul:first-child").attr("data-isocode"));r=document.getElementsByClassName("bs-FreeBetCheckBox-selected");r.length>0&&(new b365.Ui.Betslip.FreeBetClickProcessor(this._bsInst,this).init(r[0]).handle(!0),n._freeBetClickHandler.attachHandlers());n.clientEnhancedMode()&&this._bsInst.getSlipType()!=n._bsInst.slipReverseIF&&(i=$(':input[type="text"], :input[type="number"]',t),(i.length==1&&r.length==0||i.length==3&&i[0].className.indexOf("flexistk")>-1)&&n._stakeEntryHander.show(null,i[0]));n._delegates.updateBalance();t.trigger("b365.Ui.Betslip.contentloaded");n._bsInst.betSlipLoaded()};BetSlipController.prototype.initialiseWithParticipantInformation=function(n){var i=this,t="";t+="participantid="+(n.id?n.id:"")+"&";t+="pcode="+(n.code?n.code:"")+"&";t+="ptype="+(n.type?n.type:"")+"&";t+="odds="+(n.odds?n.odds:"")+"&";t+="fid="+(n.fid?n.fid:"")+"&";t+="acode="+(n.acode?n.acode:"")+"&";i.initialise();i._bsInst.req(i._bsInst.reqTypeConstructAndAddItems,t)};BetSlipController.prototype.initialise=function(){var n=this,t;n.initialiseStakeEntry();n._bsInst.betSource=n.betSource();n._bsInst.deviceType=n.deviceType();n._bsInst.showStreaming=n.showStreaming();n._bsInst.isV6Mode=n._bsContext.IsV6Mode||function(){return!1};n._bsInst.showFullTextMode=n.showFullTextMode();n._bsInst.showFixtureDate=n.showFixtureDate();n._bsInst.keyboardType=n.getKeyboardType();n._bsInst.refreshUserBalance=n.getRefreshUserBalance();n._bsInst.isoCode=n.getIsoCode();t=n._bsInst.getValueFromBSCookie("processed").replace("||","");t=="true"&&new b365.Ui.Betslip.ViewResetter(n._bsInst,n).reset();n._isAusDomain&&(n._isAusMultiplesAvailable=window.siteDataLocal.getItem("ausMultiplesAvailable")==="1"?!0:!1,n._pushConfigInitialisedDelegate={scope:this,method:n.pushConfigInitialised},n._ausMultiplesAvailabilityChangedDelegate={scope:this,method:n.ausMultiplesAvailabilityChanged},Locator.pushedConfig.getArePropertiesInitialised()?(n._isAusMultiplesAvailable=Locator.pushedConfig.getIsAusMultiplesAvailable(),Locator.pushedConfig.addEventListener(n._ausMultiplesAvailabilityChangedEvent,n._ausMultiplesAvailabilityChangedDelegate)):Locator.pushedConfig.addEventListener(n._pushConfigInitialisedEvent,n._pushConfigInitialisedDelegate))};BetSlipController.prototype.initialiseStakeEntry=function(){var n=this,t;typeof n._stakeEntryHander!="undefined"&&n._stakeEntryHander.detach();t=window.device.isAndroidNativeBrowser&&parseFloat(window.device.osVersion)>=2&&parseFloat(window.device.osVersion)<3||window.sProps.instantBet;n.clientEnhancedMode()||t?(n._stakeEntryHander=new b365.Ui.Betslip.StakePadController("#bsDiv",n,n,function(n){return new b365.Ui.Betslip.ItemInformation(n).itemIndex()[0]},n.OnItemStakeChanged,function(n){return $(n).prop("disabled")||$(n).parents().hasClass("suspended")?!1:!0},null,n.showStakePadToolTips(),t),n._stakeEntryType=n._stakeEntryTypes.stakePad):(n._stakeEntryType=n._stakeEntryTypes.deviceKeyBoard,n._stakeEntryHander=new b365.Ui.Betslip.StakeEntryKeyboard(n._bsInst,n))};BetSlipController.prototype.addBet=function(n,t,i){function u(n){i&&i();r.addToBetsBank(n)}var r=this;new b365.Ui.Betslip.AddBetHandler(this._bsInst,this).handle(n,t,u)};BetSlipController.prototype.addToBetsBank=function(n){typeof n=="string"&&window.Locator&&window.Locator.betSlipManager&&window.Locator.betSlipManager.addBetToBank(n)};BetSlipController.prototype.betExists=function(n){return $blib.getBetItemIndex(n,this._bsInst)!=-1};BetSlipController.prototype.deleteBet=function(n){new b365.Ui.Betslip.DeleteBetHandler(this._bsInst,this).handle(n)};BetSlipController.prototype.placeBet=function(){var n=this;n._bsInst.req(n._bsInst.reqTypePlaceBet,undefined,undefined,this)};BetSlipController.prototype.removeBets=function(){var n=this;new b365.Ui.Betslip.RemoveAllItemsRequestDespatcher(n._bsInst,n).despatch(null)};BetSlipController.prototype.loadAddedItems=function(){var n=this;n._bsInst.req(n._bsInst.reqTypeAddItems)};BetSlipController.prototype.refreshBetslip=function(n){var t=this,i;n&&(i="getMultipleCombinations");t._bsInst.req(t._bsInst.reqTypeRefreshSlip,"",null,t,i)};BetSlipController.prototype.initiatePhoneBetRequest=function(n){new b365.Ui.Betslip.PhoneBetHandler(this._bsInst,this).initiate(n)};BetSlipController.prototype.hideBetSlip=function(){var n=this;n._bsInst.hideBetSlip()};BetSlipController.prototype.IsItalianDomain=function(){return this._isItalianDomain};BetSlipController.prototype.getPushMarketsEnabled=function(){return this._pushMarketsEnabled};BetSlipController.prototype.setPushMarketsEnabled=function(n){this._pushMarketsEnabled=n};BetSlipController.prototype.retainSelectionsDelegate=function(){var n=this;n._bsContext&&n._bsContext.RetainSelectionsDelegate&&n._bsContext.RetainSelectionsDelegate()};BetSlipController.prototype.clientLoginDelegate=function(){var n=this;n._bsContext&&n._bsContext.ClientLoginDelegate&&n._bsContext.ClientLoginDelegate()};BetSlipController.prototype.clientContinueDelegate=function(){var n=this;return n._bsContext&&n._bsContext.ClientContinueDelegate?(n._bsContext.ClientContinueDelegate(),!0):!1};BetSlipController.prototype.clientActionInProgress=function(n){var t=this;t._bsContext&&t._bsContext.ClientActionInProgress&&t._bsContext.ClientActionInProgress(n)};BetSlipController.prototype.getCurrencyObject=function(){var n=this;return n._bsContext&&n._bsContext.GetCurrencyObject?n._bsContext.GetCurrencyObject():{decimalSeparator:".",thousandsSeparator:","}};BetSlipController.prototype.clientEnhancedMode=function(){var n=this;return n._bsContext&&n._bsContext.ClientEnhancedMode?n._bsContext.ClientEnhancedMode():!1};BetSlipController.prototype.showStakePadToolTips=function(){var n=this;return n._bsContext&&n._bsContext.ShowStakePadToolTips?n._bsContext.ShowStakePadToolTips():!0};BetSlipController.prototype.liveAlertsEnabled=function(){var n=this;return n._bsContext&&n._bsContext.LiveAlertsEnabled?n._bsContext.LiveAlertsEnabled():!1};BetSlipController.prototype.liveAlertsEnabledClassifications=function(){var n=this;return n._bsContext&&n._bsContext.LiveAlertsEnabledClassifications&&n.liveAlertsEnabled()?n._bsContext.LiveAlertsEnabledClassifications():{}};BetSlipController.prototype.betCallEnabled=function(){var n=this;return typeof Locator!="undefined"&&Locator.pushedConfig.getIsBetCallAvailable()&&n._bsContext&&n._bsContext.BetCallSupported?n._bsContext.BetCallSupported():!1};BetSlipController.prototype.betCallTwilioEnabled=function(){var n=this;return typeof Locator!="undefined"&&Locator.pushedConfig.getIsBetCallTwilioAvailable()&&n._bsContext&&n._bsContext.BetCallTwilioSupported?n._bsContext.BetCallTwilioSupported():!1};BetSlipController.prototype.restrictMultiplesForClickToCall=function(){return typeof Locator!="undefined"&&Locator.pushedConfig&&!Locator.pushedConfig.getIsMultiplesEnabledForClickToCall()};BetSlipController.prototype.appType=function(){var n=this;return n._bsContext&&n._bsContext.AppType?n._bsContext.AppType():""};BetSlipController.prototype.appVersion=function(){var n=this;return n._bsContext&&n._bsContext.AppVersion?n._bsContext.AppVersion():""};BetSlipController.prototype.clientBetSlipShowing=function(){var n=this;return n._bsContext&&n._bsContext.ClientBetSlipShowing?n._bsContext.ClientBetSlipShowing():!1};BetSlipController.prototype.clientUsesSelect=function(){var n=this;return n._bsContext&&n._bsContext.ClientUsesSelect?n._bsContext.ClientUsesSelect():!0};BetSlipController.prototype.stakeEntryRule=function(){var n=this;return n._bsContext&&n._bsContext.StakeEntryRule?n._bsContext.StakeEntryRule():null};BetSlipController.prototype.joinNow=function(){var n=this;n._bsContext&&n._bsContext.JoinNow&&n._bsContext.JoinNow()};BetSlipController.prototype.deposit=function(n){var t=this;t._bsContext&&t._bsContext.Deposit&&t._bsContext.Deposit(n)};BetSlipController.prototype.isReqOnBetAddedEnabled=function(){var n=this;return n._bsContext&&n._bsContext.IsReqOnBetAddedEnabled?n._bsContext.IsReqOnBetAddedEnabled():!0};BetSlipController.prototype.isReqOnBetDeletedEnabled=function(){var n=this;return n._bsContext&&n._bsContext.IsReqOnBetDeletedEnabled?n._bsContext.IsReqOnBetDeletedEnabled():!0};BetSlipController.prototype.showConfirmation=function(n,t,i,r,u,f,e,o,s){var c={Controller:n,Title:t,Msg:i,Button1Text:r,Button1Action:u,Button2Text:f,Button2Action:e,additionalClass:o},h;s&&(c.OutofContextDialogue=!0);h=this;h._bsContext&&h._bsContext.ShowConfirmation&&h._bsContext.ShowConfirmation(c)};BetSlipController.prototype.showDialog=function(n,t,i){var u={Controller:n,MarkUp:t,Modal:i},r=this;r._bsContext&&r._bsContext.ShowDialog&&r._bsContext.ShowDialog(u)};BetSlipController.prototype.betSource=function(){var n=this;return n._bsContext&&n._bsContext.BetSource?n._bsContext.BetSource():""};BetSlipController.prototype.deviceType=function(){var n=this;return n._bsContext&&n._bsContext.DeviceType?n._bsContext.DeviceType():""};BetSlipController.prototype.showFullTextMode=function(){var n=this;return n._bsContext&&n._bsContext.ShowFullTextMode?n._bsContext.ShowFullTextMode():!1};BetSlipController.prototype.showFixtureDate=function(){var n=this;return n._bsContext&&n._bsContext.ShowFixtureDate?n._bsContext.ShowFixtureDate():!1};BetSlipController.prototype.showStreaming=function(){var n=this;return n._bsContext&&n._bsContext.ShowStreaming?n._bsContext.ShowStreaming():!1};BetSlipController.prototype.getRefreshUserBalance=function(){var n=this;return n._bsContext&&n._bsContext.RefreshUserBalance?n._bsContext.RefreshUserBalance():!0};BetSlipController.prototype.getIsoCode=function(){var n=this;return n._bsContext&&n._bsContext.IsoCode?n._bsContext.IsoCode():""};BetSlipController.prototype.getKeyboardType=function(){var n=this;return n._bsContext&&n._bsContext.KeyboardType?n._bsContext.KeyboardType():""};BetSlipController.prototype.itemsRemoved=function(n,t){var r={Id:n?n:null,CheckSuspended:t?t:null},i=this;i._bsContext&&i._bsContext.ItemsRemoved&&i._bsContext.ItemsRemoved(r);window.Locator&&window.Locator.betSlipManager&&window.Locator.betSlipManager.deselectBet(n);this.complexMultiplesCombinationsInit=!0};BetSlipController.prototype.resetBetCount=function(){this._bsContext.resetBetCount(0)};BetSlipController.prototype.pushBetRulesLink=function(){var n=this;return n._bsContext&&n._bsContext.PushBetRulesUrl?n._bsContext.PushBetRulesUrl():""};BetSlipController.prototype.highlightSelectedBets=function(){var n=this;return n._bsContext&&n._bsContext.HighlightSelectedBets?n._bsContext.HighlightSelectedBets():""};BetSlipController.prototype.showEnableMicrophoneMessage=function(){var n=new b365.Ui.Betslip.PermissionsDialog(this);this.showDialog(n,n.buildMarkup(),!1)};BetSlipController.prototype.addOnBetSlipLoaded=function(n){var t=this;t._instanceEventAttacher.addOnBetSlipLoaded(n)};BetSlipController.prototype.addOnBetAdded=function(n){var t=this;t._instanceEventAttacher.addOnBetAdded(n)};BetSlipController.prototype.addOnBetAddedReqComplete=function(n){var t=this;t._instanceEventAttacher.addOnBetAddedReqComplete(n)};BetSlipController.prototype.addOnEditBet=function(n){var t=this;t._instanceEventAttacher.addOnEditBet(n)};BetSlipController.prototype.addOnRefreshReqComplete=function(n){var t=this;t._instanceEventAttacher.addOnRefreshReqComplete(n)};BetSlipController.prototype.addOnBetSlipItemsChanged=function(n){var t=this;t._instanceEventAttacher.addOnBetSlipItemsChanged(n)};BetSlipController.prototype.addOnAcceptChanges=function(n){var t=this;t._instanceEventAttacher.addOnAcceptChanges(n)};BetSlipController.prototype.addOnMaxSelections=function(n){var t=this;t._instanceEventAttacher.addOnMaxSelections(n)};BetSlipController.prototype.addOnBetslipDisplayed=function(n){var t=this;t._instanceEventAttacher.addOnBetslipDisplayed(n)};BetSlipController.prototype.addOnPlaceBet=function(n){var t=this;t._instanceEventAttacher.addOnPlaceBet(n)};BetSlipController.prototype.addOnPlaceBetSuccess=function(n){var t=this;t._instanceEventAttacher.addOnPlaceBetSuccess(n)};BetSlipController.prototype.addOnAddBetslipFooterLinks=function(n){var t=this;t._instanceEventAttacher.addOnAddBetslipFooterLinks(n)};BetSlipController.prototype.addOnAddReceiptFooterLinks=function(n){var t=this;t._instanceEventAttacher.addOnAddReceiptFooterLinks(n)};BetSlipController.prototype.addOnAddReceiptLiveAlertSignUp=function(n){var t=this;t._instanceEventAttacher.addOnAddReceiptLiveAlertSignUp(n)};BetSlipController.prototype.addOnBetslipError=function(n){var t=this;t._instanceEventAttacher.addOnBetslipError(n)};BetSlipController.prototype.addOnShowBetSlip=function(n){var t=this;t._instanceEventAttacher.addOnShowBetSlip(n)};BetSlipController.prototype.addOnHideBetSlip=function(n){var t=this;t._instanceEventAttacher.addOnHideBetSlip(n)};BetSlipController.prototype.addOnChangeBetslipHeight=function(n){var t=this;t._instanceEventAttacher.addOnChangeBetslipHeight(n)};BetSlipController.prototype.addOnSessionExpired=function(n){var t=this;t._instanceEventAttacher.addOnSessionExpired(n)};BetSlipController.prototype.addOnHandleBetGuidChange=function(n){var t=this;t._instanceEventAttacher.addOnHandleBetGuidChange(n)};BetSlipController.prototype.showSiteOverlaySpinner=function(){var n=this;return n._bsContext&&n._bsContext.ShowSiteOverlaySpinner?(n._bsContext.ShowSiteOverlaySpinner(),!0):!1};BetSlipController.prototype.hideSiteOverlaySpinner=function(){var n=this;return n._bsContext&&n._bsContext.HideSiteOverlaySpinner?(n._bsContext.HideSiteOverlaySpinner(),!0):!1};BetSlipController.prototype.betSlipTypeChanged=function(n,t){var i=this;i._bsContext&&i._bsContext.BetSlipTypeChanged&&i._bsContext.BetSlipTypeChanged(n,t)};BetSlipController.prototype.betCallConnected=function(){var n=this;n._bsContext&&n._bsContext.betCallConnectedDelegate&&n._bsContext.betCallConnectedDelegate()};BetSlipController.prototype.betCallDisconnected=function(){var n=this;n._bsContext&&n._bsContext.betCallDisconnectedDelegate&&n._bsContext.betCallDisconnectedDelegate()};BetSlipController.prototype.getMultipleInfo=function(n){var t=this,i;t.ausMultiplesEnabled()&&(i=t._bsInst.getBetItems(t._bsInst.betTypeMultiple),i.length>=t._multiplesCombinationLimit?this.getMultipleBetCounts():n&&this.getMultipleCombinations())};BetSlipController.prototype.getMultipleCombinations=function(){var n=this;n.ausMultiplesEnabled()&&$.ajax({headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache",Pragma:"no-cache"},type:"GET",url:"/betslip/Core/MultiplesCombinations.ashx",cache:!1}).done(function(t){n.initialiseMultiplesData(t)}).fail(function(){})};BetSlipController.prototype.getMultipleBetCounts=function(){var n=this;$.ajax({headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache",Pragma:"no-cache"},type:"GET",url:"/betslip/Core/MultiplesBetCounts.ashx",cache:!1}).done(function(t){n.initialiseMultiplesData(t)}).fail(function(){})};BetSlipController.prototype.hasMultipleStakeEntries=function(){var t=this,n=t._bsInst.getBetItems(this._bsInst.betTypeMultiple);for(i=0;i<n.length;i++)if(n[i].getStItem("st"))return!0;return!1};BetSlipController.prototype.initialiseMultiplesData=function(n){var e=this,t,i,r,u,f;if(e.ausMultiplesEnabled()&&(this.complexMultiplesInfo=[],n.multiples)){for(this.totalsCalculator||(this.totalsCalculator=new b365.Ui.Betslip.TotalsCalculator(this._bsInst,this)),this.complexMultiplesInfo=n.multiples,t=0;t<this.complexMultiplesInfo.length;t++)if(r=[],this.complexMultiplesInfo[t].D1){for(u=this.complexMultiplesInfo[t].D1.split(","),i=0;i<u.length;i++)f=u[i].split("#"),r.push(f);this.complexMultiplesInfo[t].combinations=r}else this.complexMultiplesInfo[t].combinations=null;this.totalsCalculator.calculate()}};BetSlipController.prototype.pushConfigInitialised=function(){var n=this;Locator.pushedConfig.removeEventListener(n._pushConfigInitialisedEvent,n._pushConfigInitialisedDelegate);Locator.pushedConfig.addEventListener(n._ausMultiplesAvailabilityChangedEvent,n._ausMultiplesAvailabilityChangedDelegate);this.ausMultiplesAvailabilityChanged()};BetSlipController.prototype.ausMultiplesAvailabilityChanged=function(){var n=this,t=n._isAusDomain&&Locator.pushedConfig.getIsAusMultiplesAvailable();n._isAusMultiplesAvailable!==t&&(window.siteDataLocal.setItem("ausMultiplesAvailable",t?"1":"0"),n._isAusMultiplesAvailable=t,n.refreshBetslip())};BetSlipController.prototype.ausMultiplesEnabled=function(){var n=this;return n._isAusMultiplesAvailable};BetSlipController.prototype.updateMultiplesEachWayFlag=function(){var s=this,r,o,n;if(s.ausMultiplesEnabled()){var u="ew",t=this._bsInst.getBetItems(this._bsInst.betTypeMultiple),i=this._bsInst.getBetItems(this._bsInst.betTypeNormal);if(i&&i.length>0&&t&&t.length>0){var h=i.length,f=t.length,e=!1;for(r=0;r<h;r++)if(o=i[r].getStItem(u),o=="1"){for(e=!0,n=0;n<f;n++)t[n].setStItem(u,"1");break}if(!e)for(n=0;n<f;n++)t[n].setStItem(u,"0")}}};BetSlipController.prototype.hidePopups=function(n){var t=this;n!=t._enhancedBetSlipTypeSelector&&t._enhancedBetSlipTypeSelector&&t._enhancedBetSlipTypeSelector._isShowing&&t._enhancedBetSlipTypeSelector.hidePopUpMenu(t._enhancedBetSlipTypeSelector);n!=t._enhancedBetSlipOddsSelector&&t._enhancedBetSlipOddsSelector&&t._enhancedBetSlipOddsSelector._isShowing&&t._enhancedBetSlipOddsSelector.hidePopUpMenu(t._enhancedBetSlipOddsSelector);n!=t._enhancedBetSlipToteSelector&&t._enhancedBetSlipToteSelector&&t._enhancedBetSlipToteSelector._isShowing&&t._enhancedBetSlipToteSelector.hidePopUpMenu(t._enhancedBetSlipToteSelector);n!=t._enhancedBetSlipIfBetSelector&&t._enhancedBetSlipIfBetSelector&&t._enhancedBetSlipIfBetSelector._isShowing&&t._enhancedBetSlipIfBetSelector.hidePopUpMenu(t._enhancedBetSlipIfBetSelector);n!=t._enhancedBetSlipTeaserTypeSelector&&t._enhancedBetSlipTeaserTypeSelector&&t._enhancedBetSlipTeaserTypeSelector._isShowing&&t._enhancedBetSlipTeaserTypeSelector.hidePopUpMenu(t._enhancedBetSlipTeaserTypeSelector);n!=t._enhancedBetSlipAusRaceBetTypeSelector&&t._enhancedBetSlipAusRaceBetTypeSelector&&t._enhancedBetSlipAusRaceBetTypeSelector._isShowing&&t._enhancedBetSlipAusRaceBetTypeSelector.hidePopUpMenu(t._enhancedBetSlipAusRaceBetTypeSelector);n!=t._enhancedBetSlipEachWayExtraSelector&&t._enhancedBetSlipEachWayExtraSelector&&t._enhancedBetSlipEachWayExtraSelector._isShowing&&t._enhancedBetSlipEachWayExtraSelector.hidePopUpMenu(t._enhancedBetSlipEachWayExtraSelector);t._stakeEntryType!=t._stakeEntryTypes.deviceKeyBoard&&t._stakeEntryHander._isShowing&&t._stakeEntryHander.hide()};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.FooterLinksReceiptRender=function(n){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"};this._footerLinks=this._bsInst.footerLinks};b365.Ui.Betslip.FooterLinksReceiptRender.prototype={render:function(){var t,n,i;if(this._isValid&&this._footerLinks&&this._footerLinks.length>0)for(t=0;t<this._footerLinks.length;t++)n=this._footerLinks[t],i=$("<a/>",{"class":n.cssClass,html:"<button>"+n.text+"<\/button>"}),n.handler&&i.click(n.handler),i.appendTo(".footerLinks");this._bsInst.footerLinks=null}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.FooterLinksSlipRender=function(n,t){this._bsInst=n;this._isValid=function(){return typeof this._bsInst!="undefined"};this._footerLinks=this._bsInst.footerLinks;this._targetElem=t};b365.Ui.Betslip.FooterLinksSlipRender.prototype={render:function(){var t,n,i;if(this._isValid&&this._footerLinks&&this._footerLinks.length>0)for(t=0;t<this._footerLinks.length;t++)n=this._footerLinks[t],i=$("<a/>",{"class":n.cssClass,html:n.text}),n.handler&&i.click(n.handler),i.appendTo(this._targetElem);this._bsInst.footerLinks=null}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.FooterLiveAlertsReceipt=function(){function n(n){this._bsInst=n;this._matchAlertFixtures=[];this._numberOfFixtures=0;this._numberOfSubscriptions=0;this._matchAlertsContainer=null}return n.HEADER_LINK="BetSlipLiveAlert-Header__Link",n.HEADER_INNERTEXT="BetSlipLiveAlert-Header__InnerText",n.HEADER_BUTTON="BetSlipLiveAlert-Header__Button",n.HEADER_BUTTON_ACTIVE="BetSlipLiveAlert-Header__Button--Active",n.ROW_CONTAINER="BetSlipLiveAlert-RowContainer",n.ROW="BetSlipLiveAlertRow",n.ROW_BUTTON="BetSlipLiveAlertRow__Button",n.ROW_TEXT="BetSlipLiveAlertRow__Text",n.ROW_BUTTON_ACTIVE="BetSlipLiveAlertRow__Button--Active",n.prototype.render=function(){var t=this,u,f,e,o,s,i,r;if((t._matchAlertsContainer=document.getElementById("betSlipLiveAlertButtons"),t._matchAlertsContainer)&&(t._numberOfFixtures=parseInt(t._matchAlertsContainer.getAttribute("data-n"),10),!(t._numberOfFixtures<1))&&(t._matchAlertsContainer.className=t._matchAlertsContainer.className.replace(" hidden",""),u=document.getElementsByClassName(n.ROW_CONTAINER)[0],u)&&(t._numberOfFixtures>1&&(u.className+=" hidden"),f=document.getElementsByClassName(n.HEADER_LINK),f&&f.length>0&&new b365.Ui.Betslip.ResponsiveClickHandler(f[0],t._ExpandClickHandler.bind(t),!1),e=document.getElementsByClassName(n.HEADER_BUTTON),e&&e.length>0&&new b365.Ui.Betslip.ResponsiveClickHandler(e[0],t._HeaderClickHandler.bind(t),!1),o=u.getElementsByClassName(n.ROW),o)){for(s=0;s<o.length;s++)(i=o[s],i)&&(new b365.Ui.Betslip.ResponsiveClickHandler(i,t._ItemClickHandler.bind(t,i),!1),r={},r.fixtureId=parseInt(i.getAttribute("data-fixtureid")),r.classificationId=parseInt(i.getAttribute("data-classification")),r.alertKey=i.getAttribute("data-alertkey"),r.team1Id=parseInt(i.getAttribute("data-team1id")),r.team2Id=parseInt(i.getAttribute("data-team2id")),r.subscribed=null,t._matchAlertFixtures.push(r));t._bsInst.signupModel=new ns.mobile.betslip.MatchAlertSignUpModel(t._matchAlertFixtures,t.setBetReceiptMatchAlertsState.bind(this))}},n.prototype.setBetReceiptMatchAlertsState=function(){var i=this,f=document.getElementsByClassName(n.ROW_CONTAINER)[0],r,e,t,u,o;if(f){for(r=0,e=i._matchAlertFixtures.length;r<e;r++)(t=i._matchAlertFixtures[r],u=f.querySelectorAll("div."+n.ROW+"[data-fixtureid='"+t.fixtureId+"']")[0],u&&t)&&(o=u.getElementsByClassName(n.ROW_BUTTON)[0],i.toggleClass(o,n.ROW_BUTTON_ACTIVE,t.subscribed),t.subscribed&&i._numberOfSubscriptions++);this._SetHeaderButtonState()}},n.prototype._HeaderClickHandler=function(){var t=this,i=document.getElementsByClassName(n.HEADER_BUTTON)[0],r;i&&(r=function(){var r,u,e,o,f,s,h;if(window.sProps.deviceId&&window.sProps.deviceId.length!=0){for(r=i.className.indexOf(n.HEADER_BUTTON_ACTIVE)===-1,t.toggleClass(i,n.HEADER_BUTTON_ACTIVE,r),u=0;u<t._matchAlertFixtures.length;u++)t._matchAlertFixtures[u].subscribed=r;if(t._numberOfSubscriptions=r?t._numberOfFixtures:0,e=document.getElementsByClassName(n.ROW_CONTAINER)[0],e){for(o=e.getElementsByClassName(n.ROW),f=0,s=o.length;f<s;f++)h=o[f].getElementsByClassName(n.ROW_BUTTON)[0],t.toggleClass(h,n.ROW_BUTTON_ACTIVE,r);t._SetHeaderButtonState()}}},t._bsInst.signupModel._register(r))},n.prototype._ExpandClickHandler=function(){var t=document.getElementsByClassName(n.ROW_CONTAINER)[0];this.toggleClass(t,"hidden");this._bsInst.changeBetslipHeight()},n.prototype._ItemClickHandler=function(t){var i=this,r=t.getElementsByClassName(n.ROW_BUTTON)[0],u;r&&(u=function(){var e,u,f;if(window.sProps.deviceId&&window.sProps.deviceId.length!=0){if(e=parseInt(t.getAttribute("data-fixtureid"),10),u=i.getFixtureByFixtureId(e),!u)return!1;f=u.subscribed==null?!0:!u.subscribed;u.subscribed=f;f?i._numberOfSubscriptions++:i._numberOfSubscriptions--;i.toggleClass(r,n.ROW_BUTTON_ACTIVE,u.subscribed);i._SetHeaderButtonState()}},i._bsInst.signupModel._register(u))},n.prototype._SetHeaderButtonState=function(){var t=this,i=document.getElementsByClassName(n.HEADER_BUTTON)[0];t.toggleClass(i,n.HEADER_BUTTON_ACTIVE,t._numberOfSubscriptions==t._numberOfFixtures)},n.prototype.getFixtureByFixtureId=function(n){for(var i=this,t=0,r=i._matchAlertFixtures.length;t<r;t++)if(n==i._matchAlertFixtures[t].fixtureId)return i._matchAlertFixtures[t];return null},n.prototype.toggleClass=function(n,t,i){if(n){var r=n.className.indexOf(t);r===-1?(i===!0||i==null)&&(n.className+=" "+t):(i===!1||i==null)&&(n.className=n.className.replace(" "+t,""))}},n}();Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.DuplicateBetHandler=function(n,t){this._bsInst=n;this._bsController=t;this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.DuplicateBetHandler.prototype={handle:function(){this._isValid()&&(new b365.Ui.Betslip.ViewResetter(this._bsInst,this._bsController).reset(),new b365.Ui.Betslip.InProgressDisplayHandler(this._bsInst,this._bsController).handle(["hide",betSlipML.pleasecheckmembers]))}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ViewResetter=function(n,t){this._bsInst=n;this._bsController=t;this._bsWrapper=$("#bsDiv");this._isValid=function(){return typeof this._bsInst!="undefined"}};b365.Ui.Betslip.ViewResetter.prototype={reset:function(){this._isValid()&&(this._bsInst.clearBets(!1),new b365.Ui.Betslip.UpdateStateHandler(this._bsInst).handle(),new b365.Ui.Betslip.LockUnlockHandler(this._bsInst,this._bsController).handle(!1,!1),$(".emptyBetslip",this._bsWrapper).removeClass("hidden"),$(".single-section, .multiple-section, .cast-section",this._bsWrapper).remove(),$("a.placeBet",this._bsWrapper).disableElement("disabled"),$("select.bet-slip-type",this._bsWrapper).disableElement(),$("#BetSlipTypeSelector",this._bsWrapper).disableElement(),$(".totals",this._bsWrapper).hide(),$("#taxWarningHeader").addClass("hidden"))}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.PhoneBetHandler=function(n,t){this._bsInst=n;this._controller=t;this._popup=null;this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof this._controller!="undefined"}};b365.Ui.Betslip.PhoneBetHandler.prototype={initiate:function(n){$("#phoneBetOverlay").length==0&&(this.addOverlay(),this._bsInst.refresh(this._bsInst.reqTypePhoneBet,"cs="+encodeURIComponent(n),this._controller))},displayPopup:function(n){n&&this.addPopup(n)},addPopup:function(n){this._popup=$(n);this._popup.css({top:this.getPopupTopPosition()});this.addPopupListeners();$("body").append(this._popup)},addPopupListeners:function(){$("#closeIcon",this._popup).on("click",$.proxy(function(){this.removePopup();this.removeOverlay()},this));$("#phoneBetOverlay").on("click",$.proxy(function(){this.removePopup();this.removeOverlay()},this));var n=this;$(window).off("resize.phonepopup").on("resize.phonepopup",function(){n._popup.css({top:n.getPopupTopPosition(0)})})},addOverlay:function(){var n=$("<div/>",{id:"phoneBetOverlay",css:{height:document.body.scrollHeight}});$("body").append(n);$("html").addClass("overlay-on")},removePopup:function(){this._popup.remove()},removeOverlay:function(){$("#phoneBetOverlay").remove();$("html").removeClass("overlay-on")},getPopupTopPosition:function(n){var t=typeof n!="undefined"?n:$(window).scrollTop();return Math.round($(window).height()*.15)+t}};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.MaintenanceMessageHandler=function(){this._popup=null;this._isValid=function(){return!0}};b365.Ui.Betslip.MaintenanceMessageHandler.prototype={displayPopup:function(n){n&&(this.addOverlay(),this.addPopup(n))},addPopup:function(n){var t='<div class="popupContainer maintenanceMessage"><div class="popupHeader"><\/div><div class="popupText"><div>'+n+'<\/div><div class="greenButton" id="okButton">OK<\/div><\/div><\/div>';this._popup=$(t);this._popup.css({top:this.getPopupTopPosition()});this.addPopupListeners();$("body").append(this._popup)},addPopupListeners:function(){$("#okButton",this._popup).on("click",$.proxy(function(){this.removePopup();this.removeOverlay()},this));var n=this;$(window).off("resize.maintenancepopup").on("resize.maintenancepopup",function(){n._popup.css({top:n.getPopupTopPosition(0)})})},addOverlay:function(){var n=$("<div/>",{id:"maintenanceMessageOverlay",css:{height:document.body.scrollHeight}});$("body").append(n)},removePopup:function(){this._popup.remove()},removeOverlay:function(){$("#maintenanceMessageOverlay").remove()},getPopupTopPosition:function(n){var t=typeof n!="undefined"?n:$(window).scrollTop();return Math.round($(window).height()*.15)+t}},function(){Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ItemSubscriptionManager=function(n){this._bsInst=n;this._bsController=null;this._bsWrapper=$("#bsDiv");this._subscriptions=[];this._bbSubscriptions={};this._isValid=function(){return typeof this._bsInst!="undefined"&&typeof ns_gen5_util!="undefined"}};b365.Ui.Betslip.ItemSubscriptionManager.prototype={attach:function(n){this.subscribe(n)},detach:function(){this._isValid()&&($('li[data-item-type="single"]',this._bsWrapper).each(function(){var n=$(this).get(0),t;n&&n.wrapper&&(t=n.wrapper,t.detatchStem(),Locator.subscriptionManager.unsubscribe(t._topic,ns_gen5_data.SubscriptionManagerFlags.BATCH,!0,!0))}),Locator.validationManager.processValidationCycleNow())},subscribe:function(n){var e,u,c,o,f,v,s,l,i,a,h,r,t;if(this._isValid()&&this._bsWrapper.find(".betReceipt").length<=0){for(this._bsController=n,e=this._bsInst.getBetItems(this._bsInst.betTypeNormal),i=0;i<e.length;i++)if(u=e[i].getCnItem("fp"),c=$('li[data-item-fpid="'+u+'"]',this._bsWrapper),o,c&&(o=c.find(".js-RelatedMarketMenu")),o.length>0)for(f=o[0].children,v=f.length,r=0;r<v;r++)t=f[r].getAttribute("data-topicid"),t?(s=f[r].getAttribute("data-item"),s&&(u=s.substring(2,s.indexOf("#"))),this._subscriptions[u]==undefined&&(this._subscriptions[u]=[]),this._subscriptions[u].push(i)):f[r].className.indexOf("bs-EachWayExtraBetType_MenuItemWrapper")>-1&&(u=f[r].getAttribute("data-participantid"),t="BS"+u,this._subscriptions[u]==undefined&&(this._subscriptions[u]=[]),this._subscriptions[u].push(i)),Locator.subscriptionManager.subscribe(t,new ns_gen5_util.Delegate(this,this._snapshotRelatedMarketHandler),!0,!0,null,!0);else t=e[i].getTopic(),t&&(this._subscriptions[u]=i,Locator.subscriptionManager.subscribe(t,new ns_gen5_util.Delegate(this,this._snapshotHandler),!0,!0,null,!0));for(l=this._bsInst.getBetItems(this._bsInst.betTypeBetBuilder),i=0;i<l.length;i++)for(a=l[i],h=a.getBBItems(),r=0;r<h.length;r++)t=h[r].getValue("TP"),t&&(this._bbSubscriptions[t]||(this._bbSubscriptions[t]=[],Locator.subscriptionManager.subscribe(t,new ns_gen5_util.Delegate(this,this._betBuilderSnapshotHandler),!0,!0,null,!0)),this._bbSubscriptions[t].push({index:i,betItem:a,subItem:h[r]}))}},unsubscribe:function(){var u,f,l,t,r,a,s,i;if(this._isValid()){var o=this._bsInst.getBetItems(),h=this._bsInst.getBetItems(this._bsInst.betTypeBetBuilder),e,n,c=[];for(t=0,r=o.length;t<r;t++)if(u=$('li[data-item-id="'+t+'"][data-item-type="single"]',this._bsWrapper).get(0),u&&(e=$(u).find(".js-RelatedMarketMenu"),u.wrapper&&u.wrapper.detatchStem()),e&&e.length>0)for(f=e[0].children,l=f.length,i=0;i<l;i++)n=f[i].getAttribute("data-topicid"),f[i].className.indexOf("bs-EachWayExtraBetType_MenuItemWrapper")>-1&&(itemFp=f[i].getAttribute("data-participantid"),n="BS"+itemFp),n&&c.indexOf(n)==-1&&(c.push(n),Locator.subscriptionManager.unsubscribe(n,ns_gen5_data.SubscriptionManagerFlags.BATCH,!0,!0));else o[t]&&(n=o[t].getTopic()),n&&Locator.subscriptionManager.unsubscribe(n,ns_gen5_data.SubscriptionManagerFlags.BATCH,!0,!0);for(t=0,r=h.length;t<r;t++)for(a=h[t],s=a.getBBItems(),i=0;i<s.length;i++)n=s[i].getValue("TP"),n&&Locator.subscriptionManager.unsubscribe(n,ns_gen5_data.SubscriptionManagerFlags.BATCH,!0,!0);Locator.validationManager.processValidationCycleNow()}},_betBuilderSnapshotHandler:function(n){for(var f=Locator.treeLookup.getReference(n.type),i=this._bbSubscriptions[n.type],r,u,t=0;t<i.length;t++)r=$('li[data-item-id="'+i[t].index+'"][data-item-type="betbuilder"]',this._bsWrapper).get(0),r&&(u=new b365.Ui.Betslip.ItemDisplayBetBuilder(r,this._bsInst,this._bsController,n.type,i[t].index,i[t].betItem,i[t].subItem),u.stem=f,u.initialize())},_snapshotHandler:function(n){var t=Locator.treeLookup.getReference(n.type),u,i,r;t&&(u=this._subscriptions[t.data.ID],i=$('li[data-item-id="'+u+'"][data-item-type="single"]',this._bsWrapper).get(0),i&&(r=new b365.Ui.Betslip.ItemDisplay(i,this._bsInst,this._bsController,n.type),r.stem=t,r.initialize()))},_snapshotRelatedMarketHandler:function(n){var f=Locator.treeLookup.getReference(n.type),i,e,r,u,o,t;if(f&&(o=this._subscriptions[f.data.ID].shift(),t=$('li[data-item-id="'+o+'"][data-item-type="single"]',this._bsWrapper).get(0),t)){if(this._bsController&&this._bsController._dlg&&(i=$("#okButton"),i.length>0&&(e=i[0].getAttribute("data-action"),e&&e==="refer"&&(r=$("#bsCD"),r.length>0&&r[0].hasAttribute("style")&&r.css("display")!="none"&&this._bsController._dlg.hideDialog(),i.removeClass("disabled"),$("#closeButton").removeClass("disabled")))),t.getElementsByClassName("bs-AusRaceBetType").length>0)u=new b365.Ui.Betslip.ItemDisplayAusRacing(t,this._bsInst,this._bsController,n.type);else if(t.getElementsByClassName("bs-EachWayExtraBetType").length>0)u=new b365.Ui.Betslip.ItemDisplayEachWayExtra(t,this._bsInst,this._bsController,n.type);else return;u.stem=f;u.initialize()}}}}();Type.registerNamespace("b365.Ui.Betslip");typeof ns_gen5_ui!="undefined"&&(b365.Ui.Betslip.ItemDisplay=function(){function t(n,t,i,r){h.Wrapper.call(this,n);this._delegate_renewSubscriptionHandler=new o(this,this._renewSubscriptionHandler);this._bsInst=t;this._bsController=i;this._topic=r;this._ausRacingPlbtidLookup=["20203","20204","40232","40233","880203","880204"];this._isValid=function(){return typeof this._bsInst!="undefined"&&!$(".betReceipt",this._bsWrapper).length>0&&this.stem&&!this._bsInst._lock};$("#bsDiv").on(this._topic,$.proxy(this.RemoveStemDelegates,this))}var a=extend(ns_gen5_ui.ComponentStemBase,t),u=ns_gen5_ui.TextNode,h=ns_gen5_ui.Component,n=b365.Attribute,i=ns_gen5_util.OddsConverter,e=ns_gen5_util.OddsType,v=ns_gen5_data.StemEvent,f=ns_gen5_data.SubscriptionManagerEvent,o=ns_gen5_util.Delegate,r="suspended",c="hcapChange",l="oddsChange",s;return t.prototype._topic=null,t.prototype._oddsTypeOverride=0,t.prototype.decimalPlaces=2,t.prototype._hasNormalOdds=!1,t._betSlipWrapper=null,t.prototype.betSlipWrapper=function(){return this._betSlipWrapper||(this._betSlipWrapper=$("#bsDiv")),this._betSlipWrapper},t.prototype.RemoveStemDelegates=function(){this.detatchStem()},t.prototype.createChildren=function(){var s,e;if(this._isValid()){var t=this.stem.data,o=this._getElementByClassName("hdCapDisplay"),i=this._getElementByClassName("odds");this._hasNormalOdds=this._bsInst.getSlipType()!==this._bsInst.slipFixedTeaser;i&&(i.tagName.toLowerCase()==="select"&&(i=i.children[0]),i.firstChild?this._oddsText=new u.Wrapper(i.firstChild):(this._oddsText=new u,i.appendChild(this._oddsText._element)));o&&(this._handicapText=new u.Wrapper(o.firstChild));t&&(this._betItem=this._bsInst.getBetItemByCn(this._bsInst.betTypeNormal,"fp",t[n.ID]));this._betItem&&(this._oddsTypeOverride=this._betItem.getOddsOverride()||this._oddsTypeOverride,this.decimalPlaces=this._betItem.getDecimalPlaces()||this.decimalPlaces,s=this._element.className.indexOf(r)>-1,this._oddsChanged=n.ODDS in t&&this._betItem.getCnItem("o")!==t[n.ODDS]&&this._hasNormalOdds,this._handicapChanged=n.HANDICAP in t&&this._betItem.getCnItem("ln")&&parseFloat(this._betItem.getCnItem("ln"))!==parseFloat(t[n.HANDICAP]),e=this._element.getAttribute("data-item-plbtid"),this._suspendedChanged=n.SUSPENDED in t&&t[n.SUSPENDED]==="1"||this._hasNormalOdds&&e&&this._ausRacingPlbtidLookup.indexOf(e)>-1&&this._betItem.getCnItem("o")&&(this._betItem.getCnItem("o")==="SP"||this._betItem.getCnItem("o")==="0/0"),this._topic&&Locator.subscriptionManager.addEventListener(f.RENEW_SUBSCRIPTION,this._delegate_renewSubscriptionHandler),t[n.CHANGE_STAMP]&&this._betItem.setCnItem("sa",t[n.CHANGE_STAMP]))}},t.prototype.commitProperties=function(){var u,s,t,p,w,b,h,f,a;if(this._isValid()){u=this.stem.data;this._betItem=this._bsInst.getBetItemByCn(this._bsInst.betTypeNormal,"fp",u[n.ID]);var v=this._oddsChanged||this._handicapChanged,y=this._suspendedChanged,o=0;this._oddsChanged&&this._handicapChanged?o=3:this._handicapChanged?o=2:this._oddsChanged&&(o=1);o>0&&this._betItem.setStItem("olc",String(o));(this._oddsChanged||this._handicapChanged)&&n.CHANGE_STAMP in u&&this._betItem.setCnItem("sa",u[n.CHANGE_STAMP]);s=!1;this._oddsChanged&&this._oddsText&&(t=u[n.ODDS],p=this._oddsTypeOverride||Locator.user.oddsTypeId,s=i.AreOddsBelowMinimum(t),s?t=i.NOT_OFFERED:t=="0/0"?t="SP":p==e.DECIMAL?t=i.ConvertOddsDecimal(t,this.decimalPlaces):p==e.AMERICAN&&(t=i.ConvertOddsUS(t)),this._oddsText.setText(t||""),w=this._getElementByClassName("EnhancedOddsSelection"),w&&(w.innerHTML=t,b=this._getElementByClassName("EnhancedOdds"),b&&(h=b.firstElementChild,h&&(h.innerText=t,h.setAttribute("data-item",t)))),this.addStyle(l),this._betItem.setCnItem("o",u[n.ODDS]));this._handicapChanged&&this._handicapText&&(f=u[n.HANDICAP]||"",f=f.length>0&&f.indexOf(".")==-1?Number(f).toFixed(1):f,this._bsInst.getSlipType()===this._bsInst.slipFixedTeaser&&(f=f.replace("+","")),this._handicapText.setText(f),this.addStyle(c),this._betItem.setCnItem("ln",u[n.HANDICAP]));a=!1;this._suspendedChanged&&(this._suspendedChanged=!1,u[n.SUSPENDED]==="1"?(this._betItem.setStItem("_s","1"),a=!0):this._betItem.setStItem("_s","0"));(y||this._oddsChanged)&&(a||s?this.addStyle(r):this.removeStyle(r));(v||y)&&this._bsInst.updateState();v&&new b365.Ui.Betslip.TotalsCalculator(this._bsInst,this._bsController).calculate();(v||y)&&new b365.Ui.Betslip.OddsLineChangedHandler(this._bsInst,this._bsController).handle(a)}},t.prototype.suspend=function(){this._betItem&&this._betItem.setStItem("_s","1");this.addStyle(r);this._bsInst&&this._bsController&&new b365.Ui.Betslip.OddsLineChangedHandler(this._bsInst,this._bsController).handle(!0)},t.prototype.stemUpdateHandler=function(t,i){this._oddsChanged=this._oddsChanged||n.ODDS in i&&this._hasNormalOdds;this._handicapChanged=this._handicapChanged||n.HANDICAP in i&&this._betItem.getCnItem("ln")&&parseFloat(this._betItem.getCnItem("ln"))!==parseFloat(i[n.HANDICAP]);this._suspendedChanged=n.SUSPENDED in i;this.invalidateProperties()},s=t.prototype.stemDeleteHandler,t.prototype.stemDeleteHandler=function(n){this._isValid()&&this.suspend();s.call(this,n)},t.prototype.detatchStem=function(){Locator.subscriptionManager.hasEventListenerWithDelegate(f.RENEW_SUBSCRIPTION,this._delegate_renewSubscriptionHandler)&&Locator.subscriptionManager.removeEventListener(f.RENEW_SUBSCRIPTION,this._delegate_renewSubscriptionHandler);this.stem&&(this.stem.removeDelegate(this),this.stem=null)},t.prototype._renewSubscriptionHandler=function(){var n=this;this.detatchStem();Locator.validationManager.callLater(function(){Locator.subscriptionManager.subscribe(n._topic,new o(n,n._snapshotHandler),!0,!0,null,!0)})},t.prototype._snapshotHandler=function(){var n=this;Locator.validationManager.callLater(function(){n._reInitialise()})},t.prototype._reInitialise=function(){var n=Locator.treeLookup.getReference(this._topic);n&&(this.stem=n,this.initialize())},t.prototype._getElementByClassName=function(n){var t=this._element.getElementsByClassName(n);return t.length>0?t[0]:null},t}());Type.registerNamespace("b365.Ui.Betslip");typeof ns_gen5_ui!="undefined"&&(b365.Ui.Betslip.ItemDisplayAusRacing=function(){function n(n,t,i,r){s.Wrapper.call(this,n);this._delegate_renewSubscriptionHandler=new e(this,this._renewSubscriptionHandler);this._ausRacingPlbtidLookup=["20203","20204","40232","40233","880203","880204"];this._bsInst=t;this._bsController=i;this._topic=r;this._isValid=function(){return typeof this._bsInst!="undefined"&&!$(".betReceipt",this._bsWrapper).length>0&&this.stem&&!this._bsInst._lock}}var c=extend(ns_gen5_ui.ComponentStemBase,n),l=ns_gen5_ui.TextNode,s=ns_gen5_ui.Component,t=b365.Attribute,i=ns_gen5_util.OddsConverter,u=ns_gen5_util.OddsType,a=ns_gen5_data.StemEvent,f=ns_gen5_data.SubscriptionManagerEvent,e=ns_gen5_util.Delegate,r="suspended",h="oddsChange",o;return n.prototype._topic=null,n.prototype._oddsTypeOverride=-1,n.prototype.decimalPlaces=2,n.prototype._hasNormalOdds=!1,n._betSlipWrapper=null,n.prototype.betSlipWrapper=function(){return this._betSlipWrapper||(this._betSlipWrapper=$("#bsDiv")),this._betSlipWrapper},n.prototype.createChildren=function(){var n,u,i;this._isValid()&&(n=this.stem.data,this._hasNormalOdds=this._bsInst.getSlipType()!==this._bsInst.slipFixedTeaser,n&&(this._betItem=this._bsInst.getBetItemByCn(this._bsInst.betTypeNormal,"fp",n[t.ID])),this._betItem&&(this._oddsTypeOverride=this._betItem.getOddsOverride()||this._oddsTypeOverride,this.decimalPlaces=this._betItem.getDecimalPlaces()||this.decimalPlaces,u=this._element.className.indexOf(r)>-1,this._oddsChanged=t.ODDS in n&&this._betItem.getCnItem("o")!==n[t.ODDS]&&this._hasNormalOdds,i=this._element.getAttribute("data-item-plbtid"),this._suspendedChanged=t.SUSPENDED in n&&n[t.SUSPENDED]==="1"||this._hasNormalOdds&&i&&this._ausRacingPlbtidLookup.indexOf(i)>-1&&this._betItem.getCnItem("o")&&(this._betItem.getCnItem("o")==="SP"||this._betItem.getCnItem("o")==="0/0"),this._topic&&Locator.subscriptionManager.addEventListener(f.RENEW_SUBSCRIPTION,this._delegate_renewSubscriptionHandler)))},n.prototype.commitProperties=function(){var i,y,o,st,u,c,g,v,p,ht,l,w,nt,tt,b,ct;if(this._isValid()){i=this.stem.data;this._betItem=this._bsInst.getBetItemByCn(this._bsInst.betTypeNormal,"fp",i[t.ID]);var it=this._getElementByClassName("bs-AusRaceBetType_Menu"),lt=it.parentElement.parentElement.getElementsByClassName("ausracebettype-sel")[0],k=it.children,at=lt.children,rt=k.length,a,ut,v,ft,et,d,n,f,e;if(this._oddsChanged){for(f=0;f<rt;f++){n=k[f];var vt=at[f],s=n.getAttribute("data-item"),ot=s.indexOf("FW")>-1&&s.indexOf("FP")>-1;if(n.getAttribute("data-bettype")=="FixedEachWay"?(d=n,ut=n.className.indexOf("selected")>-1):n.getAttribute("data-bettype")=="FixedWin"?ft=n:n.getAttribute("data-bettype")=="FixedPlace"&&(et=n),s.indexOf("FW")>-1||s.indexOf("FP")>-1){for(y=s.split("~"),o="",e=0;e<y.length;e++)u=y[e].split("#"),c=u[0],u.push(c.substr(0,2)),c=u[0]=c.substring(2,c.length),o+=u[2]+u[0]+"#",i[t.ID]==c?(o+=i[t.ODDS],u[1]=i[t.ODDS]):o+=u[1],this._oddsTypeOverride==-1&&(g=this._bsInst.getBetItemByCn(this._bsInst.betTypeNormal,"fp",u[0]),g&&(this._oddsTypeOverride=g.getOddsOverride())),s.indexOf(i[t.ID])>-1&&(ot||(a=this.getOdds(i[t.ODDS]),n.setAttribute("data-odds",a)),n.className.indexOf("selected")>-1&&(ot&&e==0&&(this._betItem=this._bsInst.getBetItemByCn(this._bsInst.betTypeNormal,"fp",u[0])),this._betItem&&(st=!0,e==0?this._betItem.setCnItem("o",u[1]):this._betItem.setCnItem("po",u[1])))),y.length==2&&e==0&&(o+="~");vt.value=o;n.setAttribute("data-item",o)}}d&&(v=ft.getAttribute("data-odds")+", "+et.getAttribute("data-odds"),d.setAttribute("data-odds",v),ut&&(a=v));st&&this._betItem&&(this._betItem.setStItem("olc","1"),t.CHANGE_STAMP in i&&this._betItem.setCnItem("sa",i[t.CHANGE_STAMP]),p=this._getElementByClassName("odds"),p&&(p.innerHTML=p.innerHTML=a,this.addStyle(h)),l=!1,this._suspendedChanged&&(this._suspendedChanged=!1,i[t.SUSPENDED]==="1"?(this._betItem.setStItem("_s","1"),l=!0):this._betItem.setStItem("_s","0")),ht=!1,(this._suspendedChanged||this._oddsChanged)&&(l||ht?this.addStyle(r):this.removeStyle(r)),(this._oddsChanged||this._suspendedChanged)&&this._bsInst.updateState(),this._oddsChanged&&new b365.Ui.Betslip.TotalsCalculator(this._bsInst,this._bsController).calculate(),(this._oddsChanged||this._suspendedChanged)&&new b365.Ui.Betslip.OddsLineChangedHandler(this._bsInst,this._bsController).handle(l))}for(f=0;f<rt;f++)n=k[f],b=n.getAttribute("data-bettype"),b=="FixedEachWay"?w=n:b=="FixedWin"?nt=n:b=="FixedPlace"&&(tt=n),ct=n.getAttribute("data-topicid"),ct==i[t.TOPIC_ID]&&(i[t.SUSPENDED]=="1"?(l=!0,$(n).addClass("suspend")):$(n).removeClass("suspend"));w&&(nt&&$(nt).hasClass("suspend")||tt&&$(tt).hasClass("suspend")?$(w).addClass("suspend"):$(w).removeClass("suspend"))}},n.prototype.getOdds=function(n){var t=n,r=this._oddsTypeOverride||Locator.user.oddsTypeId;return areOddsBelowAllowedMinimum=i.AreOddsBelowMinimum(t),areOddsBelowAllowedMinimum?t=i.NOT_OFFERED:t=="0/0"?t="SP":r==u.DECIMAL?t=i.ConvertOddsDecimal(t,this.decimalPlaces):r==u.AMERICAN&&(t=i.ConvertOddsUS(t)),t},n.prototype.suspend=function(){this._betItem&&this._betItem.setStItem("_s","1");this.addStyle(r);this._bsInst&&this._bsController&&new b365.Ui.Betslip.OddsLineChangedHandler(this._bsInst,this._bsController).handle(!0)},n.prototype.stemUpdateHandler=function(n){var i=n.data;this._oddsChanged=this._oddsChanged||t.ODDS in i&&this._hasNormalOdds;this._suspendedChanged=t.SUSPENDED in i;this.invalidateProperties()},o=n.prototype.stemDeleteHandler,n.prototype.stemDeleteHandler=function(n){this._isValid()&&this.suspend();o.call(this,n)},n.prototype.detatchStem=function(){this.stem&&this._betItem&&this._topic&&Locator.subscriptionManager.removeEventListener(f.RENEW_SUBSCRIPTION,this._delegate_renewSubscriptionHandler);this.stem&&(this.stem.removeDelegate(this),this.stem=null)},n.prototype._renewSubscriptionHandler=function(){var n=this;this.detatchStem();Locator.validationManager.callLater(function(){Locator.subscriptionManager.subscribe(n._topic,new e(n,n._snapshotHandler),!0,!0,null,!0)})},n.prototype._snapshotHandler=function(){var n=this;Locator.validationManager.callLater(function(){n._reInitialise()})},n.prototype._reInitialise=function(){var n=Locator.treeLookup.getReference(this._topic);n&&(this.stem=n,this.initialize())},n.prototype._getElementByClassName=function(n){var t=this._element.getElementsByClassName(n);return t.length>0?t[0]:null},n}());Type.registerNamespace("b365.Ui.Betslip");typeof ns_gen5_ui!="undefined"&&(b365.Ui.Betslip.ItemDisplayEachWayExtra=function(){function i(n,t,i,r){f.Wrapper.call(this,n);this._delegate_renewSubscriptionHandler=new e(this,this._renewSubscriptionHandler);this._bsInst=t;this._bsController=i;this._topic=r;this._ausRacingPlbtidLookup=["20203","20204","40232","40233","880203","880204"];this._isValid=function(){return typeof this._bsInst!="undefined"&&!$(".betReceipt",this._bsWrapper).length>0&&this.stem&&!this._bsInst._lock}}var s=extend(b365.Ui.Betslip.ItemDisplay,i),h=ns_gen5_ui.TextNode,f=ns_gen5_ui.Component,n=b365.Attribute,t=ns_gen5_util.OddsConverter,u=ns_gen5_util.OddsType,c=ns_gen5_data.StemEvent,l=ns_gen5_data.SubscriptionManagerEvent,e=ns_gen5_util.Delegate,r="suspended",o="oddsChange";return i.prototype.stemUpdateHandler=function(t){var i=t.data;this._betItem=this._bsInst.getBetItemByCn(this._bsInst.betTypeNormal,"fp",i[n.ID]);this._betItem&&(this._oddsChanged=this._oddsChanged||n.ODDS in i&&this._hasNormalOdds&&this._betItem.getCnItem("o")!==i[n.ODDS],this._suspendedChanged=n.SUSPENDED in i,(this._oddsChanged||this._suspendedChanged)&&this.invalidateProperties())},i.prototype.stemDeleteHandler=function(){this._suspendedChanged=!0;this._deleted=!0;this.invalidateProperties()},i.prototype.commitProperties=function(){var f,l,w,i,b,k,y,s,e,a,h;if(this._isValid()){f=this.stem.data;this._betItem=this._bsInst.getBetItemByCn(this._bsInst.betTypeNormal,"fp",f[n.ID]);var d=this._element.getAttribute("data-item-fpid")==f[n.ID],c=this._oddsChanged&&d,v=this._suspendedChanged&&d,p=0;c&&(p=1);p>0&&this._betItem&&this._betItem.setStItem("olc",String(p));c&&n.CHANGE_STAMP in f&&this._betItem&&this._betItem.setCnItem("sa",f[n.CHANGE_STAMP]);l=!1;w=this._getElementByClassName("odds");c&&w&&(i=f[n.ODDS],a=this._oddsTypeOverride||Locator.user.oddsTypeId,l=t.AreOddsBelowMinimum(i),l?i=t.NOT_OFFERED:i=="0/0"?i="SP":a==u.DECIMAL?i=t.ConvertOddsDecimal(i,this.decimalPlaces):a==u.AMERICAN&&(i=t.ConvertOddsUS(i)),h=this._deleted||f[n.SUSPENDED]=="1",this._betItem&&(w.innerHTML=i||"",b=this._getElementByClassName("EnhancedOddsSelection"),b&&(b.innerHTML=i,k=this._getElementByClassName("EnhancedOdds"),k&&(y=k.firstElementChild,y&&(y.innerText=i,y.setAttribute("data-item",i)))),this.addStyle(o),this._betItem.setCnItem("o",f[n.ODDS]),v&&(h?this._betItem.setStItem("_s","1"):this._betItem.setStItem("_s","0")),(v||c)&&(h||l?this.addStyle(r):this.removeStyle(r)),(c||v)&&this._bsInst.updateState(),c&&new b365.Ui.Betslip.TotalsCalculator(this._bsInst,this._bsController).calculate(),(c||v)&&new b365.Ui.Betslip.OddsLineChangedHandler(this._bsInst,this._bsController).handle(h)));(this._oddsChanged||this._suspendedChanged)&&(s=this._element.querySelector(".bs-EachWayExtraBetType_MenuItemWrapper[data-participantid='"+f[n.ID]+"']"),s&&(e=f[n.ODDS],s.setAttribute("data-odds",e),a=this._oddsTypeOverride||Locator.user.oddsTypeId,l=t.AreOddsBelowMinimum(e),l?e=t.NOT_OFFERED:e=="0/0"?e="SP":a==u.DECIMAL?e=t.ConvertOddsDecimal(e,this.decimalPlaces):a==u.AMERICAN&&(e=t.ConvertOddsUS(e)),s.querySelector(".bs-EachWayExtraBetType_MenuItemOdds").innerText=e,h=this._deleted||f[n.SUSPENDED]=="1",h&&s.className.indexOf(r)==-1||l?s.className=s.className+" "+r:h||(s.className=s.className.replace(" "+r,""))));this._oddsChanged=!1;this._suspendedChanged=!1}},i._betSlipWrapper=null,i}());Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.BetBuilderPriceCalc=function(){function t(){}var n={},i=0,r=function(t,r,f){for(var c=r.getBBItems(),l="f="+r.getStItem("f")+"&l="+Locator.user.languageId+"&p=",o="",e,h,s=0;s<c.length;s++)o.length&&(o+="|"),o+=c[s].getValue("fp");l+=encodeURIComponent(o);e=new XMLHttpRequest;h=!1;e.onreadystatechange=function(){if(e.readyState==4&&!h){if(h=!0,e.onreadystatechange=null,!n[t])return;delete n[t];i--;e.status==200?u(r,e.responseText,f):f.updateOdds(null)}};e.open("POST","/betbuilderapi/priceip",!0);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.withCredentials=!1;e.send(l)},u=function(n,t,i){var o=n.getBBItems(),u="bbprice",r,f,e;ns_gen5_data.DataUtil.ParseMessage(t,u);r=Locator.treeLookup.getReference(u);r?(f=r.data.OD,e=r.data.PO||r.data.OD,i.updateOdds(f,e)):i.updateOdds(null)};return t.PendingRequests=function(){return i>0},t.FetchPrice=function(t,u,f){if(!n[t]){var e=setTimeout(function(){r(t,u,f)},Math.floor(Math.random()*5e3));i++;n[t]=e}},t.CancelPriceFetch=function(t){var r=n[t];return r?!0:!1},t}();Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ItemDisplayBetBuilder=function(){function n(n,t,i,u,f,o,s){e.Wrapper.call(this,n);this._bsInst=t;this._bsController=i;this._topic=u;this._index=f;this._betItem=o;this._subItem=s;this._bsWrapper=$("#bsDiv");this.requestPriceOnUnsuspend=!1;this.jQueryEle=$(n);this._isValid=function(){return typeof this._bsInst!="undefined"&&!$(".betReceipt",this._bsWrapper).length>0&&this.stem&&!this._bsInst._lock};this.suspend=function(n){var i,t;if(n)this._betItem.setStItem("_s","1"),this._subItem.setValue("_s","1"),this.jQueryEle.addClass(r),$("a.placeBet",this._bsWrapper).removeClass("bbPricefetch"),$("a.acceptChanges",this._bsWrapper).removeClass("bbPricefetch"),b365.Ui.Betslip.BetBuilderPriceCalc.CancelPriceFetch(this._index)&&(this.requestPriceOnUnsuspend=!0);else{for(this._subItem.setValue("_s","0"),i=this._betItem.getBBItems(),t=0;t<i.length;t++)if(i[t].getValue("_s")==="1"){n=!0;break}n||(this._betItem.setStItem("_s","0"),this.jQueryEle.removeClass(r),this.requestPriceOnUnsuspend&&(this.requestPriceOnUnsuspend=!1,this.fetchPrice()))}new b365.Ui.Betslip.OddsLineChangedHandler(this._bsInst,this._bsController).handle(n);this._bsInst.updateState()};this.fetchPrice=function(){b365.Ui.Betslip.BetBuilderPriceCalc.FetchPrice(this._index,this._betItem,this);$("a.placeBet",this._bsWrapper).addClass("bbPricefetch");$("a.acceptChanges",this._bsWrapper).addClass("bbPricefetch")}}var s=extend(ns_gen5_ui.ComponentStemBase,n),e=ns_gen5_ui.Component,t=b365.Attribute,i=ns_gen5_util.OddsConverter,u=ns_gen5_util.OddsType,h=ns_gen5_data.StemEvent,r="suspended",o="oddsChange",f="deleted";return n.prototype._oddsTypeOverride=0,n.prototype.decimalPlaces=2,n.prototype._hasNormalOdds=!1,n._betSlipWrapper=null,n.prototype.betSlipWrapper=function(){return this._betSlipWrapper||(this._betSlipWrapper=$("#bsDiv")),this._betSlipWrapper},n.prototype.createChildren=function(){var n,i,u;this._isValid()&&(this._hasNormalOdds=this._bsInst.getSlipType()!==this._bsInst.slipFixedTeaser,n=this.stem.data,this._oddsElement=this._getElementByClassName("odds bs-BetBuilderSelection_Odds"),this._betItem&&(this._oddsTypeOverride=this._betItem.getOddsOverride()||this._oddsTypeOverride,this.decimalPlaces=2,i=this._element.className.indexOf(r)>-1,this._oddsChanged=t.ODDS in n&&this._subItem.getValue("o")!==n[t.ODDS]&&this._hasNormalOdds,this._suspendedChanged=t.SUSPENDED in n&&n[t.SUSPENDED]==="1"!==i,u=t.HANDICAP in n&&this._subItem.getValue("ln")&&parseFloat(this._subItem.getValue("ln"))!==parseFloat(n[t.HANDICAP]),u&&this.stemDeleteHandler()))},n.prototype.updateOdds=function(n,r){var e,s,f;if(b365.Ui.Betslip.BetBuilderPriceCalc.PendingRequests()||($("a.placeBet",this._bsWrapper).removeClass("bbPricefetch"),$("a.acceptChanges",this._bsWrapper).removeClass("bbPricefetch"),$("a.updatingOdds",this._bsWrapper).addClass("hidden")),!n){this.suspend(!0);return}if(e=this.stem.data,this._subItem.setValue("o",e[t.ODDS]),s=this._betItem.getStItem("o"),r==s&&$("a.acceptChanges",this._bsWrapper).hasClass("hidden")){$("a.placeBet",this._bsWrapper).removeClass("hidden");return}this._betItem.setStItem("olc","1");this._betItem.setStItem("o",r);this._bsInst.updateState();this.jQueryEle.addClass(o);f=this._oddsTypeOverride||Locator.user.oddsTypeId;areOddsBelowAllowedMinimum=i.AreOddsBelowMinimum(r);areOddsBelowAllowedMinimum?r=i.NOT_OFFERED:r=="0/0"?r="SP":f==u.DECIMAL?r=i.ConvertOddsDecimal(r,this.decimalPlaces):f==u.AMERICAN&&(r=i.ConvertOddsUS(r));this._oddsElement.innerHTML=n;b365.Ui.Betslip.BetBuilderPriceCalc.PendingRequests()||(new b365.Ui.Betslip.OddsLineChangedHandler(this._bsInst,this._bsController).handle(!1),new b365.Ui.Betslip.TotalsCalculator(this._bsInst,this._bsController).calculate())},n.prototype.commitProperties=function(){if(this._isValid()){var n=this.stem.data,i=this._oddsChanged,u=this._suspendedChanged;this.jQueryEle.hasClass(f)||(this._suspendedChanged&&this.suspend(n[t.SUSPENDED]==="1"),this._oddsChanged&&(this.jQueryEle.hasClass(r)?this.requestPriceOnUnsuspend=!0:this.fetchPrice()),this._oddsChanged=!1,this._suspendedChanged=!1)}},n.prototype.stemUpdateHandler=function(n,i){this._oddsChanged=t.ODDS in i;this._suspendedChanged=t.SUSPENDED in i;var r=t.HANDICAP in i&&parseFloat(this._subItem.getValue("ln"))!==parseFloat(i[t.HANDICAP]);r&&this.stemDeleteHandler();(this._oddsChanged||this._suspendedChanged)&&this.invalidateProperties()},n.prototype.stemDeleteHandler=function(){this._isValid()&&this.suspend(!0);this.stem&&(this.stem.removeDelegate(this),this.stem=null);b365.Ui.Betslip.BetBuilderPriceCalc.CancelPriceFetch(this._index);this.jQueryEle.addClass(f)},n.prototype.detatchStem=function(){this.stem&&(this.stem.removeDelegate(this),this.stem=null)},n.prototype._getElementByClassName=function(n){var t=this._element.getElementsByClassName(n);return t.length>0?t[0]:null},n}();Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.BetCallHandler=function(n,t){var r=+window.sProps.betcallTimeout*1e3||1e4,i=this;this.StatusValues={STATUS_DEFAULT:"0",STATUS_CONNECTING:"1",STATUS_CONNECTED:"2",STATUS_ERROR:"4"};this._bsInst=n;this._bsController=t;this._button=null;this._icon=null;this._text=null;this._messageContainer=null;this._message1=null;this._message2=null;this._accountInfo=null;this._timer=null;this._speakerButton=null;this._container=null;this._status=this.StatusValues.STATUS_DEFAULT;this._appType=this._bsController.appType();this._enabled=!1;this.connected=function(){i._timer&&clearTimeout(i._timer);$(i._button).removeClass("calling").addClass("connected");i._text.text("End Call");i._icon.removeClass("progressIcon").addClass("endCallIcon");i.setStateToConnected();i._appType&&(i._messageContainer.removeClass("hidden"),i._speakerButton.removeClass("hidden"),i._speakerButton.removeClass("disabled"),ns_moblib_util_managers.BetCallManager.GetController().getSpeakerStatus()?i._speakerButton.removeClass("speakerOff"):i._speakerButton.addClass("speakerOff"),i._message1.addClass("connected"),i._accountInfo.addClass("connected"))};this.connectionFailed=function(){i._messageContainer.removeClass("hidden");i._message1||(i._message1=$("#message1",i._container),i._message2=$("#message2",i._container),i._accountInfo=$("#accountInfo",i._container));i._message1.removeClass("connected");i._accountInfo.removeClass("connected");i._message1.text("Could not connect");i._bsController._delegates.isAuthenticated()?i._message2.text("Call 1800 365 365 and quote"):i._message2.text("Call 1800 365 365 to place bet");i._message2.removeClass("hidden");$(i._button).removeClass("calling").removeClass("connected");i._text.text("Call");i._icon.removeClass("progressIcon").removeClass("endCallIcon").addClass("callIcon");i.setStateToDefault();i._appType&&i._speakerButton.addClass("hidden");i._bsController.clientActionInProgress(!1);$(".remove",i._container).show();$(".removeAll",i._container).show();$("#BetSlipCloseIcon",i._container).show()};this.callEnded=function(){i._enabled&&(i._status==i.StatusValues.STATUS_CONNECTED?i.handleClick(i._button):this.connectionFailed())};this.setStateToConnecting=function(){i._status=this.StatusValues.STATUS_CONNECTING;$(".remove",i._container).hide();$(".removeAll",i._container).hide();$("#BetSlipCloseIcon",i._container).hide()};this.setStateToConnected=function(){i._status=i.StatusValues.STATUS_CONNECTED;$(".remove",i._container).hide();$(".removeAll",i._container).hide();$("#BetSlipCloseIcon",i._container).hide()};this.setStateToDefault=function(){i._status=i.StatusValues.STATUS_DEFAULT;$(".remove",i._container).show();$(".removeAll",i._container).show();$("#BetSlipCloseIcon",i._container).show()};this.ready=function(){setTimeout(function(){ns_moblib_util_managers.BetCallManager.GetController().initiateCall()},100)};this.delegateObject={connected:i.connected,connectionFailed:i.connectionFailed,callEnded:i.callEnded,ready:i.ready};this.showLogin=function(){if(!i._bsController._delegates.isAuthenticated())return i._bsController.clientLoginDelegate(),!0}};b365.Ui.Betslip.BetCallHandler.prototype.handleClick=function(n){var r,i,t;if(this._status!=this.StatusValues.STATUS_CONNECTING)if(this._enabled=!0,this._container||(this._container=$("#betslipContainer"),this._button=n,this._text=$("#text",this._button),this._icon=$("#icon",this._button),this._speakerButton=$("#btnSpeaker",this._container),this._messageContainer=$("#messageContainer",this._container),this._message1=$("#message1",this._container),this._message2=$("#message2",this._container),this._accountInfo=$("#accountInfo",this._container)),this._status==this.StatusValues.STATUS_CONNECTED)this._bsController._delegates.isAuthenticated()&&ns_gen5_util.Singleton.getInstance(ns_gen5_util.BalanceModel).refreshBalance(),new b365.Ui.Betslip.RemoveAllItemsRequestDespatcher(this._bsInst,this._bsController).despatch(n),this._bsController.betCallTwilioEnabled()&&ns_moblib_util_managers.BetCallManager.GetController().endCall(),this._bsController.clientActionInProgress(!1),this.dispose();else{for(r=[],i=this._bsInst.getBetItems("single"),t=0;t<i.length;t++)i[t].getStItem("pom")=="Y"&&r.push(t);if(r.length==i.length)this._bsInst.clearBets(!1);else{if(this.showLogin()){this.dispose();return}new b365.Ui.Betslip.PlaceBetClickHandler(this._bsInst,this._bsController).handle(n)}this._bsController.betCallTwilioEnabled()?(this._timer=window.setTimeout($.proxy(function(){this.connectionFailed()},this),15e3),ns_moblib_util_managers.BetCallManager.Initialize(this.delegateObject),$(this._button).addClass("calling"),this._text.text("Calling An Advisor"),this._icon.removeClass("callIcon").addClass("progressIcon"),this.setStateToConnecting(),this._bsController.clientActionInProgress(!0)):(this._text.text("Done"),this._icon.hide(),this.setStateToConnected(),this._bsController.clientActionInProgress(!0),this._bsController.appType()=="androidapp"?window.open("tel:1800365365"):window.location.href="tel:1800365365")}};b365.Ui.Betslip.BetCallHandler.prototype.clearPhoneOnlyItems=function(){for(var t=[],i=this._bsInst.getBetItems("single"),n=0;n<i.length;n++)i[n].getStItem("pom")=="Y"&&t.push(n);for(n=0;n<t.length;n++)i.splice(parseInt(t[n]-n),1);this._bsInst.updateState()};b365.Ui.Betslip.BetCallHandler.prototype.toggleSpeakerPhone=function(n){var t=$(n);t.hasClass("disabled")||(ns_moblib_util_managers.BetCallManager.GetController().toggleSpeaker(),t.hasClass("speakerOff")?t.removeClass("speakerOff"):t.addClass("speakerOff"))};b365.Ui.Betslip.BetCallHandler.prototype.dispose=function(){this._enabled&&(this._bsController.betCallTwilioEnabled()&&ns_moblib_util_managers.BetCallManager.GetController().unregisterDelegate(this.delegateObject),this._button=null,this._icon=null,this._text=null,this._message1=null,this._message2=null,this._accountInfo=null,this._timer=null,this._speakerButton=null,this._container=null,this._status=this.StatusValues.STATUS_DEFAULT,this._enabled=!1)};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.BetCreditsCalculator=function(n,t){this._bsInst=n;this._betSlipController=t;this._freeBetsStateCookieKey="fs";this._cookieValSeparator="||";this._isCurrentlySelected=this._bsInst.getValueFromBSCookie(this._freeBetsStateCookieKey).replace(this._cookieValSeparator,"")==1;this._freeBetReceipt=document.getElementsByClassName("betReceipt")[0];this._selectedFreeBets=this._freeBetReceipt?document.querySelectorAll(".fbt-FreeBetToken_Redeemed,.br-UsingFreeBet"):document.getElementsByClassName("bs-FreeBetCheckBox-selected");this._ttStkEle=$("#bsDiv a.placeBet.abetslipBtn button span.totalStake");this._ttCurrencyEle=$("#bsDiv a.placeBet.abetslipBtn button span.isocode");this._freeStakeTotal=[];this._ttfreeStakeEle=[];this._isoCurrencyText=this._freeBetReceipt?$("#bsDiv").children(".betReceipt").attr("data-isocode"):$("#bsDiv>ul").attr("data-isocode");this._decimalSeperator=window.sProps.balance.currencyDecimalSeparator;var i=window.sProps.instantBet?Number(document.getElementById("bsDiv").childNodes[0].getAttribute("data-abb")):Locator.user.getBalance().bonusBalance;this._freebetAmount=this._isCurrentlySelected?i:0;this._itemToReturnDisplayHelper=new b365.Ui.Betslip.ItemToReturnDisplayHelper(t);this._formatter=new b365.Ui.Formatter;this._getFreeBetBetslip=function(){var o=this._bsInst.getBetItems(this._bsInst.itemTypeSingle),y=this._bsInst.getBetItems(this._bsInst.itemTypeMultiple),c=this._bsInst.getBetItems(this._bsInst.itemTypeCast),tt=this._bsInst.getBetItems(this._bsInst.itemTypeBetBuilder),r,it,f,rt,e,ut,ft,et,h,p,ot,a=this._betSlipController.ausMultiplesEnabled(),l=[],ct=$("#bsDiv>ul").attr("data-equally-divided")=="True",b=!1,d=!1,g=!1,st=[],ht=this._freeBetReceipt?!0:!1,u={},n,nt,k,s,t,w,v;for(this._isCurrentlySelected=this._bsInst.getValueFromBSCookie(this._freeBetsStateCookieKey).replace(this._cookieValSeparator,"")==1,u.freeBetAmount=this._isCurrentlySelected?Number(i):0,u.betslipType=this._bsInst.getSlipType(),u.betItems=[],r=0,it=o.length;r<it;r++)n={},d=o[r].getStItem("_s")==="1",g=o[r].getStItem("sp")==="1",n.stake=!o[r].getStItem("st")?0:Number(o[r].getStItem("st")),n.freeBetTokenSelected=o[r].getStItem("ft")?!0:!1,n.odds=g||d&&!a?[""]:[$blib.getItemOdds(this._bsInst.itemTypeSingle,o[r])],st.push(n.odds[0]),n.placeOdds=o[r].getCnItem("po"),n.ewSelected=o[r].getStItem("ew")=="1"?!0:!1,n.ausEWSelected=!!n.placeOdds,n.ausEWSelected?(l.push([(r+1).toString()]),l[l.length-1].push(n.placeOdds)):(!a||n.ewSelected)&&(nt=$('li[data-item-id="'+r+'"]').find(".placedivider")[0],nt&&(k=Number(nt.getAttribute("data-place-divider")),k&&k>0&&(n.placeOdds=ns_betcalculationslib_util.OddsFormatter.GetFractionalPlaceOdds(n.odds[0],k),l.push([(r+1).toString()]),l[l.length-1].push(n.placeOdds)))),n.betCount=1,n.index=r,n.type="single",n.combinations=[["1"]],u.betItems.push(n);for(e=0,ut=c.length;e<ut;e++)ft=c[e].getCnItem("bc")?Number(c[e].getCnItem("bc")):c[e].getStItem("bc")?Number(c[e].getStItem("bc")):1,et=Number(c[e].getStItem("st")),s={},s.stake=et,s.ewSelected=!1,s.freeBetTokenSelected=c[e].getStItem("ft")?!0:!1,s.odds=[$blib.getItemOdds(this._bsInst.betTypeCast,c[e])],s.betCount=ft,s.combinations=[["1"]],s.index=e,s.type="cast",u.betItems.push(s);for(f=0,rt=y.length;f<rt;f++)t={},w=a&&this._betSlipController.complexMultiplesInfo&&this._betSlipController.complexMultiplesInfo.length>f?this._betSlipController.complexMultiplesInfo[f]:null,t.betCount=!ht&&w?w.LC:y[f].getCnItem("bc"),t.betType=y[f].getCnItem("id"),b=t.betCount==="1"&&["54","55"].indexOf(t.betType)===-1,t.stake=!y[f].getStItem("st")?0:Number(y[f].getStItem("st")),t.ewSelected=y[f].getStItem("ew")=="1"||a&&l.length>0?!0:!1,t.freeBetTokenSelected=!1,t.odds=st,t.combinations=w?w.combinations:b?ns_betcalculationslib_calculations_multiples.MultiplesCombinations.GetDefaultCombinations(o.length):[["1"]],t.calculateBetCount=!ht&&a&&!!t.combinations,t.calculateReturnValue=(a||b)&&!!t.combinations,t.index=f,t.type="multiple",t.calculateAccumulatedOdds=b,t.oddsType=Locator.user.oddsTypeId,u.betItems.push(t),u.calculateMultipleReturnValue=u.calculateMultipleReturnValue||t.calculateReturnValue||a;for(p=0,ot=tt.length;p<ot;p++)v=tt[p],h={},h.index=p,d=v.getStItem("_s")==="1",g=v.getStItem("sp")==="1",h.odds=[$blib.getItemOdds(this._bsInst.itemTypeBetBuilder,v)],h.freeBetTokenSelected=!!v.getStItem("ft"),h.stake=v.getStItem("st")?Number(v.getStItem("st")):0,h.oddsType=Locator.user.oddsTypeId,h.type="betbuilder",h.betCount=1,u.betItems.push(h);return u.equallyDivided=ct,u.eachWaySelections=l,u};this._getCookieBetItem=function(n,t){return n==="multiple"?this._bsInst.getBetItems(this._bsInst.itemTypeMultiple)[t]:n==="cast"?this._bsInst.getBetItems(this._bsInst.itemTypeCast)[t]:n==="betbuilder"?this._bsInst.getBetItems(this._bsInst.itemTypeBetBuilder)[t]:this._bsInst.getBetItems(this._bsInst.itemTypeSingle)[t]};this._updateFreeBetStakesAndReturns=function(n){var r,c,t,f,y,tt="",it=!1,ot=$('li[data-item-id="-1"][data-item-type="multiple"]').length>0,i,p=0,l=$("#bsDiv .bs-TotalToReturn_Wrapper")[0],w,e,b,o,rt,u,k,s,h,a,v,g,nt,ft,et;if(ausMultiplesEnabled=this._betSlipController.ausMultiplesEnabled(),someRelated=$('#bsDiv li[data-item-type="single"]').hasClass("restrictedCong"),this._freeBetReceipt)for(r=0,c=n.betItems.length;r<c;r++)if(t=n.betItems[r],t.type==="multiple"&&!isNaN(t.stake)){it=!0;break}for(w=!1,r=0,c=n.betItems.length;r<c;r++){if(t=n.betItems[r],f=this._getCookieBetItem(t.type,t.index),tt!==t.type&&(tt=t.type,y=ot&&t.type==="multiple"?1:0),this._freeBetReceipt)if(t.type==="multiple"&&(isNaN(t.stake)||t.stake==0))continue;else if(t.type!=="multiple"&&!it&&(isNaN(t.stake)||t.stake==0))continue;if(e=$(".bsError"),b=$(".placeBet.abetslipBtn"),t.type==="multiple"&&!t.freeBetTokenSelected&&isNaN(t.betItemBetCreditStake)){e.removeClass("hidden");e.addClass("alert");b.addClass("disabled");this._betSlipController.clientActionInProgress(!0);b365.Ui.Betslip.BetCreditsCalculator.prototype.previousErrorMessage||(b365.Ui.Betslip.BetCreditsCalculator.prototype.previousErrorMessage=document.querySelector(".bsError .text").innerText||"placeholder");document.querySelector(".bsError .text").innerText=betSlipML.SplitError;w=!0;break}else w||b365.Ui.Betslip.BetCreditsCalculator.prototype.previousErrorMessage&&(e.addClass("hidden"),e.removeClass("alert"),b.removeClass("disabled"),this._betSlipController.clientActionInProgress(!1),document.querySelector(".bsError .text").innerText=b365.Ui.Betslip.BetCreditsCalculator.prototype.previousErrorMessage,b365.Ui.Betslip.BetCreditsCalculator.prototype.previousErrorMessage="");if(i=$('li[data-item-type="'+t.type+'"]')[y],i)if(o=i.getElementsByClassName("bs-BetCreditItem")[0],rt=i.getElementsByClassName("stk")[0],t.betItemBetCreditStake&&(i.className.indexOf("freeBetStakeApplied")<0?i.className+=" freeBetStakeApplied":i.className=i.className.replace(/(?:^|\s)freeBetStakeApplied(?!\S)/,"")),o||(o=i.getElementsByClassName("multiplesFreeStakeText")[0],rt=i.getElementsByClassName("stk")[0]),o&&(f.removeStItem("fb"),t.betItemCookieFreeStake&&f.setStItem("fb",t.betItemCookieFreeStake),this._updateItemFreeStakeUI(t,o)),t.type==="single"||t.type==="betbuilder")t.type==="single"&&(p++,(t.ewSelected||t.ausEWSelected)&&p++),u=i.getElementsByClassName("stakeToReturn")[0],u&&(s=t.betItemReturnsValue>=0?t.betItemReturns:$blib.roundDecimal(String(0),this._decimalSeperator),h=t.betItemBetCreditStake>0||t.betItemFreeStake>0?betSlipML.netReturn:betSlipML.toreturn,u.innerHTML=h+'<span class="stakeToReturn_Value"><\/span>',t.betItemReturnsValue>=0&&f.setStItem("tr",t.betItemReturnsValue),this._itemToReturnDisplayHelper.setReturnValue(t.index,t.type,s));else if(t.type==="multiple"&&(ausMultiplesEnabled||t.calculateReturnValue)){f.setCnItem("bc",t.betCount.toString());k=i.getElementsByClassName("multiplesBetCount")[0];k&&(k.innerHTML=t.betCount+"x");var u=i.getElementsByClassName("bs-StandardMultipleStake_ToReturn")[0],d=i.getElementsByClassName("bs-multiple-odds")[0],ut=document.getElementsByClassName("restrictedCong").length>0;u&&(s=t.betItemReturnsValue>=0?t.betItemReturns:"0"+this._decimalSeperator+"00",h=t.betItemBetCreditStake>0||t.betItemFreeStake>0?betSlipML.netReturn:betSlipML.toreturn,u.innerHTML=h+'<span class="bs-StandardMultipleStake_ToReturnValue"><\/span>',this._itemToReturnDisplayHelper.setMultipleReturnValue(t.betType,t.type,s),a=isNaN(t.betItemReturnsValue)||ut?"display:none;":"",u.setAttribute("style",a),d&&(a=!t.accumulatedOdds||ut?"display:none;":"",d.innerHTML=t.accumulatedOdds||"",d.setAttribute("style",a)))}y++}this._updateTotalStakeUI(n);v=$('#bsDiv .multiple-section [data-item-id="-1"]');v&&v.length>0&&(g=$(v[0]).find(".multiplesBetCount")[0],g&&(g.innerHTML=p+"x"));nt=n.totalReturns;l&&ausMultiplesEnabled&&(nt==0||someRelated?$(l).addClass("hidden"):($(l).removeClass("hidden"),ft=Number(n.totalBetCreditStake)>0?betSlipML.TotalNetReturn:betSlipML.TotalToReturn,et="{0} <span class='bs-TotalToReturn_Span bs-TotalToReturn_TextValue'>{1}<\/span>".replace("{0}",ft).replace("{1}",$blib.roundDecimal(String(nt),this._decimalSeperator)),l.innerHTML=et));this._bsInst.updateState()};this._updateTotalStakeUI=function(n){var u=document.getElementById("bcTotals"),f=$(".bs-useBetCreditInfoReturns"),i=this._freeBetReceipt?!0:!1,ft=$("#betConfirmHeader").length>0?!0:!1,r=this._freeBetReceipt?this._freeBetReceipt.getAttribute("data-tst"):"",e=this._freeBetReceipt?this._freeBetReceipt.getAttribute("data-tbc"):"",o=this._freeBetReceipt?this._freeBetReceipt.getAttribute("data-tfb"):"",s=this._freeBetReceipt?this._freeBetReceipt.getAttribute("data-st"):"",p,c,t,nt,tt;if(u){if(p=u.getElementsByClassName("bs-BetCreditTotal")[0],c=u.getElementsByClassName("bs-BetCreditTotalDetails")[0],c){var h=i?"":"Total",w="NetReturns",b=betSlipML.TotalStake,l,it,rt=!1,a=!1,v=!1,ut=!1,y=Number(n.totalStake.replace(",",".")),k=Number(n.totalFreeBetStake.replace(",",".")),d=Number(n.totalBetCreditStake.replace(",",".")),g=i?r.replace(",",".")>0:y-k-d>0;if(this._isCurrentlySelected&&(v=!0,h+="BetCredits",w+="BetCredits"),this._selectedFreeBets.length>0){for(a=!0,l=0,it=this._selectedFreeBets.length;l<it;l++)if(this._selectedFreeBets[l].getAttribute("data-inplay")==="1"){rt=!1;break}h+="FreeBet";w+="FreeBet";rt&&(h+="Inplay")}g&&(ut=!0,h+="PlusStake");t=betSlipML[h];nt=betSlipML[w];t?(r&&r>0&&(r=$blib.roundDecimal(r+"",this._decimalSeperator)),e&&e>0&&(e=$blib.roundDecimal(e+"",this._decimalSeperator)),o&&o>0&&(o=$blib.roundDecimal(o+"",this._decimalSeperator)),s&&s>0&&(s=$blib.roundDecimal(s+"",this._decimalSeperator)),v&&a&&ut?(t=t.replace("{0}",i?e:n.totalBetCreditStake),t=t.replace("{1}",i?r:$blib.roundDecimal(y-k-d+"",this._decimalSeperator)),t=t.replace("{2}",this._isoCurrencyText),t=t.replace("{3}",i?o:n.totalFreeBetStake)):v&&a?(t=t.replace("{0}",i?e:n.totalBetCreditStake),t=t.replace("{1}",i?o:n.totalFreeBetStake)):v?(t=t.replace("{0}",i?e:n.totalBetCreditStake),g&&(t=t.replace("{1}",i?r:$blib.roundDecimal(y-d+"",this._decimalSeperator)),t=t.replace("{2}",this._isoCurrencyText))):a&&(t=t.replace("{0}",i?o:n.totalFreeBetStake),g&&(t=t.replace("{1}",i?r:$blib.roundDecimal(y-k+"",this._decimalSeperator)),t=t.replace("{2}",this._isoCurrencyText))),c.innerHTML=t,i&&p&&(b=b.replace("{0}",i?"<span class='bs-BetCreditTotal_Stake'>"+s+"<\/span>":$blib.roundDecimal(n.totalStake+"",this._decimalSeperator)+" "+this._isoCurrencyText),p.innerHTML=b)):c.innerHTML="";i&&!ft&&n.totalBetCreditStake&&Locator.user.getBalance().updateBonusBalance(n.totalBetCreditStake);nt&&f.length>0?f.text(nt):f.text("")}(this._isCurrentlySelected||this._selectedFreeBets.length>0)&&!b365.Ui.Betslip.BetCreditsCalculator.prototype.previousErrorMessage?(tt=document.getElementsByClassName("totals")[0],tt&&tt.setAttribute("style","display: none!important"),u.className.indexOf("visible")<0&&(u.className+=" visible"),f.length>0&&f.removeClass("hidden")):(u.className=u.className.replace(/(?:^|\s)visible(?!\S)/g,""),f.length>0&&f.addClass("hidden"))}};this._updateItemFreeStakeUI=function(n,t){var e="",h=t.getElementsByClassName("bs-BetCreditInfo")[0],i,o,r,u,s,f;this._freeBetReceipt?(o=t.getAttribute("data-freestake"),isFreeToken=t.getAttribute("data-isfreetoken"),i=isFreeToken==="0"?Number(o):null):i=Number($blib.roundDecimal(n.betItemBetCreditStake+""));i&&(r=betSlipML.UsingBetCredits,this._freeBetReceipt&&(r=betSlipML.UsedBetCredits),f=Number($blib.roundDecimal(n.stake*n.betCount*(n.ewSelected&&!(Locator.user.countryId==="13"&&n.type=="multiple")?2:1)+"")),this._freeBetReceipt?(u=$blib.pad2DP(this._formatter.roundDecimal(o),window.sProps.balance.currencyDecimalSeparator),f>i&&(s=f-i)):(u=$blib.pad2DP(this._formatter.roundDecimal(i),window.sProps.balance.currencyDecimalSeparator),s=n.betItemActualStake),e=i===f?r.replace("[X]",u):r.replace("[X]",u)+" + "+$blib.pad2DP(this._formatter.roundDecimal(s),window.sProps.balance.currencyDecimalSeparator)+" "+this._isoCurrencyText);e?(h.innerHTML=e,t.className.indexOf("visible")<0&&(t.className+=" visible")):t.className=t.className.replace(/(?:^|\s)visible(?!\S)/g,"")};this._setBetslipFreeBarInfo=function(){var n=this._getFreeBetBetslip();ns_betcalculationslib_calculations_freebets&&(ns_betcalculationslib_calculations_freebets.BetSlipFreebetStakes.CalculateFreebetStakeAndReturns(n),this._updateFreeBetStakesAndReturns(n))}};b365.Ui.Betslip.BetCreditsCalculator.prototype={calculate:function(){this._setBetslipFreeBarInfo()},previousErrorMessage:""};Type.registerNamespace("b365.Ui.Betslip");b365.Ui.Betslip.ToggleBetCredits=function(n,t){this._bsInst=n;this._bsController=t;this._selectedVal="1";this._selectedCSS="checked";this._unselectedVal="0";this._freeBetsStateCookieKey="fs";this._cookieValSeparator="||";this._freeBetHdr=$("#bsDiv .bs-CheckBoxFreeBet");this._freeBetContainer=$("#bsDiv .bs-useFreeBet");this._freeBetAmt=document.querySelector("#bsDiv .bs-useFreeBetAmount");this._calc=new b365.Ui.Betslip.BetCreditsCalculator(this._bsInst,this._bsController);this._isCurrentlySelected=!1;this._taxTextNode=document.querySelector("#taxWarningHeader");b365.Ui.Betslip.ToggleBetCredits.taxText=this._taxTextNode&&!b365.Ui.Betslip.ToggleBetCredits.taxText?this._taxTextNode.innerText:b365.Ui.Betslip.ToggleBetCredits.taxText;this._taxText=b365.Ui.Betslip.ToggleBetCredits.taxText;this._netTaxText=betSlipML.NetReturnTax;this._isValid=function(){return typeof this._bsInst!="undefined"};this._isValid()&&(this._isCurrentlySelected=this._bsInst.getValueFromBSCookie(this._freeBetsStateCookieKey).replace(this._cookieValSeparator,"")==this._selectedVal)};b365.Ui.Betslip.ToggleBetCredits.prototype={taxText:"",toggle:function(){var n,t;this._isValid()&&$("#bsDiv .betReceipt").length==0&&$("#bsDiv.bs-inprogress").length==0&&(this._isCurrentlySelected||(n=this._bsInst.getBetItems(this._bsInst.itemTypeSingle).concat(this._bsInst.getBetItems(this._bsInst.itemTypeBetBuilder)),n.length===1&&n[0].getStItem("ft")&&n[0].getStItem("ft").length>0&&(t=document.getElementsByClassName("bs-FreeBetCheckBox-selected")[0],this._bsController._freeBetClickHandler.toggle(t))),this._isCurrentlySelected?this._freeBetHdr.removeClass(this._selectedCSS):this._freeBetHdr.addClass(this._selectedCSS),this._isCurrentlySelected?this._freeBetContainer.removeClass(this._selectedCSS):this._freeBetContainer.addClass(this._selectedCSS),this._taxTextNode&&(this._taxTextNode.innerText=this._isCurrentlySelected?this._taxText:this._netTaxText),this._bsInst.setValueInBSCookie(this._freeBetsStateCookieKey,this._isCurrentlySelected?this._unselectedVal:this._selectedVal),this._calc.calculate(),this._bsInst.changeBetslipHeight())},reset:function(){var u=this._bsInst.getSlipType()!==this._bsInst.slipStandard,t=!1,n="",r,i;window.sProps.instantBet?(n=this._bsController._currencyDisplayHelper.formatCurrency(document.getElementById("bsDiv").childNodes[0].getAttribute("data-abb")),t=document.getElementById("bsDiv").childNodes[0].getAttribute("data-abc")==="1"):(n=Locator.user.getBalance().bonusBalance?$blib.pad2DP(Locator.user.getBalance().bonusBalance,window.sProps.balance.currencyDecimalSeparator):"",t=Locator.pushedConfig.getIsFreeBetsAllowed(Locator.user.countryId));r=!!n&&n!=="0,00"&&n!=="0.00";i=t&&r&&!this._bsInst.containsPhoneOnlyBet()&&!u;i?this._freeBetContainer.removeClass("hidden"):this._freeBetContainer.addClass("hidden");this._isCurrentlySelected=this._bsInst.getValueFromBSCookie(this._freeBetsStateCookieKey).replace(this._cookieValSeparator,"")==this._selectedVal&&i;this._isCurrentlySelected?this._freeBetHdr.addClass(this._selectedCSS):this._freeBetHdr.removeClass(this._selectedCSS);this._isCurrentlySelected?this._freeBetContainer.addClass(this._selectedCSS):this._freeBetContainer.removeClass(this._selectedCSS);this._taxTextNode&&(this._taxTextNode.innerText=this._isCurrentlySelected?this._netTaxText:this._taxText);this._freeBetAmt&&(this._freeBetAmt.innerText=this._freeBetAmt.innerText.replace("{0}",n));this._bsInst.setValueInBSCookie(this._freeBetsStateCookieKey,this._isCurrentlySelected?this._selectedVal:this._unselectedVal);this._calc.calculate()}}
/*
//@ sourceMappingURL=betslip.js.map
*/